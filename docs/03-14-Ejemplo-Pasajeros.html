<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Iván Arribas (Depto. Análisis Económico. Universitat de València)" />


<title>Análisis de la serie Pasajeros en transporte urbano</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Predicción con Datos Temporales</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="01-Guia-curso.html">
    <span class="fa fa-graduation-cap"></span>
     
    Guía del curso
  </a>
</li>
<li>
  <a href="02-Logistica.html">
    <span class="fa fa-laptop"></span>
     
    Logística
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Diapos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Teoría</li>
    <li>
      <a href="03-01-Tema1.html">Tema 1: Introducción</a>
    </li>
    <li>
      <a href="03-02-Tema2.html">Tema 2: Definición</a>
    </li>
    <li>
      <a href="03-03-Tema3.html">Tema 3: Métodos sencillos</a>
    </li>
    <li>
      <a href="03-04-Tema4.html">Tema 4: Media móvil</a>
    </li>
    <li>
      <a href="03-05-Tema5.html">Tema 5: Alisado</a>
    </li>
    <li>
      <a href="03-06-Tema6.html">Tema 6: ARIMA</a>
    </li>
    <li>
      <a href="03-07-Tema7.html">Tema 7: SARIMA</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Ejemplo de aplicación</li>
    <li>
      <a href="03-08-Ejemplo2.html">Ejemplo Tema 2</a>
    </li>
    <li>
      <a href="03-09-Ejemplo3.html">Ejemplo Tema 3</a>
    </li>
    <li>
      <a href="03-10-Ejemplo4.html">Ejemplo Tema 4</a>
    </li>
    <li>
      <a href="03-11-Ejemplo5.html">Ejemplo Tema 5</a>
    </li>
    <li>
      <a href="03-12-Ejemplo6.html">Ejemplo Tema 6</a>
    </li>
    <li>
      <a href="03-13-Ejemplo7.html">Ejemplo Tema 7</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otro ejemplo</li>
    <li>
      <a href="03-14-Ejemplo-Pasajeros.html">Ejemplo de Pasajeros</a>
    </li>
  </ul>
</li>
<li>
  <a href="04-Recursos-R.html">
    <span class="fa fa-code"></span>
     
    Recursos de R
  </a>
</li>
<li>
  <a href="05-Evaluacion_Continua.html">
    <span class="fa fa-edit"></span>
     
    Evaluacion Continua
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-download"></span>
     
    Más
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">R</li>
    <li>
      <a href="https://cran.r-project.org">Dónde está R</a>
    </li>
    <li>
      <a href="https://rstudio.com">Donde está RStudio</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Markdown</li>
    <li>
      <a href="https://bookdown.org/yihui/rmarkdown/">Markdown</a>
    </li>
    <li>
      <a href="https://rmarkdown.rstudio.com/lesson-1.html">R Markdown</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otros</li>
    <li>
      <a href="https://www.r-bloggers.com">Blog sobre R</a>
    </li>
    <li>
      <a href="https://bookdown.org">Libros online que debes conocer</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Análisis de la serie Pasajeros en transporte urbano</h1>
<h3 class="subtitle">Predicción con datos temporales (BIA)</h3>
<h4 class="author">Iván Arribas (Depto. Análisis Económico. Universitat de València)</h4>

</div>


<p>En este curso hemos aprendido a describir una serie temporal, estimar su proceso generador de datos y realizar predicciones, tanto puntuales como por intervalo. Para ello, hemos estudiado los principales aspectos teóricos relacionados con las series temporales, sus componentes, criterios de bondad de ajuste y predicción, modelos de ajuste, etc. También hemos practicado la aplicación de estos conceptos a través de diferentes series temporales: Títulos publicados, Nacimientos, Aforo de vehículos, Consumo de alimentos per cápita, Producción de chocolate, Pernoctaciones de turistas extranjeros, entre otras.</p>
<p>El programa de estadística utilizado, <code>R</code>, ha servido con dos propósitos entremezclados durante el curso. En primer lugar, para ilustrar los aspectos teóricos que se iban introduciendo. En este caso, <code>R</code> tenía un uso más instrumental y en general se mostraba la salida obtenida sin enseñar el código. Sin embargo, el propósito principal ha sido aprender como usar <code>R</code> con el objetivo de analizar y predecir una serie temporal. El ejemplo transversal utilizado durante el curso de <em>Pernoctaciones en alojamientos turísticos de turistas extranjeros</em> es el principal exponente de este uso de <code>R</code>.</p>
<p>Ahora bien, ambos usos de <code>R</code>, ilustrar aspectos teóricos y analizar una serie, han quedado distribuidos a lo largo de los temas vistos. El ejemplo <strong>Pasajeros en transporte urbano</strong>, desarrollado aquí, tiene como objetivo disponer en un único documento y de forma organizada del análisis completo de una serie temporal. En este informe se mostrará siempre el código completo empleado para las salidas, se hará hincapié en la aplicación práctica de los conceptos teóricos, se insistirá en los diferentes enfoques que se pueden y deben emplear para analizar una serie temporal y se justificarán todas las decisiones adoptadas.</p>
<p>Este es, por tanto, un ejemplo que se extiende más allá de lo que un informe de análisis de una serie temporal precisa.</p>
<p>Para el código de este ejemplo se utilizarán funciones de las librerías básicas de <code>R</code> y de otras que se pueden encontrar en las siguientes librerías:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(aod)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(forecast)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(ggplot2); <span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(seasonal)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(timeDate)</a></code></pre></div>
<div id="pasajeros-en-transporte-urbano" class="section level1">
<h1><span class="header-section-number">1</span> Pasajeros en transporte urbano</h1>
<p>La serie que se va a analizar corresponde al número de pasajeros en transporte urbano en España. Es una serie mensual que puede ser consultada en el <a href="\http://www.ine.es">Instituto Nacional de Estadística</a> y para la que se dispone de datos desde enero de 1996 hasta diciembre de 2019.</p>
<p>Por transporte urbano de pasajeros se hace referencia a los servicios de transporte terrestre de pasajeros, urbano y suburbano, por itinerarios regulares, con horario establecido y con paradas fijas, realizados por autobuses, tranvías, trolebuses, metros y metros ligeros. También se incluyen las líneas de servicio al aeropuerto y a las estaciones y la explotación de funiculares y teleféricos si forman parte de los sistemas de tránsito urbanos e interurbanos.</p>
<p>Los datos de la serie, que denominaremos de forma abreviada Pasajeros, han sido descargados en el fichero <em>Pasajeros.csv</em> y aunque en origen la unidad es miles de pasajeros, la cambiaremos a millones de pasajeros.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">meses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Ene&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Abr&quot;</span>, <span class="st">&quot;May&quot;</span>, <span class="st">&quot;Jun&quot;</span>, </a>
<a class="sourceLine" id="cb2-2" data-line-number="2">           <span class="st">&quot;Jul&quot;</span>, <span class="st">&quot;Ago&quot;</span>, <span class="st">&quot;Sep&quot;</span>, <span class="st">&quot;Oct&quot;</span>, <span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Dic&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">Pasajeros &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;./series/Pasajeros.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">Pasajeros &lt;-<span class="st"> </span><span class="kw">ts</span>(Pasajeros<span class="op">/</span><span class="dv">1000</span>, <span class="dt">start =</span> <span class="dv">1996</span>, <span class="dt">freq =</span> <span class="dv">12</span>)</a></code></pre></div>
</div>
<div id="descriptiva" class="section level1">
<h1><span class="header-section-number">2</span> Descriptiva</h1>
<p>La figura 2.1 muestra la evolución de la serie Pasajeros en transporte urbano desde 1996 hasta 2019. Destaca que la tendencia de la serie ha seguido el ciclo económico. Durante el periodo de crecimiento de finales del siglo pasado y principios de este, el número de pasajeros en transporte urbano creció de forma sostenida. Con la crisis económica iniciada a finales de 2007 se observa un cambio en la tendencia y el número de pasajeros se reduce. No es hasta el final de la crisis en 2014 que la tendencia vuelve a cambiar y pasar a ser creciente de nuevo.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">autoplot</span>(Pasajeros, <span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">         <span class="dt">ylab =</span> <span class="st">&quot;Millones de pasajeros&quot;</span>,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">         <span class="dt">main =</span> <span class="st">&quot;Figura 2.1. Pasajeros en transporte urbano (datos mensuales)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span> <span class="kw">seq</span>(<span class="dv">1996</span>, <span class="dv">2019</span>, <span class="dv">2</span>)) </a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>La serie presenta una acusada estacionalidad, causada principalmente por la distribución de las vacaciones a lo largo de un año y el número de días laborables de cada mes. Pensemos que el principal uso del transporte urbano es el traslado hasta y desde el lugar de trabajo, seguido del ocio (ir de compras, al cine, a restaurantes, etc.). Así, cada año el mes con menor número de pasajeros es agosto (los valles en la figura 2.1) por estar la mayoría de la gente de vacaciones, fuera de sus ciudades de residencia habituales, y no usar tan intensamente el transporte urbano.</p>
<p>El esquema parece ser aditivo porque no se aprecia que la amplitud estacional se amplíe conforme el número de pasajeros aumenta.</p>
<p>En los siguientes epígrafes se hará una descriptiva de la tendencia y la estacionalidad más detallada.</p>
<p><br />
</p>
<div id="análisis-de-la-tendencia" class="section level2">
<h2><span class="header-section-number">2.1</span> Análisis de la tendencia</h2>
<p>Si anualizamos la serie podemos, por un lado, identificar mejor en que años se producen los cambios en la tendencia y, por otro lado, poner cifras al volumen de pasajeros en transporte urbano.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">PasajerosAnual &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Pasajeros, <span class="dt">FUN =</span> sum)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">autoplot</span>(PasajerosAnual, <span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>,</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">         <span class="dt">ylab =</span> <span class="st">&quot;Millones de pasajeros&quot;</span>,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">         <span class="dt">main =</span> <span class="st">&quot;Figura 2.2. Pasajeros en transporte urbano (datos anuales)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span> <span class="kw">seq</span>(<span class="dv">1996</span>, <span class="dv">2019</span>, <span class="dv">2</span>))</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-4-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>La figura 2.2 muestra el volumen anual de pasajeros en transporte urbano. El crecimiento continuado, posiblemente iniciado antes de 1996 y que permitió superar los 3,000 millones de pasajeros en 2007, se ve interrumpido con el inicio de la pasada crisis económica. La caída irregular en el número de pasajeros se interrumpe en 2014, año que marca la salida de la crisis económica y el inicio de la recuperación en el serie. Actualmente se han superado los 3,100 millones de pasajeros.</p>
<p>El incremento en el uso del transporte urbano observado antes y después de la crisis puede tener distintas causas: un uso más intensivo del transporte urbano en detrimento de otros medios de transporte, una reorganización de los servicios de transporte urbano que haya mejorado la conectividad dentro de los municipios, o un aumento en el número de líneas de autobús, tranvía o metro en determinadas ciudades.</p>
<p>No está clara la causa del repunte aislado observado el año 2011, en plena crisis, pero puede deberse a una ligera recuperación en la economía que tuvo lugar a finales de 2010 y principios de 2011.</p>
<p><br />
</p>
</div>
<div id="análisis-de-la-estacionalidad" class="section level2">
<h2><span class="header-section-number">2.2</span> Análisis de la estacionalidad</h2>
<p>La principal causa de la estacionalidad observada en la serie es la estructura vacacional de la sociedad, especialmente caracterizada por las vacaciones de verano (julio a septiembre) y las vacaciones de Semana Santa (en marzo y/o abril, según el año). Además, debido a que el transporte urbano se usa principalmente para ir a trabajar, también influye el número de días laborables del mes. Por ejemplo, en 2017 el mes de junio tuvo 22 días laborables, mientras que en 2019 tuvo 20 días laborables. Esta diferencia de dos días tendrá un efecto sobre el volumen de pasajeros.</p>
<p>El número de días laborables de un mes viene marcado por los fines de semana del mes y por las festividades nacionales. Es cierto que el sábado se trabaja en diversos sectores (transporte, ocio, distribución) pero la caída en el número de trabajadores respecto de los días entre semana (lunes a viernes) es muy notable. También es cierto que, además de las festividades nacionales, hay muchas festividades autonómicas o municipales que podrían afectar al volumen de pasajeros en transporte urbano. Por ejemplo, las festividades regionales en comunidades como Madrid o Cataluña pueden tener un efecto significativo sobre la serie Pasajeros. Sin embargo, las festividades no nacionales no se van a tener en cuenta.</p>
<p>Por tanto, para realizar un análisis detallado de la estacionalidad, es necesario crear una serie con el número de días laborables de cada mes. Además, esta serie se usará más adelante para modelizar y predecir la serie Pasajeros.</p>
<div id="días-laborables-de-cada-mes" class="section level3 unnumbered">
<h3>Días laborables de cada mes</h3>
<p>La librería <code>timeData</code> proporciona una serie de funciones que permiten definir un calendario de festividades, identificar los fines de semana y, a partir de aquí, crear la serie de días laborables (véase código más abajo).</p>
<ul>
<li><p>Con <code>timeCalendar</code> se definen las <em>consideradas</em> festividades nacionales: Año nuevo (1 de enero), Reyes (6 de enero), Viernes Santo (fecha variable), Día del Trabajo (1 de mayo), Día de la Asunción (15 de agosto), Día de la Hispanidad (12 de octubre), Día de Todos los Santos (1 de noviembre), la Constitución (6 de diciembre) la Inmaculada Concepción (8 de diciembre) y Navidad (25 de diciembre).</p>
<p>Por claridad, cada festivo se ha definido de forma independiente para después crear una variable con todas las festividades (<em>FestivosNacionales</em>).</p>
<p>El rango para todos los cálculos va desde 1996 hasta 2024, que incluye el rango de la serie Pasajeros más cinco años de predicción.</p>
<p>La función utilizada <code>Easter</code> de la librería <code>timeDate</code> difiere de la función <code>easter</code> de <code>forecast</code>.</p></li>
<li><p>A continuación, con <code>timeSequence</code> se crea una serie diaria desde el 1 de enero de 1996 hasta el 31 de diciembre de 2024.</p></li>
<li><p>Las dos siguientes líneas eliminan de la serie diaria los festivos y los fines de semana, (función <code>isBizday</code>), para después dar a esta nueva serie el formato año-mes eliminando el día. De esta forma, la serie de días laborales tendrá el mismo identificador para todos los días del mismo mes.</p></li>
<li><p>Después, se crea una tabla que, por la naturaleza de la serie de días laborales, tendrá para cada año-mes el numero de días laborables. Por último fechamos la tabla, que es nuestra serie de días laborables y mostramos algunos datos.</p></li>
<li><p>Las dos últimas líneas de código dividen la serie en el periodo muestral y el de predicción.</p></li>
</ul>
<p><br />
</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">AnoNuevo &lt;-<span class="st"> </span><span class="kw">timeCalendar</span>(<span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">m =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">Reyes &lt;-<span class="st"> </span><span class="kw">timeCalendar</span>(<span class="dt">d =</span> <span class="dv">6</span>, <span class="dt">m =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">ViernesSanto &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">-2</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">DiaTrabajo &lt;-<span class="st"> </span><span class="kw">timeCalendar</span>(<span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">m =</span> <span class="dv">5</span>, <span class="dt">y =</span> <span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">Asuncion &lt;-<span class="st"> </span><span class="kw">timeCalendar</span>(<span class="dt">d =</span> <span class="dv">15</span>, <span class="dt">m =</span> <span class="dv">8</span>, <span class="dt">y =</span> <span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">Hispanidad &lt;-<span class="st"> </span><span class="kw">timeCalendar</span>(<span class="dt">d =</span> <span class="dv">12</span>, <span class="dt">m =</span> <span class="dv">10</span>, <span class="dt">y =</span> <span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">TodoSantos &lt;-<span class="st"> </span><span class="kw">timeCalendar</span>(<span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">m =</span> <span class="dv">11</span>, <span class="dt">y =</span> <span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">Constitucion &lt;-<span class="st"> </span><span class="kw">timeCalendar</span>(<span class="dt">d =</span> <span class="dv">6</span>, <span class="dt">m =</span> <span class="dv">12</span>, <span class="dt">y =</span> <span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">Inmaculada &lt;-<span class="st"> </span><span class="kw">timeCalendar</span>(<span class="dt">d =</span> <span class="dv">8</span>, <span class="dt">m =</span> <span class="dv">12</span>, <span class="dt">y =</span> <span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">Navidad &lt;-<span class="st"> </span><span class="kw">timeCalendar</span>(<span class="dt">d =</span> <span class="dv">25</span>, <span class="dt">m =</span> <span class="dv">12</span>, <span class="dt">y =</span> <span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">FestivosNacionales &lt;-<span class="st"> </span><span class="kw">c</span>(AnoNuevo, Reyes, ViernesSanto,</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">                        DiaTrabajo, Asuncion,  Hispanidad, TodoSantos, </a>
<a class="sourceLine" id="cb5-14" data-line-number="14">                        Constitucion, Inmaculada, Navidad)</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16">fechaDiaria &lt;-<span class="st"> </span><span class="kw">timeSequence</span>(<span class="dt">from =</span> <span class="st">&quot;1996-01-01&quot;</span>, <span class="dt">to =</span> <span class="st">&quot;2024-12-31&quot;</span>)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">biz &lt;-<span class="st"> </span>fechaDiaria[<span class="kw">isBizday</span>(fechaDiaria, <span class="dt">holidays =</span> FestivosNacionales)]</a>
<a class="sourceLine" id="cb5-18" data-line-number="18">bizdays &lt;-<span class="st"> </span><span class="kw">format</span>(biz, <span class="dt">format =</span> <span class="st">&quot;%Y-%m&quot;</span>)</a>
<a class="sourceLine" id="cb5-19" data-line-number="19"></a>
<a class="sourceLine" id="cb5-20" data-line-number="20">DiasLaborables &lt;-<span class="st"> </span><span class="kw">table</span>(bizdays)</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">DiasLaborables &lt;-<span class="st"> </span><span class="kw">ts</span>(DiasLaborables, <span class="dt">start =</span> <span class="dv">1996</span>, <span class="dt">frequency =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb5-22" data-line-number="22"></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="kw">subset</span>(DiasLaborables, <span class="dt">start =</span> <span class="dv">289</span>) <span class="co">#Mostramos solo los 5 últimos años</span></a></code></pre></div>
<pre><code>     Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
2020  21  20  22  21  20  22  23  21  22  21  21  21
2021  19  20  23  21  21  22  22  22  22  20  21  21
2022  20  20  23  20  22  22  21  22  22  20  21  20
2023  21  20  23  19  22  22  21  22  21  21  21  18
2024  22  21  20  22  22  20  23  21  21  23  20  20</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">pDiasLaborables &lt;-<span class="st"> </span><span class="kw">subset</span>(DiasLaborables, <span class="dt">start =</span> <span class="kw">length</span>(DiasLaborables) <span class="op">-</span><span class="st"> </span><span class="dv">59</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">DiasLaborables &lt;-<span class="st"> </span><span class="kw">subset</span>(DiasLaborables, <span class="dt">end =</span> <span class="kw">length</span>(DiasLaborables) <span class="op">-</span><span class="st"> </span><span class="dv">60</span>)</a></code></pre></div>
<p>Es conveniente indicar que la identificación de las festividades nacionales dista de ser perfecta por varios motivos:</p>
<ul>
<li>algunos festivos nacionales, si caen en domingo, se pasan a lunes (por ejemplo Reyes y la Inmaculada de 2019), aspecto que no se ha tenido en cuenta.</li>
<li>algunos festivos nacionales pueden ser sustituidos por otros días por las Comunidades Autónomas, por ejemplo Reyes o Jueves Santo.</li>
</ul>
<p><br />
</p>
</div>
<div id="análisis-gráfico-de-la-estacionalidad" class="section level3 unnumbered">
<h3>Análisis gráfico de la estacionalidad</h3>
<p>Veamos ahora una descriptiva detallada de la estacionalidad de la serie Pasajeros, haciendo especial hincapié en el efecto de las vacaciones (verano y Semana Santa) y el número de días laborables. Para ello, mostraremos gráficamente las subseries definidas por el mes tanto para Pasajeros como para <em>Pasajeros por día laborable</em>, esta segunda resultado de dividir Pasajeros por DiasLaborables.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">PasajerosDL &lt;-<span class="st"> </span>Pasajeros<span class="op">/</span>DiasLaborables</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">g1 &lt;-<span class="st"> </span><span class="kw">ggsubseriesplot</span>(Pasajeros) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Millones de pasajeros&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figura 2.3a. Gráfico estacional para Pasajeros&quot;</span>)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">g2 &lt;-<span class="st"> </span><span class="kw">ggsubseriesplot</span>(PasajerosDL) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Millones de pasajeros&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figura 2.3b. Gráfico estacional para Pasajeros por día laboral&quot;</span>)</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="kw">grid.arrange</span>(</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">  <span class="dt">grobs =</span> <span class="kw">list</span>(g1, g2),</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">  <span class="dt">ncol =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16">)</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-6-1.png" width="80%" style="display: block; margin: auto;" /> Las figuras 2.3a y 2.3b muestran para cada mes la serie de pasajeros (total o por día laborable) y el valor medio (línea azul horizontal). En ambos casos se identifica perfectamente el efecto de los periodos vacacionales sobre el transporte urbano de pasajeros. En las vacaciones de verano se observa una fuerte caída en el número de pasajeros, especialmente en agosto y, en menor medida, en julio y septiembre. Por otro lado, las subseries de marzo y abril muestran mucha más irregularidad que las de otros meses debido a que el volumen de pasajeros depende de cómo ha caído la Semana Santa. Si un año esta cae en marzo, ese mes presentará un volumen de pasajeros inferior al de los meses de marzo sin Semana Santa, mientras que en abril se dará el efecto contrario. Diciembre, para ser un mes de 31 días, presenta también un reducido número de pasajeros debido a las vacaciones navideñas.</p>
<p>La figura 2.3a muestra el efecto estacional total debido al número de días del mes y de días laborales. Por ejemplo, en febrero, el mes con menos días y por tanto con menos días laborales, en media se transportan menos pasajeros, comparado con enero o marzo. Octubre, un mes con 31 días, muestra un volumen medio de pasajeros mayor que noviembre de 30 días.</p>
<p>En la figura 2.3b se ha eliminado el efecto de los días laborables al trabajar con la serie de pasajeros transportados por día laborable. Si la comparamos con la figura 2.3a, destaca que las diferencias entre las medias (lineas azules) se han reducido: prácticamente no hay diferencias entre los meses de enero a junio, o entre los meses de octubre a diciembre.</p>
<p>Cabe pensar que al excluir de la serie de días laborables la Semana Santa, en la figura 2.3b las subseries de marzo y abril deberían ser tan suaves como las observadas para otro meses, pero no es así. Claramente la simple exclusión de los festivos nacionales de Semana Santa no es suficiente para recoger bien su efecto sobre el transporte urbano. La razón hay que buscarla en las vacaciones escolares de este periodo, que en algunas comunidades autónomas tiene lugar durante la propia semana de Semana Santa, mientras que en otras comunidades tiene lugar en la semana posterior. De esta forma, el efecto sobre el transporte urbano de Semana Santa no es homogéneo en el territorio nacional y resulta difícil incluirlo en el análisis de la serie Pasajeros. Cuando se analice la serie por modelos Arima será conveniente recordar este hecho.</p>
<p><br />
</p>
</div>
<div id="análisis-numérico-de-la-estacionalidad" class="section level3 unnumbered">
<h3>Análisis numérico de la estacionalidad</h3>
<p>Podemos obtener la componente estacional de forma sencilla para poder valorar numéricamente el efecto estacional y ver que efecto tiene el número de días laborables. Previamente, debemos determinar el esquema, aditivo o multiplicativo, de la serie.</p>
<p>La gráfica media-desviación típica (figura 2.4) refuerza la impresión que se obtenía de la gráfica de la serie (figura 2.1), que el esquema es aditivo.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">MediaAnual =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">aggregate</span>(Pasajeros, <span class="dt">FUN =</span> mean))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">DesviacionAnual =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">aggregate</span>(Pasajeros, <span class="dt">FUN =</span> sd))</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> MediaAnual, <span class="dt">y =</span> DesviacionAnual), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Media de pasajeros por año&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Desviación típica de pasajeros por año&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figura 2.4. Identificación del tipo de esquema&quot;</span>)</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-7-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">PasajerosMedia &lt;-<span class="st"> </span><span class="kw">tapply</span>(Pasajeros <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Pasajeros), </a>
<a class="sourceLine" id="cb10-2" data-line-number="2">                         <span class="kw">cycle</span>(Pasajeros), </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                         mean)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">PasajerosDLMedia &lt;-<span class="st"> </span><span class="kw">tapply</span>((PasajerosDL <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(PasajerosDL)), </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                           <span class="kw">cycle</span>(PasajerosDL), </a>
<a class="sourceLine" id="cb10-6" data-line-number="6">                           mean)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8">datos &lt;-<span class="st"> </span><span class="kw">cbind</span>(PasajerosMedia, PasajerosDLMedia)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="kw">colnames</span>(datos) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Pasajeros&quot;</span>, <span class="st">&quot;Pasajeros por día laborable&quot;</span>)</a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="kw">rownames</span>(datos) &lt;-<span class="st"> </span>meses</a>
<a class="sourceLine" id="cb10-11" data-line-number="11"></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="kw">kable</span>(datos, </a>
<a class="sourceLine" id="cb10-13" data-line-number="13">      <span class="dt">digits =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">      <span class="dt">caption =</span> <span class="st">&quot;Efecto estacional&quot;</span>)</a></code></pre></div>
<table>
<caption>Efecto estacional</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Pasajeros</th>
<th align="right">Pasajeros por día laborable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Ene</td>
<td align="right">3.17</td>
<td align="right">0.32</td>
</tr>
<tr class="even">
<td align="left">Feb</td>
<td align="right">-0.36</td>
<td align="right">0.46</td>
</tr>
<tr class="odd">
<td align="left">Mar</td>
<td align="right">17.71</td>
<td align="right">0.47</td>
</tr>
<tr class="even">
<td align="left">Abr</td>
<td align="right">3.37</td>
<td align="right">0.35</td>
</tr>
<tr class="odd">
<td align="left">May</td>
<td align="right">19.12</td>
<td align="right">0.70</td>
</tr>
<tr class="even">
<td align="left">Jun</td>
<td align="right">6.31</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="left">Jul</td>
<td align="right">-15.09</td>
<td align="right">-1.22</td>
</tr>
<tr class="even">
<td align="left">Ago</td>
<td align="right">-71.66</td>
<td align="right">-3.51</td>
</tr>
<tr class="odd">
<td align="left">Sep</td>
<td align="right">-7.76</td>
<td align="right">-0.50</td>
</tr>
<tr class="even">
<td align="left">Oct</td>
<td align="right">27.61</td>
<td align="right">1.05</td>
</tr>
<tr class="odd">
<td align="left">Nov</td>
<td align="right">15.35</td>
<td align="right">0.97</td>
</tr>
<tr class="even">
<td align="left">Dic</td>
<td align="right">2.21</td>
<td align="right">0.74</td>
</tr>
</tbody>
</table>
<p>La tabla 1 pone en cifras el efecto estacional sobre los Pasajeros (primera columna): en agosto la caída en el número de pasajeros, respecto de la media anual, se cifra en 72 millones de pasajeros. En julio, septiembre y en menor medida febrero también el uso del transporte urbano es inferior a la media anual, en el caso de los dos primeros meses por las vacaciones de verano y en febrero debido a ser el mes con menos días del año. Por otro lado, destaca el elevado número de pasajeros en los meses de marzo, mayo y octubre, por tener 31 días, y noviembre, por razones desconocidas.</p>
<p>Tras la corrección por el número de días laborales, el efecto estacional es más suave (véase la segunda columna en la tabla 1). Ahora, los meses de febrero y marzo tienen un efecto similar, al igual que octubre y noviembre. También se observa que las diferencias entre marzo y abril se han reducido enormemente. También el efecto <em>número de días del mes</em> ha desaparecido en gran medida.</p>
<p><br />
</p>
</div>
</div>
<div id="descomposición-de-la-serie" class="section level2">
<h2><span class="header-section-number">2.3</span> Descomposición de la serie</h2>
<p>Ya hemos realizado una detallada descripción de las principales componentes de la serie, tendencia y estacionalidad. Ahora vamos a proceder a descomponerla a fin de analizar, aunque sea de forma gráfica, el error y tener ya una primera impresión sobre la relevancia de la componente de intervención en Pasajeros.</p>
<p>Dado que la serie presenta un esquema aditivo, usaremos el método de descomposición por regresiones locales ponderadas, asumiendo una componente estacional constante y considerando la presencia de posibles valores extremos.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">PasajerosStl &lt;-<span class="st"> </span><span class="kw">stl</span>(Pasajeros[,<span class="dv">1</span>], <span class="dt">s.window =</span> <span class="st">&quot;periodic&quot;</span>, <span class="dt">robust =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">error &lt;-<span class="st"> </span><span class="kw">remainder</span>(PasajerosStl)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">sderror &lt;-<span class="st"> </span><span class="kw">sd</span>(error)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="kw">autoplot</span>(error,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">         <span class="dt">ylab =</span> <span class="st">&quot;Error&quot;</span>,</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">         <span class="dt">main =</span> <span class="st">&quot;Figura 2.5. Error + Intervención&quot;,</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="st">         colour = &quot;</span>darkblue<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="st">  geom_hline(yintercept = c(3, 2, -2, -3)*sderror, </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="st">             colour = c(&quot;</span>red<span class="st">&quot;, &quot;</span>green<span class="st">&quot;, &quot;</span>green<span class="st">&quot;, &quot;</span>red<span class="st">&quot;),</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="st">             lty = 2) + </span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="st">  scale_x_continuous(breaks= seq(1996, 2019, 4))</span></a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-9-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>La figura 2.5 muestra el error de la descomposición y los intervalos de confianza al 95% (líneas verdes) y el 99.7% (líneas rojas). Se aprecian claramente múltiples valores extremos (superan las tres desviaciones típicas) en forma de <em>compensación</em> (dos errores extremos consecutivos de signo opuesto) que corresponden a los meses de marzo y abril de 1997, 2002, 2008 y 2013, y otro valor extremo en abril de 2005. Además, en marzo y abril de 2016 hay dos valores atípicos. Nótese que todos los valores identificados corresponden a los meses de marzo y abril, y en todos los casos el error negativo tiene lugar en marzo y el positivo en abril. Si miramos un calendario veremos que tienen lugar en los años en que Semana Santa cayó en marzo.</p>
<p>Si repetimos este análisis para la serie de Pasajeros por día laborable, los resultados son bien diferentes (véase figura 2.6). Ahora solo se detectan dos valores extremos en diciembre de 2000 y 2006. También destaca el error de diciembre de 2017. Los errores en diciembre se dan cuando Navidad cae en lunes, de forma que la caída en el transporte urbano debida a la nochebuena coincide con la de cualquier domingo. Así, estos meses de diciembre presentan más transporte urbano que los meses de diciembre donde la nochebuena cae entre semana.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">PasajerosStl &lt;-<span class="st"> </span><span class="kw">stl</span>(PasajerosDL[,<span class="dv">1</span>], <span class="dt">s.window =</span> <span class="st">&quot;periodic&quot;</span>, <span class="dt">robust =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">error &lt;-<span class="st"> </span><span class="kw">remainder</span>(PasajerosStl)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">sderror &lt;-<span class="st"> </span><span class="kw">sd</span>(error)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw">autoplot</span>(error,</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">         <span class="dt">ylab =</span> <span class="st">&quot;Error&quot;</span>,</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">         <span class="dt">main =</span> <span class="st">&quot;Figura 2.6. Error + Intervención&quot;,</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="st">         colour = &quot;</span>darkblue<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="st">  geom_hline(yintercept = c(3, 2, -2, -3)*sderror, </span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="st">             colour = c(&quot;</span>red<span class="st">&quot;, &quot;</span>green<span class="st">&quot;, &quot;</span>green<span class="st">&quot;, &quot;</span>red<span class="st">&quot;),</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="st">             lty = 2) + </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="st">  scale_x_continuous(breaks= seq(1996, 2019, 4))</span></a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-10-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Para la identificación de los valores extremos se ha hecho uso de las funciones <code>easter</code> del paquete <code>forecast</code> y <code>dayOfWeek</code> del paquete <code>timeDate</code>.</p>
<p><br />
</p>
</div>
<div id="conclusión" class="section level2">
<h2><span class="header-section-number">2.4</span> Conclusión</h2>
<p>La serie de pasajeros en transporte urbano muestra una tendencia creciente solo interrumpida entre 2008 y 2013 debido a la reciente crisis económica.</p>
<p>Los principales determinantes de la estacionalidad de la serie Pasajeros son los grandes periodos vacacionales en España (Semana Santa y verano) y el número de días laborales del mes. Sin embargo, en la serie Pasajeros corregida por días laborables, la componente estacional se ha suavizado y prácticamente queda determinada por las vacaciones.</p>
<p>La intervención tiene lugar en los meses de marzo y abril debido al carácter móvil de la Semana Santa, y en diciembre cuando el día de Navidad cae en lunes de forma que la caída de pasajeros de nochebuena se solapa con la de cualquier domingo.</p>
<p><br />
<br />
</p>
</div>
</div>
<div id="un-predicción-rápida-y-sencilla" class="section level1">
<h1><span class="header-section-number">3</span> Un predicción rápida y sencilla</h1>
<p>En los siguientes epígrafes aplicaremos técnicas de predicción crecientes en complejidad conceptual y computacional, y que requerirán de más hipótesis para su correcta aplicación. Aunque actualmente más complejidad no siempre implica más recursos (temporales, humanos, informáticos), cabe preguntarse si vale la pena. Así, más por una cuestión teórica que práctica, veamos cual sería la calidad de las predicciones si aplicamos una metodología sencilla, en este caso el método ingenuo con estacionalidad.</p>
<p>Los indicadores de calidad de ajuste (predicción intra-muestral a un periodo vista) indican que repetir la última observación del mismo mes puede ser suficiente para obtener una buena predicción a corto plazo. En media el error es de 11 millones de pasajeros (RMSE), aproximadamente un 3.5%. A largo plazo, las predicciones pueden perder calidad rápidamente puesto que no capturan ningún tipo de tendencia. La figura 3.1 muestra como la predicción del número de pasajeros para los años 2020 a 2024 se mantiene estacionaria y no refleja la tendencia creciente observada desde 2014.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">PasajerosSnaive &lt;-<span class="st"> </span><span class="kw">snaive</span>(Pasajeros, <span class="dt">h =</span> <span class="dv">60</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">accuracy</span>(PasajerosSnaive)</a></code></pre></div>
<pre><code>                   ME     RMSE      MAE       MPE     MAPE MASE         ACF1
Training set 2.395109 10.97663 8.274051 0.9596103 3.513767    1 -0.009148132</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">autoplot</span>(PasajerosSnaive, </a>
<a class="sourceLine" id="cb15-2" data-line-number="2">         <span class="dt">PI =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">         <span class="dt">ylab =</span> <span class="st">&quot;Millones de pasajeros&quot;</span>,</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">         <span class="dt">main =</span> <span class="st">&quot;Figura 3.1. Pasajeros en transporte urbano y predicción.</span><span class="ch">\n</span><span class="st">Método ingenuo con estacionalidad&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span> <span class="kw">seq</span>(<span class="dv">1996</span>, <span class="dv">2024</span>, <span class="dv">2</span>))</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-12-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Este será nuestro punto de referencia. Cabe esperar que en los siguientes epígrafes, donde aplicaremos técnicas de Alisado exponencial y modelos Arima, se observe un incremento significativo en la calidad del ajuste.</p>
<p><strong>Nota</strong>: la Covid-19 ha supuesto un <em>shock</em> de una magnitud inesperada en todos los aspectos de la sociedad española y, en concreto, en los hábitos de transporte urbano. Es por ello que todas las predicciones que aparecen en este ejemplo de aplicación sobre-estimarán enormemente las cifras de transporte reales. Cualquier método de predicción asume que las condiciones del entorno en que se aplica no van a cambiar en el futuro.</p>
<p><br />
<br />
</p>
</div>
<div id="alisado-exponencial" class="section level1">
<h1><span class="header-section-number">4</span> Alisado exponencial</h1>
<p>En primer lugar analizaremos la capacidad predictiva de los métodos de Alisado exponencial sobre la serie Pasajeros. Con este fin, ajustaremos el mejor modelo de alisado y estimaremos los criterios de calidad para el ajuste y las predicciones extra-muestrales según el horizonte temporal. Posteriormente veremos si es posible mejorar las predicciones analizando la transformación logarítmica de Pasajeros y analizando la serie Pasajeros por día laborable.</p>
<p><br />
</p>
<div id="análisis-de-la-serie-pasajeros" class="section level2">
<h2><span class="header-section-number">4.1</span> Análisis de la serie Pasajeros</h2>
<p><br />
</p>
<div id="estimación-e-interpretación" class="section level3 unnumbered">
<h3>Estimación e interpretación</h3>
<p>El modelo óptimo, estimado con la función <code>ets</code> sin imponer ninguna restricción, es ETS(M,Ad,A): pendiente aditiva con amortiguamiento, estacionalidad aditiva y residuo multiplicativo. <span class="math display">\[y_{t+1} = (l_t + \phi b_t + s_{t+1-m}) \cdot (1 + \varepsilon_{t+1}).\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">PasajerosEts &lt;-<span class="st"> </span><span class="kw">ets</span>(Pasajeros, <span class="dt">model =</span> <span class="st">&quot;ZZZ&quot;</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">summary</span>(PasajerosEts) </a></code></pre></div>
<pre><code>ETS(M,Ad,A) 

Call:
 ets(y = Pasajeros, model = &quot;ZZZ&quot;) 

  Smoothing parameters:
    alpha = 0.1399 
    beta  = 0.0155 
    gamma = 0.0001 
    phi   = 0.9519 

  Initial states:
    l = 203.0359 
    b = -0.2422 
    s = 1.6552 13.7019 27.0824 -8.5191 -72.2385 -15.5654
           6.9185 19.6327 4.3478 18.4248 0.7125 3.8471

  sigma:  0.0334

     AIC     AICc      BIC 
2824.586 2827.129 2890.519 

Training set error measures:
                    ME     RMSE      MAE      MPE     MAPE      MASE       ACF1
Training set 0.5607875 7.495515 5.663654 0.159973 2.454865 0.6845081 -0.1445364</code></pre>
<p>El valor de <span class="math inline">\(\phi=\)</span> 0.95 indica que la inclusión de amortiguamiento en el modelo mejora sensiblemente su ajuste a los datos. Por otro lado, <span class="math inline">\(\gamma\)</span> es técnicamente cero, indicando que el efecto estacional se mantiene constante en el tiempo. Sin embargo, el valor de <span class="math inline">\(\beta\)</span>, reducido pero no nulo, indica que la pendiente cambia en el tiempo de forma muy lenta.</p>
<p>La calidad del ajuste es bastante buena, con un error porcentual del 2.5% o un error de 7.5 millones de pasajeros (RMSE). La aplicación del método de alisado supone una reducción de un punto en el error porcentual respecto del método ingenuo, o una reducción de 3.5 millones de pasajeros. Es decir, el modelo de alisado exponencial supone una mejora en la calidad del ajuste del 32% respecto del método ingenuo con estacionalidad visto en el epígrafe previo (MASE).</p>
<p>El efecto estacional, que recordemos se mantiene constante en el tiempo, es prácticamente idéntico al estimado en la descriptiva y viene determinado por los periodos vacacionales y el número de días del mes (y por consiguiente el número de días laborables). Véase la figura 4.1.</p>
<p>En verano (julio a septiembre) el uso del transporte urbano es inferior a la media anual, destacando agosto con un descenso de 72 millones de pasajeros. A su vez, octubre destaca por ser el mes con mayor incremento en el volumen de pasajeros (27 millones) respecto de la media anual.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">PasajerosEtsEst &lt;-<span class="st"> </span>PasajerosEts<span class="op">$</span>states[<span class="kw">nrow</span>(PasajerosEts<span class="op">$</span>states), <span class="dv">14</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">names</span>(PasajerosEtsEst) &lt;-<span class="st"> </span>meses</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="kw">round</span>(PasajerosEtsEst, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>   Ene    Feb    Mar    Abr    May    Jun    Jul    Ago    Sep    Oct    Nov 
  3.85   0.71  18.43   4.35  19.63   6.92 -15.56 -72.24  -8.52  27.08  13.71 
   Dic 
  1.65 </code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">y =</span> PasajerosEtsEst), <span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figura 4.1. Componente estacional estimada con Alisado exponencial&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Efecto estacional&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, </a>
<a class="sourceLine" id="cb20-8" data-line-number="8">                     <span class="dt">labels =</span> meses)</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-14-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
<div id="predicción" class="section level3 unnumbered">
<h3>Predicción</h3>
<p>Podemos ahora pedir los valores de predicción y su intervalo de confianza al 95% para los próximos cinco años. No mostramos los resultados numéricos, pero si gráficos (figura 4.2). Las predicciones muestran una tendencia creciente amortiguada y, por tanto, no tan acusada como la observada en los años precedentes.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">PasajerosEtsPre &lt;-<span class="st"> </span><span class="kw">forecast</span>(PasajerosEts, <span class="dt">h =</span> <span class="dv">60</span>, <span class="dt">level =</span> <span class="dv">95</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">autoplot</span>(PasajerosEtsPre,</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">         <span class="dt">ylab =</span> <span class="st">&quot;Millones de pasajeros&quot;</span>,</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">         <span class="dt">main =</span> <span class="st">&quot;Figura 4.2. Pasajeros (1996-2019) y predicción (2020-2024).</span><span class="ch">\n</span><span class="st">Método de alisado exponencial&quot;</span>) </a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-15-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>En el año 2020 se esperan 3163 millones de pasajeros, un 1.8% más que en 2019.</p>
<p><br />
</p>
</div>
<div id="análisis-del-error" class="section level3 unnumbered">
<h3>Análisis del error</h3>
<p>El residuo del modelo (figura 4.3) muestra varios valores que pueden ser considerados como atípicos y que se dan siempre en los meses de marzo y abril para los años donde la Semana Santa recayó en marzo.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">error &lt;-<span class="st"> </span><span class="kw">residuals</span>(PasajerosEts)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">sderror &lt;-<span class="st"> </span><span class="kw">sd</span>(error)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="kw">autoplot</span>(error,</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">         <span class="dt">ylab =</span> <span class="st">&quot;Error&quot;</span>,</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">         <span class="dt">main =</span> <span class="st">&quot;Figura 4.3. Error + Intervención. Método de alisado&quot;</span>,</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">         <span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">-2</span>, <span class="dv">2</span> ,<span class="dv">3</span>)<span class="op">*</span>sderror, </a>
<a class="sourceLine" id="cb22-10" data-line-number="10">             <span class="dt">colour =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span> <span class="kw">seq</span>(<span class="dv">1996</span>, <span class="dv">2019</span>, <span class="dv">2</span>))</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-16-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
</div>
<div id="otras-alternativas-de-análisis" class="section level2">
<h2><span class="header-section-number">4.2</span> Otras alternativas de análisis</h2>
<p>En la descriptiva se ha visto que la serie de pasajeros por día laborable tiene un comportamiento más suave (la componente estacional era más plana) y presentaba un menor número de valores atípicos que la serie original Pasajeros. Cabe esperar, por tanto, que esta serie presente un mejor ajuste con los métodos de alisado exponencial y ofrezca mejores predicciones.</p>
<p>Por otro lado, siempre vale la pena analizar la transformación logarítmica de la serie y ver si ofrece mejores resultados que la serie original. La transformación logarítmica es especialmente eficaz para series no lineales, así que para Pasajeros posiblemente no suponga ningún mejora.</p>
<p>Las transformaciones indicadas en los dos párrafos precedentes son solo dos de las posibles. También se pude analizar la serie de pasajeros por día del mes o la transformación óptima de Box-Cox. La idea es no quedarse con lo inmediato, la serie tal cual nos la han ofrecido, sino probar otras alternativas. Por ejemplo, la serie de Pasajeros es el agregado del número de pasajeros que viajan en transporte urbano según el tipo de transporte (autobús, metro, tranvía…). Se podría proceder a analizar cada serie por separado (pasajeros en autobús, pasajeros en metro, etc.), para luego agregar los resultados y ver si este enfoque da mejores resultados que el análisis directo de la serie agregada Pasajeros.</p>
<p>En este epígrafe se analizarán las dos primeras transformaciones indicadas, la transformación logarítmica y los pasajeros por día laborable. El objetivo es ver si es posible mejorar la calidad de las predicciones obtenidas para Pasajeros. Se usará como criterio de bondad el error de las predicciones extra-muestrales según el horizonte temporal, obtenido con el procedimiento <em>origen de predicción móvil</em>. Asumiremos que son necesarios 10 años para obtener una buena estimación del modelo y el horizonte temporal se fijará en 12 meses (<span class="math inline">\(k = 120, h = 12\)</span>). Previamente, hay que identificar el mejor modelo para las series transformadas.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">ets</span>(PasajerosDL)<span class="op">$</span>method</a></code></pre></div>
<pre><code>[1] &quot;ETS(M,Ad,A)&quot;</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">ets</span>(Pasajeros, <span class="dt">lambda =</span> <span class="dv">0</span>)<span class="op">$</span>method</a></code></pre></div>
<pre><code>[1] &quot;ETS(A,Ad,A)&quot;</code></pre>
<p><br />
</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">k &lt;-<span class="st"> </span><span class="dv">120</span>                 </a>
<a class="sourceLine" id="cb27-2" data-line-number="2">h &lt;-<span class="st"> </span><span class="dv">12</span>                  </a>
<a class="sourceLine" id="cb27-3" data-line-number="3">TT &lt;-<span class="st"> </span><span class="kw">length</span>(Pasajeros)  </a>
<a class="sourceLine" id="cb27-4" data-line-number="4">s &lt;-<span class="st"> </span>TT <span class="op">-</span><span class="st"> </span>k <span class="op">-</span><span class="st"> </span>h          </a>
<a class="sourceLine" id="cb27-5" data-line-number="5"></a>
<a class="sourceLine" id="cb27-6" data-line-number="6">mapeAlisadoPas &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, s <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, h)</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">mapeAlisadolPas &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, s <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, h)</a>
<a class="sourceLine" id="cb27-8" data-line-number="8">mapeAlisadoPasDL &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, s <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, h)</a>
<a class="sourceLine" id="cb27-9" data-line-number="9"></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>s) {</a>
<a class="sourceLine" id="cb27-11" data-line-number="11">  train.set &lt;-<span class="st"> </span><span class="kw">subset</span>(Pasajeros, <span class="dt">start =</span> i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">end =</span> i <span class="op">+</span><span class="st"> </span>k)</a>
<a class="sourceLine" id="cb27-12" data-line-number="12">  test.set &lt;-<span class="st">  </span><span class="kw">subset</span>(Pasajeros, <span class="dt">start =</span> i <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">end =</span> i <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span>h)</a>
<a class="sourceLine" id="cb27-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb27-14" data-line-number="14">  trainDL.set &lt;-<span class="st"> </span><span class="kw">subset</span>(PasajerosDL, <span class="dt">start =</span> i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">end =</span> i <span class="op">+</span><span class="st"> </span>k)</a>
<a class="sourceLine" id="cb27-15" data-line-number="15">  testDL.set &lt;-<span class="st">  </span><span class="kw">subset</span>(PasajerosDL, <span class="dt">start =</span> i <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">end =</span> i <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span>h)</a>
<a class="sourceLine" id="cb27-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb27-17" data-line-number="17">  fit &lt;-<span class="st"> </span><span class="kw">ets</span>(train.set, <span class="dt">model =</span> <span class="st">&quot;MAA&quot;</span>, <span class="dt">damped =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb27-18" data-line-number="18">  fcast &lt;-<span class="st"> </span><span class="kw">forecast</span>(fit, <span class="dt">h =</span> h)</a>
<a class="sourceLine" id="cb27-19" data-line-number="19">  mapeAlisadoPas[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="dv">100</span><span class="op">*</span><span class="kw">abs</span>(test.set <span class="op">-</span><span class="st"> </span>fcast<span class="op">$</span>mean)<span class="op">/</span>test.set</a>
<a class="sourceLine" id="cb27-20" data-line-number="20">  </a>
<a class="sourceLine" id="cb27-21" data-line-number="21">  fit &lt;-<span class="st"> </span><span class="kw">ets</span>(train.set, <span class="dt">model =</span> <span class="st">&quot;AAA&quot;</span>, <span class="dt">damped =</span> <span class="ot">TRUE</span>, <span class="dt">lambda =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb27-22" data-line-number="22">  fcast &lt;-<span class="st"> </span><span class="kw">forecast</span>(fit, <span class="dt">h =</span> h, <span class="dt">biasadj =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb27-23" data-line-number="23">  mapeAlisadolPas[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="dv">100</span><span class="op">*</span><span class="kw">abs</span>(test.set <span class="op">-</span><span class="st"> </span>fcast<span class="op">$</span>mean)<span class="op">/</span>test.set</a>
<a class="sourceLine" id="cb27-24" data-line-number="24">  </a>
<a class="sourceLine" id="cb27-25" data-line-number="25">  fit &lt;-<span class="st"> </span><span class="kw">ets</span>(trainDL.set, <span class="dt">model =</span> <span class="st">&quot;MAA&quot;</span>, <span class="dt">damped =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb27-26" data-line-number="26">  fcast &lt;-<span class="st"> </span><span class="kw">forecast</span>(fit, <span class="dt">h =</span> h)</a>
<a class="sourceLine" id="cb27-27" data-line-number="27">  mapeAlisadoPasDL[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="dv">100</span><span class="op">*</span><span class="kw">abs</span>(testDL.set <span class="op">-</span><span class="st"> </span>fcast<span class="op">$</span>mean)<span class="op">/</span>testDL.set</a>
<a class="sourceLine" id="cb27-28" data-line-number="28">}</a>
<a class="sourceLine" id="cb27-29" data-line-number="29"></a>
<a class="sourceLine" id="cb27-30" data-line-number="30">errorAlisadoPas &lt;-<span class="st"> </span><span class="kw">colMeans</span>(mapeAlisadoPas)</a>
<a class="sourceLine" id="cb27-31" data-line-number="31">errorAlisadoPasDL &lt;-<span class="st"> </span><span class="kw">colMeans</span>(mapeAlisadoPasDL)</a>
<a class="sourceLine" id="cb27-32" data-line-number="32">errorAlisadolPas &lt;-<span class="st"> </span><span class="kw">colMeans</span>(mapeAlisadolPas)</a>
<a class="sourceLine" id="cb27-33" data-line-number="33"></a>
<a class="sourceLine" id="cb27-34" data-line-number="34">datos &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, errorAlisadoPas, errorAlisadoPasDL, errorAlisadolPas)</a>
<a class="sourceLine" id="cb27-35" data-line-number="35"><span class="kw">colnames</span>(datos) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Horizonte&quot;</span>, <span class="st">&quot;Pasajeros&quot;</span>, </a>
<a class="sourceLine" id="cb27-36" data-line-number="36">                     <span class="st">&quot;Pasajeros por día laborable&quot;</span>, <span class="st">&quot;Pasajeros (log)&quot;</span>)</a>
<a class="sourceLine" id="cb27-37" data-line-number="37"></a>
<a class="sourceLine" id="cb27-38" data-line-number="38"><span class="kw">kable</span>(datos, </a>
<a class="sourceLine" id="cb27-39" data-line-number="39">      <span class="dt">digits =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb27-40" data-line-number="40">      <span class="dt">caption =</span> <span class="st">&quot;MAPE según serie y horizonte temporal&quot;</span>)</a></code></pre></div>
<table>
<caption>MAPE según serie y horizonte temporal</caption>
<thead>
<tr class="header">
<th align="right">Horizonte</th>
<th align="right">Pasajeros</th>
<th align="right">Pasajeros por día laborable</th>
<th align="right">Pasajeros (log)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2.58</td>
<td align="right">2.95</td>
<td align="right">2.78</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2.58</td>
<td align="right">2.80</td>
<td align="right">2.76</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2.62</td>
<td align="right">2.72</td>
<td align="right">2.85</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">2.81</td>
<td align="right">3.16</td>
<td align="right">2.90</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">2.82</td>
<td align="right">3.07</td>
<td align="right">2.92</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">2.88</td>
<td align="right">3.11</td>
<td align="right">3.02</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">3.07</td>
<td align="right">3.47</td>
<td align="right">3.15</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">3.07</td>
<td align="right">3.34</td>
<td align="right">3.28</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">3.13</td>
<td align="right">3.23</td>
<td align="right">3.14</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">3.40</td>
<td align="right">3.71</td>
<td align="right">3.43</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">3.49</td>
<td align="right">3.63</td>
<td align="right">3.53</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">3.62</td>
<td align="right">3.69</td>
<td align="right">3.71</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">datos &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">  <span class="dt">factor =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Pasajeros&quot;</span>, <span class="dv">12</span>), </a>
<a class="sourceLine" id="cb28-3" data-line-number="3">             <span class="kw">rep</span>(<span class="st">&quot;Pasajeros por día laborable&quot;</span>, <span class="dv">12</span>), </a>
<a class="sourceLine" id="cb28-4" data-line-number="4">             <span class="kw">rep</span>(<span class="st">&quot;Pasajeros (log)&quot;</span>, <span class="dv">12</span>)),</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">  <span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>),</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">  <span class="dt">y =</span> <span class="kw">c</span>(errorAlisadoPas, errorAlisadoPasDL, errorAlisadolPas)</a>
<a class="sourceLine" id="cb28-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb28-8" data-line-number="8"></a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="kw">ggplot</span>(datos, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y,  <span class="dt">colour=</span> factor)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figura 4.4. Error de predicción (MAPE) según horizonte temporal y enfoque&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Horizonte temporal de predicción&quot;) +</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="st">  ylab(&quot;</span>%<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14"><span class="st">  scale_x_continuous(breaks= 1:12) +</span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="st">  scale_y_continuous(breaks= seq(2.6, 4, .2)) +</span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="st">  guides(colour = guide_legend(title = &quot;</span>Métodos<span class="st">&quot;)) + </span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17"><span class="st">  theme(legend.position=c(0.02,0.98), legend.justification=c(0,1))</span></a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-18-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Antes de pasar al análisis de los resultados, indicar que en las predicciones sobre el logaritmo se ha pedido corrección por sesgo (<code>biasadj = TRUE</code>), y que al trabajar con errores porcentuales no es necesario pasar la predicción de pasajeros por día laborable a predicción de pasajeros.</p>
<p>El todos los casos el error aumenta con el horizonte temporal de predicción, de forma que las predicciones a doce meses vista tienen un error un punto porcentual superior a las predicciones a un mes vista. (Véase tabla 2)</p>
<p>Por otro lado, con independencia del horizonte temporal, las predicciones realizadas sobre la serie original Pasajeros son las más ajustadas, seguidas de las predicciones realizadas sobre su transformación logarítmica. En contra de lo esperado, la predicción a partir de la serie de pasajeros por día laborable es la que mayor error porcentual presenta, en media 0.25% puntos por encima del error de predicción de Pasajeros. (Véase figura 4.4.)</p>
<p><br />
</p>
</div>
<div id="conclusión-1" class="section level2">
<h2><span class="header-section-number">4.3</span> Conclusión</h2>
<p>Los modelos de Alisado exponencial resultan excelentes para predecir la serie Pasajeros. El error de ajuste, del 2.5%, es un punto inferior al error obtenido con el método ingenuo con estacionalidad. Además, en las predicciones extra-muestrales a 12 meses vista el error porcentual sigue manteniéndose bajo, no superando el 4%.</p>
<p>Ningún enfoque alternativo probado para la predicción del número de pasajeros por métodos de alisado ha dado mejores resultados que el análisis directo de la serie.</p>
<p><br />
<br />
</p>
</div>
</div>
<div id="modelos-arima" class="section level1">
<h1><span class="header-section-number">5</span> Modelos Arima</h1>
<p>La aplicación de la metodología Arima a la serie Pasajeros implica un notable incremento en la complejidad de los modelos y en los requerimientos estadísticos, que solo está justificada si se reduce adecuadamente el error de predicción.</p>
<p>En los epígrafes previos hemos visto que la serie Pasajeros tiene una componente de intervención muy acusada, destacando el número de días del mes, el de días laborables, el fechado de la Semana Santa y que el día de Navidad caiga en lunes. Cabe espera, por tanto, que la incorporación de estos efectos calendario en el análisis de la serie incremente significativamente la calidad de ajuste y la capacidad predictiva. Veamos si es así.</p>
<p><br />
</p>
<div id="transformación-de-la-serie-pasajeros" class="section level2">
<h2><span class="header-section-number">5.1</span> Transformación de la serie Pasajeros</h2>
<p>Por un lado, el análisis por Alisado exponencial ha puesto de relieve el carácter lineal de Pasajeros y la poca efectividad que tiene usar la transformación logarítmica para mejorar la calidad de las predicciones.</p>
<p>Por otro lado, tras un análisis preliminar por modelos Arima hemos visto que la transformación logarítmica mejoraba la identificación del modelo y facilitaba su interpretación.</p>
<p>Ante esta situación, hemos optado por identificar la transformación logarítmica de Pasajeros.</p>
<p>Las FAC del logaritmo de la serie y algunas de sus diferenciaciones (figura 5.1) indican que es necesaria la doble diferenciación regular y estacional para alcanzar las hipótesis de estacionariedad y ergodicidad: <span class="math inline">\(\log(Pasajeros) \sim I(1)I_{12}(1)\)</span>. Los resultados ofrecidos por las funciones <code>ndiffs</code> y <code>nsdiffs</code> apoyan esta conclusión.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">grid.arrange</span>(</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">  <span class="kw">ggAcf</span>(<span class="kw">log</span>(Pasajeros), <span class="dt">lag =</span> <span class="dv">72</span>, <span class="dt">main =</span> <span class="st">&quot;Figura 5.1. FAC para Pasajeros (log)&quot;</span>, </a>
<a class="sourceLine" id="cb29-3" data-line-number="3">        <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">log</span>(y[t]))),</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">  <span class="kw">ggAcf</span>(<span class="kw">diff</span>(<span class="kw">log</span>(Pasajeros)), <span class="dt">lag =</span> <span class="dv">72</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb29-5" data-line-number="5">        <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(nabla<span class="op">*</span><span class="kw">log</span>(y[t]))),</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">  <span class="kw">ggAcf</span>(<span class="kw">diff</span>(<span class="kw">log</span>(Pasajeros), <span class="dt">lag =</span> <span class="dv">12</span>),<span class="dt">lag =</span> <span class="dv">72</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb29-7" data-line-number="7">        <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(nabla[<span class="dv">12</span>]<span class="op">*</span><span class="kw">log</span>(y[t]))),</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">  <span class="kw">ggAcf</span>(<span class="kw">diff</span>(<span class="kw">diff</span>(<span class="kw">log</span>(Pasajeros), <span class="dt">lag=</span><span class="dv">12</span>)), <span class="dt">lag =</span> <span class="dv">72</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb29-9" data-line-number="9">        <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(nabla<span class="op">*</span>nabla[<span class="dv">12</span>]<span class="op">*</span><span class="kw">log</span>(y[t]))),</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">  <span class="dt">nrow =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11">)</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-19-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">ndiffs</span>(<span class="kw">log</span>(Pasajeros))</a></code></pre></div>
<pre><code>[1] 1</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">nsdiffs</span>(<span class="kw">log</span>(Pasajeros))</a></code></pre></div>
<pre><code>[1] 1</code></pre>
<p>La figura 5.2 muestra la serie original <span class="math inline">\(y_t\)</span> y la serie transformada <span class="math inline">\(\nabla \nabla_{12} \log(y_t)\)</span>. En la serie transformada destacan las compensaciones asociadas a la intervención de Semana Santa.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">series &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="st">&quot;Original&quot;</span> =<span class="st"> </span>Pasajeros,</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">                <span class="st">&quot;Dif reg. y est. de log&quot;</span> =<span class="st"> </span><span class="kw">diff</span>(<span class="kw">diff</span>(<span class="kw">log</span>(Pasajeros), <span class="dt">lag =</span> <span class="dv">12</span>)))</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="kw">autoplot</span>(series, <span class="dt">facets =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">         <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">         <span class="dt">main =</span> <span class="st">&quot;Figura 5.2. Pasajeros &quot;</span>)</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-21-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
<div id="identificación-de-la-serie-pasajeros" class="section level2">
<h2><span class="header-section-number">5.2</span> Identificación de la serie Pasajeros</h2>
<p>Vamos a identificar los valores de <span class="math inline">\(p\)</span>, <span class="math inline">\(q\)</span>, <span class="math inline">\(P\)</span> y <span class="math inline">\(Q\)</span> del proceso Arima. Para ello, solicitaremos con <code>auto.arima</code> y <code>seas</code> una identificación automática, en el primer caso incluyendo todos los efectos calendario ya identificados.</p>
<p><br />
</p>
<div id="identificación-automática-con-auto.arima" class="section level3 unnumbered">
<h3>Identificación automática con <code>auto.arima</code></h3>
<p>Para <em>ayudar</em> a la función <code>auto.arima</code> en el proceso de identificación vamos a definir previamente todas las variables de intervención que en el desarrollo del análisis de la serie hemos ido identificando: días del mes, días laborables del mes, meses de diciembre con el día de Navidad en lunes y Semana Santa:</p>
<ul>
<li>La variables <em>días laborables del mes</em> ya ha sido definida previamente como DiasLaborables.</li>
<li>La variable <em>Días del mes</em> se puede definir directamente con la función <code>monthdays</code> de la librería <code>forecast</code>. En lugar de días del mes, consideraremos la variable <em>días no laborables del mes</em>, resultante de restar a los días del mes los días laborables.</li>
<li>Los meses de diciembre en que el día de Navidad cae en lunes requiere un poco más de trabajo. La idea general es generar un rango de fechas diarias que cubra todo el periodo de análisis (variable <em>fechas</em>), identificar los lunes de Navidad (variable dicotómica <em>lunesNavidad</em>), eliminar el identificador del día del rango de fechas con la función <code>format</code> y, por último, con <code>tapply</code> sumar para cada mes-año los lunes de Navidad, que lógicamente solo tendrán lugar algunos meses de diciembre y una sola vez. En los objetos definidos con la función <code>as.POSIXlt</code> los meses van de 0 a 11 (enero a diciembre) y los días de la semana de 0 a 6 (domingo a sábado).</li>
<li>La creación de las variables de intervención que estiman el efecto de la Semana Santa es aún más complejo. El efecto del viernes de Semana Santa ya queda recogido en la variable DiasNoLaborables. Lo que vamos a hacer ahora es crear una variable que permita estimar el efecto de las vacaciones escolares (y de muchos padres y madres) de lunes a Jueves Santo en aquellas comunidades donde así es; y otra variable para estimar el efecto de las vacaciones escolares que tienen lugar la semana posterior al Domingo de Resurrección, de lunes a viernes tras Semana Santa. Estas nuevas variables (<em>DiasPreSanta</em> y <em>DiasPascua</em>) valdrán cero para los meses distintos de marzo y abril, pero para marzo valdrán la proporción de días vacacionales que recaen en marzo y para abril el opuesto (la proporción de días vacacionales que no caen el abril). Es decir, se genera un efecto compensación siempre que un periodo vacacional no recae íntegramente en abril y la magnitud de esta compensación es proporcional a la proporción de días vacacionales fuera de abril.</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">DiasNoLaborables &lt;-<span class="st"> </span><span class="kw">monthdays</span>(Pasajeros) <span class="op">-</span><span class="st"> </span>DiasLaborables</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">pDiasNoLaborables &lt;-<span class="st"> </span><span class="kw">monthdays</span>(PasajerosEtsPre<span class="op">$</span>mean) <span class="op">-</span><span class="st"> </span>pDiasLaborables</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"></a>
<a class="sourceLine" id="cb35-4" data-line-number="4">fechas &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">as.Date</span>(<span class="st">&quot;1996-1-1&quot;</span>), </a>
<a class="sourceLine" id="cb35-5" data-line-number="5">                         <span class="dt">to =</span> <span class="kw">as.Date</span>(<span class="st">&quot;2024-12-31&quot;</span>), </a>
<a class="sourceLine" id="cb35-6" data-line-number="6">                         <span class="dt">by =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb35-7" data-line-number="7">LunesNavidad &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span>(fechas<span class="op">$</span>wday <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>fechas<span class="op">$</span>mon <span class="op">==</span><span class="st"> </span><span class="dv">11</span> <span class="op">&amp;</span><span class="st"> </span>fechas<span class="op">$</span>mday <span class="op">==</span><span class="st"> </span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb35-8" data-line-number="8">fechas &lt;-<span class="st"> </span><span class="kw">format</span>(fechas, <span class="dt">format =</span> <span class="st">&quot;%Y-%m&quot;</span>)</a>
<a class="sourceLine" id="cb35-9" data-line-number="9">LunesNavidad &lt;-<span class="st"> </span><span class="kw">tapply</span>(LunesNavidad, fechas, sum)</a>
<a class="sourceLine" id="cb35-10" data-line-number="10">LunesNavidad &lt;-<span class="st"> </span><span class="kw">ts</span>(LunesNavidad, <span class="dt">start =</span> <span class="dv">1996</span>, <span class="dt">frequency =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb35-11" data-line-number="11">pLunesNavidad &lt;-<span class="st"> </span><span class="kw">subset</span>(LunesNavidad, <span class="dt">start =</span> <span class="kw">length</span>(LunesNavidad) <span class="op">-</span><span class="st"> </span><span class="dv">59</span>)</a>
<a class="sourceLine" id="cb35-12" data-line-number="12">LunesNavidad &lt;-<span class="st"> </span><span class="kw">subset</span>(LunesNavidad, <span class="dt">end =</span> <span class="kw">length</span>(LunesNavidad) <span class="op">-</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb35-13" data-line-number="13">LunesNavidad[LunesNavidad <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]</a></code></pre></div>
<pre><code>2000-12 2006-12 2017-12 
      1       1       1 </code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">LunSanto &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">-6</span>)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">MarSanto &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">-5</span>)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">MieSanto &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">-4</span>)</a>
<a class="sourceLine" id="cb37-4" data-line-number="4">JueSanto &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">-3</span>)</a>
<a class="sourceLine" id="cb37-5" data-line-number="5"></a>
<a class="sourceLine" id="cb37-6" data-line-number="6">PreSanta &lt;-<span class="st"> </span><span class="kw">c</span>(LunSanto, MarSanto, MieSanto, JueSanto)</a>
<a class="sourceLine" id="cb37-7" data-line-number="7">biz &lt;-<span class="st"> </span>fechaDiaria[<span class="kw">isBizday</span>(fechaDiaria, <span class="dt">holidays =</span> PreSanta, <span class="dt">wday =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">6</span>)]</a>
<a class="sourceLine" id="cb37-8" data-line-number="8">bizdays &lt;-<span class="st"> </span><span class="kw">format</span>(biz, <span class="dt">format =</span> <span class="st">&quot;%Y-%m&quot;</span>)</a>
<a class="sourceLine" id="cb37-9" data-line-number="9"></a>
<a class="sourceLine" id="cb37-10" data-line-number="10">DiasPreSanta &lt;-<span class="st"> </span><span class="kw">table</span>(bizdays)</a>
<a class="sourceLine" id="cb37-11" data-line-number="11">DiasPreSanta &lt;-<span class="st"> </span><span class="kw">ts</span>(DiasPreSanta, <span class="dt">start =</span> <span class="dv">1996</span>, <span class="dt">frequency =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb37-12" data-line-number="12">DiasPreSanta &lt;-<span class="st"> </span>(<span class="kw">monthdays</span>(DiasPreSanta) <span class="op">-</span><span class="st"> </span>DiasPreSanta)<span class="op">/</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb37-13" data-line-number="13">DiasPreSanta[<span class="kw">cycle</span>(DiasPreSanta) <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="op">-</span>DiasPreSanta[<span class="kw">cycle</span>(DiasPreSanta) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]  </a>
<a class="sourceLine" id="cb37-14" data-line-number="14"></a>
<a class="sourceLine" id="cb37-15" data-line-number="15">pDiasPreSanta &lt;-<span class="st"> </span><span class="kw">subset</span>(DiasPreSanta, <span class="dt">start =</span> <span class="kw">length</span>(DiasPreSanta) <span class="op">-</span><span class="st"> </span><span class="dv">59</span>)</a>
<a class="sourceLine" id="cb37-16" data-line-number="16">DiasPreSanta &lt;-<span class="st"> </span><span class="kw">subset</span>(DiasPreSanta, <span class="dt">end =</span> <span class="kw">length</span>(DiasPreSanta) <span class="op">-</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb37-17" data-line-number="17"></a>
<a class="sourceLine" id="cb37-18" data-line-number="18">LunPascua &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-19" data-line-number="19">MarPascua &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-20" data-line-number="20">MiePascua &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb37-21" data-line-number="21">JuePascua &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb37-22" data-line-number="22">ViePascua &lt;-<span class="st"> </span><span class="kw">Easter</span>(<span class="dv">1996</span><span class="op">:</span><span class="dv">2024</span>, <span class="dt">shift =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb37-23" data-line-number="23"></a>
<a class="sourceLine" id="cb37-24" data-line-number="24">Pascua &lt;-<span class="st"> </span><span class="kw">c</span>(LunPascua, MarPascua, MiePascua, JuePascua, ViePascua)</a>
<a class="sourceLine" id="cb37-25" data-line-number="25">biz &lt;-<span class="st"> </span>fechaDiaria[<span class="kw">isBizday</span>(fechaDiaria, <span class="dt">holidays =</span> Pascua, <span class="dt">wday =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">6</span>)]</a>
<a class="sourceLine" id="cb37-26" data-line-number="26">bizdays &lt;-<span class="st"> </span><span class="kw">format</span>(biz, <span class="dt">format =</span> <span class="st">&quot;%Y-%m&quot;</span>)</a>
<a class="sourceLine" id="cb37-27" data-line-number="27"></a>
<a class="sourceLine" id="cb37-28" data-line-number="28">DiasPascua &lt;-<span class="st"> </span><span class="kw">table</span>(bizdays)</a>
<a class="sourceLine" id="cb37-29" data-line-number="29">DiasPascua &lt;-<span class="st"> </span><span class="kw">ts</span>(DiasPascua, <span class="dt">start =</span> <span class="dv">1996</span>, <span class="dt">frequency =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb37-30" data-line-number="30">DiasPascua &lt;-<span class="st"> </span>(<span class="kw">monthdays</span>(DiasPascua) <span class="op">-</span><span class="st"> </span>DiasPascua)<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb37-31" data-line-number="31">DiasPascua[<span class="kw">cycle</span>(DiasPascua) <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="op">-</span>DiasPascua[<span class="kw">cycle</span>(DiasPascua) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]  </a>
<a class="sourceLine" id="cb37-32" data-line-number="32"></a>
<a class="sourceLine" id="cb37-33" data-line-number="33">pDiasPascua &lt;-<span class="st"> </span><span class="kw">subset</span>(DiasPascua, <span class="dt">start =</span> <span class="kw">length</span>(DiasPascua) <span class="op">-</span><span class="st"> </span><span class="dv">59</span>)</a>
<a class="sourceLine" id="cb37-34" data-line-number="34">DiasPascua &lt;-<span class="st"> </span><span class="kw">subset</span>(DiasPascua, <span class="dt">end =</span> <span class="kw">length</span>(DiasPascua) <span class="op">-</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb37-35" data-line-number="35"></a>
<a class="sourceLine" id="cb37-36" data-line-number="36"><span class="kw">autoplot</span>(DiasPreSanta, <span class="dt">series=</span><span class="st">&quot;Pre Semana Santa&quot;</span>,</a>
<a class="sourceLine" id="cb37-37" data-line-number="37">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb37-38" data-line-number="38">         <span class="dt">ylab =</span> <span class="st">&quot;Proporción de días en marzo&quot;</span>,</a>
<a class="sourceLine" id="cb37-39" data-line-number="39">         <span class="dt">main =</span> <span class="st">&quot;Figura 5.3. Intervención para periodos vacacionales de Semana Santa&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-40" data-line-number="40"><span class="st">  </span><span class="kw">autolayer</span>(DiasPascua, <span class="dt">series=</span><span class="st">&quot;Post Semana Santa&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-41" data-line-number="41"><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;Pre Semana Santa&quot;</span>=<span class="st">&quot;black&quot;</span>,<span class="st">&quot;Post Semana Santa&quot;</span>=<span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb37-42" data-line-number="42">                      <span class="dt">breaks=</span><span class="kw">c</span>(<span class="st">&quot;Pre Semana Santa&quot;</span>,<span class="st">&quot;Post Semana Santa&quot;</span>))</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-22-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>La figura 5.3 muestra las dos variables de intervención de Semana Santa, que para algunos años se superponen.</p>
<p>Ahora tenemos todos los elementos para pedir la identificación automática con <code>auto.arima</code>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">auto.arima</span>(Pasajeros, </a>
<a class="sourceLine" id="cb38-2" data-line-number="2">           <span class="dt">lambda =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">           <span class="dt">d =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb38-4" data-line-number="4">           <span class="dt">D =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb38-5" data-line-number="5">           <span class="dt">xreg =</span> <span class="kw">cbind</span>(DiasLaborables, DiasNoLaborables, </a>
<a class="sourceLine" id="cb38-6" data-line-number="6">                        LunesNavidad, DiasPreSanta, DiasPascua))</a></code></pre></div>
<pre><code>Series: Pasajeros 
Regression with ARIMA(0,1,1)(0,1,1)[12] errors 
Box Cox transformation: lambda= 0 

Coefficients:
          ma1     sma1  DiasLaborables  DiasNoLaborables  LunesNavidad
      -0.5778  -0.4191          0.0352            0.0159         0.028
s.e.   0.0495   0.0531          0.0057            0.0057         0.008
      DiasPreSanta  DiasPascua
           -0.0577     -0.0249
s.e.        0.0042      0.0070

sigma^2 estimated as 0.0003213:  log likelihood=718.29
AIC=-1420.59   AICc=-1420.05   BIC=-1391.65</code></pre>
<p>La identificación automática muestra el proceso de las aerolíneas. Además, parece que todas las variables de intervención con significativas.</p>
<p><br />
</p>
</div>
<div id="identificación-automática-con-seas" class="section level3 unnumbered">
<h3>Identificación automática con <code>seas</code></h3>
<p>La función <code>seas</code> de <code>seasonal</code> incluye automáticamente durante la identificación las variables de intervención necesarias.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">summary</span>(<span class="kw">seas</span>(<span class="kw">log</span>(Pasajeros)))</a></code></pre></div>
<pre><code>
Call:
seas(x = log(Pasajeros))

Coefficients:
                   Estimate Std. Error z value             Pr(&gt;|z|)    
Leap Year          0.026064   0.005646   4.616     0.00000390983093 ***
Weekday            0.005290   0.000265  19.961 &lt; 0.0000000000000002 ***
Easter[1]         -0.086920   0.003189 -27.256 &lt; 0.0000000000000002 ***
AO2005.Jul        -0.054012   0.013229  -4.083     0.00004447912245 ***
AR-Nonseasonal-01 -0.977070   0.271821  -3.595             0.000325 ***
AR-Nonseasonal-02 -0.598142   0.121493  -4.923     0.00000085119269 ***
AR-Nonseasonal-03 -0.305870   0.087245  -3.506             0.000455 ***
MA-Nonseasonal-01 -0.557423   0.281089  -1.983             0.047358 *  
MA-Seasonal-12     0.383232   0.055864   6.860     0.00000000000688 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

SEATS adj.  ARIMA: (3 1 1)(0 1 1)  Obs.: 288  Transform: none
AICc: -1375, BIC: -1339  QS (no seasonality in final):    0  
Box-Ljung (no autocorr.): 54.28 *** Shapiro (normality): 0.9897 *</code></pre>
<p>En este caso el proceso identificado en la parte regular es más complejo que el obtenido con <code>auto.arima</code>, ARIMA(3,1,1). Además, se han incluido variables de intervención asociadas a los años bisiestos, la Semana Santa y días laborables. Conjuntamente estas variables de intervención recogen los mismos efectos considerados por nosotros.</p>
<p>Concluimos que el modelo de partida para Pasajeros será <span class="math inline">\(\log(Pasajeros) \sim ARIMA_{12}(0, 1, 1)(0, 1, 1) + AI\)</span>.</p>
<p><br />
</p>
</div>
</div>
<div id="estimación-del-modelo-e-identificación-de-otras-componentes-de-intervención" class="section level2">
<h2><span class="header-section-number">5.3</span> Estimación del modelo e identificación de otras componentes de intervención</h2>
<p>Vamos a estimar el modelo identificado y a analizar la presencia de otros valores atípicos en el residuo.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">PasajerosAri &lt;-<span class="st"> </span><span class="kw">Arima</span>(Pasajeros, </a>
<a class="sourceLine" id="cb42-2" data-line-number="2">                      <span class="dt">lambda =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">                      <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>),  </a>
<a class="sourceLine" id="cb42-4" data-line-number="4">                      <span class="dt">seasonal =</span> <span class="kw">list</span>(<span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">period =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">                      <span class="dt">xreg =</span> <span class="kw">cbind</span>(DiasLaborables, DiasNoLaborables, </a>
<a class="sourceLine" id="cb42-6" data-line-number="6">                                   LunesNavidad, DiasPreSanta, DiasPascua))</a>
<a class="sourceLine" id="cb42-7" data-line-number="7">PasajerosAri</a></code></pre></div>
<pre><code>Series: Pasajeros 
Regression with ARIMA(0,1,1)(0,1,1)[12] errors 
Box Cox transformation: lambda= 0 

Coefficients:
          ma1     sma1  DiasLaborables  DiasNoLaborables  LunesNavidad
      -0.5778  -0.4191          0.0352            0.0159         0.028
s.e.   0.0495   0.0531          0.0057            0.0057         0.008
      DiasPreSanta  DiasPascua
           -0.0577     -0.0249
s.e.        0.0042      0.0070

sigma^2 estimated as 0.0003213:  log likelihood=718.29
AIC=-1420.59   AICc=-1420.05   BIC=-1391.65</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">error &lt;-<span class="st"> </span><span class="kw">residuals</span>(PasajerosAri)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2">sderror &lt;-<span class="st"> </span><span class="kw">sd</span>(error)</a>
<a class="sourceLine" id="cb44-3" data-line-number="3"></a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="kw">autoplot</span>(error, <span class="dt">series=</span><span class="st">&quot;Error&quot;</span>,</a>
<a class="sourceLine" id="cb44-5" data-line-number="5">         <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb44-6" data-line-number="6">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb44-7" data-line-number="7">         <span class="dt">ylab =</span> <span class="st">&quot;Error&quot;</span>,</a>
<a class="sourceLine" id="cb44-8" data-line-number="8">         <span class="dt">main =</span> <span class="st">&quot;Figura 5.4. Error + Intervención. Modelo ARIMA&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">-2</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="op">*</span>sderror, </a>
<a class="sourceLine" id="cb44-10" data-line-number="10">             <span class="dt">colour =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), </a>
<a class="sourceLine" id="cb44-11" data-line-number="11">             <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb44-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span> <span class="kw">seq</span>(<span class="dv">1996</span>, <span class="dv">2019</span>, <span class="dv">2</span>))</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-25-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Identificamos tres meses en los que el error supera o casi alcanza las tres desviaciones típicas y son candidatos a valores atípicos: abril de 2002, agosto de 2005 y marzo de 2010. No es fácil conocer las causas para estos valores atípicos.</p>
<p>Tras incluir las correspondientes variables artificiales en el modelo y estimarlo, identificamos otro valor extremo en agosto de 2006 y precedimos a incluirlo en el modelo y repetir el análisis. En esta ocasión ya no identificamos más valores atípicos.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">d0402 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span>(<span class="kw">trunc</span>(<span class="kw">time</span>(Pasajeros)) <span class="op">==</span><span class="st"> </span><span class="dv">2002</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">cycle</span>(Pasajeros) <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb45-2" data-line-number="2">d0805 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span>(<span class="kw">trunc</span>(<span class="kw">time</span>(Pasajeros)) <span class="op">==</span><span class="st"> </span><span class="dv">2005</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">cycle</span>(Pasajeros) <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">d0806 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span>(<span class="kw">trunc</span>(<span class="kw">time</span>(Pasajeros)) <span class="op">==</span><span class="st"> </span><span class="dv">2006</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">cycle</span>(Pasajeros) <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb45-4" data-line-number="4">d0310 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span>(<span class="kw">trunc</span>(<span class="kw">time</span>(Pasajeros)) <span class="op">==</span><span class="st"> </span><span class="dv">2010</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">cycle</span>(Pasajeros) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb45-5" data-line-number="5"></a>
<a class="sourceLine" id="cb45-6" data-line-number="6">PasajerosAri &lt;-<span class="st"> </span><span class="kw">Arima</span>(Pasajeros,</a>
<a class="sourceLine" id="cb45-7" data-line-number="7">                      <span class="dt">lambda =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb45-8" data-line-number="8">                      <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>),  </a>
<a class="sourceLine" id="cb45-9" data-line-number="9">                      <span class="dt">seasonal =</span> <span class="kw">list</span>(<span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">period =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb45-10" data-line-number="10">                      <span class="dt">xreg =</span> <span class="kw">cbind</span>(DiasLaborables, DiasNoLaborables, </a>
<a class="sourceLine" id="cb45-11" data-line-number="11">                                   LunesNavidad, DiasPreSanta, DiasPascua,</a>
<a class="sourceLine" id="cb45-12" data-line-number="12">                                   d0402, d0805, d0806, d0310))</a>
<a class="sourceLine" id="cb45-13" data-line-number="13">PasajerosAri</a></code></pre></div>
<pre><code>Series: Pasajeros 
Regression with ARIMA(0,1,1)(0,1,1)[12] errors 
Box Cox transformation: lambda= 0 

Coefficients:
          ma1     sma1  DiasLaborables  DiasNoLaborables  LunesNavidad
      -0.5279  -0.3747          0.0343            0.0158        0.0260
s.e.   0.0538   0.0592          0.0051            0.0052        0.0072
      DiasPreSanta  DiasPascua   d0402   d0805   d0806   d0310
           -0.0579     -0.0253  0.0333  0.0644  0.0283  0.0377
s.e.        0.0042      0.0067  0.0130  0.0126  0.0126  0.0126

sigma^2 estimated as 0.0002841:  log likelihood=737.64
AIC=-1451.29   AICc=-1450.09   BIC=-1407.88</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">error &lt;-<span class="st"> </span><span class="kw">residuals</span>(PasajerosAri)</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">sderror &lt;-<span class="st"> </span><span class="kw">sd</span>(error)</a>
<a class="sourceLine" id="cb47-3" data-line-number="3"></a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="kw">autoplot</span>(error, <span class="dt">series=</span><span class="st">&quot;Error&quot;</span>,</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">         <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb47-6" data-line-number="6">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb47-7" data-line-number="7">         <span class="dt">ylab =</span> <span class="st">&quot;Error&quot;</span>,</a>
<a class="sourceLine" id="cb47-8" data-line-number="8">         <span class="dt">main =</span> <span class="st">&quot;Figura 5.5. Error + Intervención. Modelo ARIMA&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">-2</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="op">*</span>sderror, </a>
<a class="sourceLine" id="cb47-10" data-line-number="10">             <span class="dt">colour =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), </a>
<a class="sourceLine" id="cb47-11" data-line-number="11">             <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span> <span class="kw">seq</span>(<span class="dv">1996</span>, <span class="dv">2019</span>, <span class="dv">2</span>))</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-26-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Antes de finalizar el proceso de identificación vamos a confirmar la significatividad de todos los parámetros estimados haciendo uso del estadístico de Wald.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">datos &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">coef</span>(PasajerosAri))) {</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">  datos &lt;-<span class="st"> </span><span class="kw">rbind</span>(datos,</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">                 <span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">                   <span class="st">&quot;Coeficiente&quot;</span> =<span class="st"> </span><span class="kw">names</span>(<span class="kw">coef</span>(PasajerosAri))[i],</a>
<a class="sourceLine" id="cb48-6" data-line-number="6">                   <span class="st">&quot;Valor de p&quot;</span> =<span class="st"> </span><span class="kw">wald.test</span>(<span class="dt">b =</span> <span class="kw">coef</span>(PasajerosAri), </a>
<a class="sourceLine" id="cb48-7" data-line-number="7">                                            <span class="dt">Sigma =</span> <span class="kw">vcov</span>(PasajerosAri), </a>
<a class="sourceLine" id="cb48-8" data-line-number="8">                                            <span class="dt">Terms =</span> i)<span class="op">$</span>result<span class="op">$</span>chi2[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb48-9" data-line-number="9">                 )</a>
<a class="sourceLine" id="cb48-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb48-11" data-line-number="11"><span class="kw">kable</span>(datos, <span class="dt">digits =</span> <span class="dv">4</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">caption =</span> <span class="st">&quot;Contrastes de significatividad&quot;</span>)</a></code></pre></div>
<table>
<caption>Contrastes de significatividad</caption>
<thead>
<tr class="header">
<th align="left">Coeficiente</th>
<th align="right">Valor.de.p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ma1</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">sma1</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">DiasLaborables</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">DiasNoLaborables</td>
<td align="right">0.0023</td>
</tr>
<tr class="odd">
<td align="left">LunesNavidad</td>
<td align="right">0.0003</td>
</tr>
<tr class="even">
<td align="left">DiasPreSanta</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">DiasPascua</td>
<td align="right">0.0001</td>
</tr>
<tr class="even">
<td align="left">d0402</td>
<td align="right">0.0105</td>
</tr>
<tr class="odd">
<td align="left">d0805</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">d0806</td>
<td align="right">0.0247</td>
</tr>
<tr class="odd">
<td align="left">d0310</td>
<td align="right">0.0028</td>
</tr>
</tbody>
</table>
<p><br />
</p>
</div>
<div id="validación-del-modelo" class="section level2">
<h2><span class="header-section-number">5.4</span> Validación del modelo</h2>
<p>En el proceso de validación analizaremos la calidad de ajuste y predicción del modelo estimado.</p>
<p><br />
</p>
<div id="calidad-del-ajuste" class="section level3 unnumbered">
<h3>Calidad del ajuste</h3>
<p>Analizando los criterios de bondad de ajuste (sobre el error de predicción intra-muestral a un periodo vista) se tiene un error medio (ME) de -0.04 que es prácticamente cero por lo que no parece que haya sesgo en las predicciones; en media nos equivocamos 3.7 millones de pasajeros (RMSE) y el error porcentual medio (MAPE) es 1.3%, muy bajo. Para ambos indicadores de bondad de ajuste el error obtenido es la mitad que el visto con alisado.</p>
<pre><code>                ME RMSE  MAE  MPE MAPE MASE ACF1
Training set -0.04 3.72 2.92 0.01 1.26 0.35 0.02</code></pre>
<p><br />
</p>
</div>
<div id="calidad-de-las-predicciones" class="section level3 unnumbered">
<h3>Calidad de las predicciones</h3>
<p>Se completará el proceso de validación estimado el error de predicción extra muestral según el horizonte temporal. Se considerarán 10 años para el periodo de estimación y un año para el de predicción.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">k &lt;-<span class="st"> </span><span class="dv">120</span>                  </a>
<a class="sourceLine" id="cb50-2" data-line-number="2">h &lt;-<span class="st"> </span><span class="dv">12</span>                   </a>
<a class="sourceLine" id="cb50-3" data-line-number="3">T &lt;-<span class="st"> </span><span class="kw">length</span>(Pasajeros)    </a>
<a class="sourceLine" id="cb50-4" data-line-number="4">s&lt;-T <span class="op">-</span><span class="st"> </span>k <span class="op">-</span><span class="st"> </span>h            </a>
<a class="sourceLine" id="cb50-5" data-line-number="5"></a>
<a class="sourceLine" id="cb50-6" data-line-number="6">mapeArima &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, s <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, h)</a>
<a class="sourceLine" id="cb50-7" data-line-number="7"></a>
<a class="sourceLine" id="cb50-8" data-line-number="8">X &lt;-<span class="st"> </span><span class="kw">cbind</span>(DiasLaborables, DiasNoLaborables, </a>
<a class="sourceLine" id="cb50-9" data-line-number="9">           LunesNavidad, DiasPreSanta, DiasPascua,</a>
<a class="sourceLine" id="cb50-10" data-line-number="10">           d0402, d0805, d0806, d0310)</a>
<a class="sourceLine" id="cb50-11" data-line-number="11"></a>
<a class="sourceLine" id="cb50-12" data-line-number="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>s) {</a>
<a class="sourceLine" id="cb50-13" data-line-number="13">  train.set &lt;-<span class="st"> </span><span class="kw">subset</span>(Pasajeros, <span class="dt">start =</span> i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">end =</span> i <span class="op">+</span><span class="st"> </span>k)</a>
<a class="sourceLine" id="cb50-14" data-line-number="14">  test.set &lt;-<span class="st">  </span><span class="kw">subset</span>(Pasajeros, <span class="dt">start =</span> i <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">end =</span> i <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span>h) </a>
<a class="sourceLine" id="cb50-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb50-16" data-line-number="16">  X.train &lt;-<span class="st"> </span>X[(i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span>k),]</a>
<a class="sourceLine" id="cb50-17" data-line-number="17">  hay &lt;-<span class="st"> </span><span class="kw">colSums</span>(X.train)</a>
<a class="sourceLine" id="cb50-18" data-line-number="18">  X.train &lt;-<span class="st"> </span>X.train[, hay<span class="op">&gt;</span><span class="dv">0</span>]</a>
<a class="sourceLine" id="cb50-19" data-line-number="19">  </a>
<a class="sourceLine" id="cb50-20" data-line-number="20">  X.test &lt;-<span class="st"> </span>X[(i <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span>h),]</a>
<a class="sourceLine" id="cb50-21" data-line-number="21">  X.test &lt;-<span class="st"> </span>X.test[, hay<span class="op">&gt;</span><span class="dv">0</span>]</a>
<a class="sourceLine" id="cb50-22" data-line-number="22">  </a>
<a class="sourceLine" id="cb50-23" data-line-number="23">  <span class="cf">if</span> (<span class="kw">length</span>(X.train) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb50-24" data-line-number="24">    fit &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">Arima</span>(train.set, </a>
<a class="sourceLine" id="cb50-25" data-line-number="25">                     <span class="dt">lambda =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb50-26" data-line-number="26">                     <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb50-27" data-line-number="27">                     <span class="dt">seasonal =</span> <span class="kw">list</span>(<span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">period =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb50-28" data-line-number="28">                     <span class="dt">xreg=</span>X.train), <span class="dt">silent =</span> <span class="ot">TRUE</span>)} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb50-29" data-line-number="29">                       fit &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">Arima</span>(train.set,</a>
<a class="sourceLine" id="cb50-30" data-line-number="30">                                        <span class="dt">lambda =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb50-31" data-line-number="31">                                        <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb50-32" data-line-number="32">                                        <span class="dt">seasonal =</span> <span class="kw">list</span>(<span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb50-33" data-line-number="33">                                                        <span class="dt">period =</span> <span class="dv">12</span>)), </a>
<a class="sourceLine" id="cb50-34" data-line-number="34">                                  <span class="dt">silent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb50-35" data-line-number="35">                     }</a>
<a class="sourceLine" id="cb50-36" data-line-number="36">  </a>
<a class="sourceLine" id="cb50-37" data-line-number="37">  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.element</span>(<span class="st">&quot;try-error&quot;</span>, <span class="kw">class</span>(fit))) {</a>
<a class="sourceLine" id="cb50-38" data-line-number="38">    <span class="cf">if</span> (<span class="kw">length</span>(X.train) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) fcast &lt;-<span class="st"> </span><span class="kw">forecast</span>(fit, <span class="dt">h =</span> h, <span class="dt">xreg =</span> X.test) <span class="cf">else</span></a>
<a class="sourceLine" id="cb50-39" data-line-number="39">      fcast &lt;-<span class="st"> </span><span class="kw">forecast</span>(fit, <span class="dt">h =</span> h)</a>
<a class="sourceLine" id="cb50-40" data-line-number="40">    mapeArima[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="dv">100</span><span class="op">*</span><span class="kw">abs</span>(test.set <span class="op">-</span><span class="st"> </span>fcast<span class="op">$</span>mean)<span class="op">/</span>test.set</a>
<a class="sourceLine" id="cb50-41" data-line-number="41">  }</a>
<a class="sourceLine" id="cb50-42" data-line-number="42">}</a>
<a class="sourceLine" id="cb50-43" data-line-number="43"></a>
<a class="sourceLine" id="cb50-44" data-line-number="44">errorArima &lt;-<span class="st"> </span><span class="kw">colMeans</span>(mapeArima, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb50-45" data-line-number="45"><span class="kw">round</span>(errorArima, <span class="dv">2</span>)</a></code></pre></div>
<pre><code> [1] 1.81 1.99 2.09 2.26 2.31 2.41 2.54 2.68 2.78 2.99 3.09 3.21</code></pre>
<p>El error es creciente en el horizonte temporal de predicción. Para predicciones extra-muestrales a un periodo vista vale 1.8%, algo superior al error de estimación, pero realmente bajo. Incluso para predicciones a doce meses vista, el error sigue siendo reducido, 3.2%. Recordemos que para alisado era de 3.6% (Tabla 2).</p>
<p><br />
</p>
</div>
</div>
<div id="interpretación-del-modelo-estimado" class="section level2">
<h2><span class="header-section-number">5.5</span> Interpretación del modelo estimado</h2>
<p>El modelo estimado y validado corresponde al modelo de las aerolíneas con intervención: <span class="math inline">\(ARIMA_{12}(0,1,1)(0,1,1) + AI\)</span>. La ecuación teórica completa del modelo es: <span class="math display">\[(1-L)(1-L^{12})\log(Pasajeros) = (1+\theta_1 L)(1 + \theta_{12} L^{12})\varepsilon_t+\]</span> <span class="math display">\[\gamma_1 DiasLaborables +\gamma_2 DiasNoLaborables +\gamma_3 LunesNavidad+\]</span> <span class="math display">\[\gamma_4 DiasPreSanta + \gamma_5 DiasPascua +\]</span> <span class="math display">\[\gamma_6 d0402 +\gamma_7 d0805 +\gamma_8 d0806 +\gamma_9 d0310.\]</span></p>
<p>Si se desarrolla el modelo y se deja en función de la tasa de variación anual del número de pasajero, queda (la parte de intervención no cambia):</p>
<p><span class="math display">\[TVAPasajeros_t = TVAPasajeros_{t-1} + \theta_1 \varepsilon_{t-1} + \theta_{12} \varepsilon_{t-12}+ \theta_1 \theta_{12} \varepsilon_{t-13}+\varepsilon_t + AI.\]</span> Finalmente, el modelo estimado es: <span class="math display">\[\widehat{TVAPasajeros}_t = TVAPasajeros_{t-1} -0.53 \varepsilon_{t-1} -0.37 \varepsilon_{t-12}+ 0.20 \varepsilon_{t-13} +\]</span> <span class="math display">\[0.034\cdot DiasLaborables +0.016\cdot DiasNoLaborables+ 0.026\cdot LunesNavidad\]</span> <span class="math display">\[- 0.058\cdot DiasPreSanta - 0.025\cdot DiasPascua +\]</span> <span class="math display">\[0.033\cdot d0402 +0.064\cdot d0805 +0.028\cdot d0806 +0.038\cdot d0310.\]</span> Interpretación:</p>
<ul>
<li>La tasa de variación anual del número de pasajeros en transporte urbano para un mes dado es la misma que la observada en el mes previo.</li>
<li>Si hace uno, doce o trece meses se observó un número atípico de pasajeros, se debe tener en cuenta para corregir la predicción.</li>
<li>Cada día adicional laborable en un mes supone un incremento en el número de pasajeros del 3.4% y cada día adicional no laborable del 1.6%.</li>
<li>Si la Navidad cae en lunes y por tanto Nochebuena en domingo, ese mes de diciembre el número de pasajeros será un 2.6% superior a la de un mes de diciembre donde la Navidad no cae en lunes.</li>
<li>Si los días laborables (lunes a jueves) de la Semana Santa caen en marzo, ese marzo el número de pasajeros cae un 5.8%, mientras que en abril se producirá un incremento del número de pasajeros en transporte urbano de la misma proporción.</li>
<li>De la misma forma, si los días laborables (lunes a viernes) de la semana posterior a Domingo de Resurrección caen en marzo, ese marzo el número de pasajeros cae un 2.5%, mientras que en abril se producirá un incremento del número de pasajeros en transporte urbano de la misma proporción.</li>
<li>Ademas, para cuatro meses se observó una tasa de variación anual atípicamente superior a la esperada.</li>
</ul>
<p><br />
</p>
</div>
<div id="predicción-del-número-de-pasajeros-en-transporte-urbano" class="section level2">
<h2><span class="header-section-number">5.6</span> Predicción del número de pasajeros en transporte urbano</h2>
<p>Una vez dado por válido el modelo, podemos pasar a realizar predicciones para los próximos años. Para las variables de intervención sujetas a fecha de calendario ya hemos ido creando sus valores previstos, para las demás los fijaremos a cero.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">pPasajerosAri &lt;-<span class="st"> </span><span class="kw">forecast</span>(PasajerosAri, </a>
<a class="sourceLine" id="cb52-2" data-line-number="2">                          <span class="dt">h =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">                          <span class="dt">xreg =</span> <span class="kw">cbind</span>(pDiasLaborables, pDiasNoLaborables, </a>
<a class="sourceLine" id="cb52-4" data-line-number="4">                                       pLunesNavidad, pDiasPreSanta, pDiasPascua,</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">                                       <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">60</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">60</span>), </a>
<a class="sourceLine" id="cb52-6" data-line-number="6">                                       <span class="kw">rep</span>(<span class="dv">0</span> ,<span class="dv">60</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">60</span>)), </a>
<a class="sourceLine" id="cb52-7" data-line-number="7">                          <span class="dt">level =</span> <span class="dv">95</span>)</a>
<a class="sourceLine" id="cb52-8" data-line-number="8"><span class="kw">autoplot</span>(pPasajerosAri, </a>
<a class="sourceLine" id="cb52-9" data-line-number="9">         <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb52-10" data-line-number="10">         <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb52-11" data-line-number="11">         <span class="dt">main =</span> <span class="st">&quot;Figura 5.6. Pasajeros (1996-2019) y predicción (2020-2024). Modelo Arima.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb52-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span> <span class="kw">seq</span>(<span class="dv">1996</span>, <span class="dv">2024</span>, <span class="dv">4</span>))</a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-30-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Así, en 2020 se esperan 3188 millones de pasajeros y para 2021 un total de 3258 millones de pasajeros.</p>
<p><br />
<br />
<br />
</p>
</div>
</div>
<div id="comparación-entre-modelos" class="section level1">
<h1><span class="header-section-number">6</span> Comparación entre modelos</h1>
<p>Para finalizar este análisis, vamos a comparar la calidad de ajuste y de predicción de los tres modelos estimados en este ejemplo: el método ingenuo con estacionalidad, el método de Alisado exponencial y el modelo Arima.</p>
<p>Recordemos que el método ingenuo con estacionalidad tenía un error de ajuste del 3.5% o 11 millones de pasajeros (RMSE). Mientras que para el mejor modelo de alisado obtenido (ETS(M,Ad,A)) se tiene un error absoluto porcentual del 2.5% equivalente a 7.5 millones de pasajeros. Por último, el modelo ARIMA presenta un error de 1.3% o 3.7 millones de pasajeros.</p>
<p>Claramente, el modelo de alisado supone una mejora sustancial sobre el método ingenuo y el modelo ARIMA sobre el de alisado con una reducción, en este último caso, del 50% en los dos indicadores de calidad contemplados.</p>
<p>Respecto de la calidad de las predicciones extra-muestrales, la figura 6.1 muestra los valores para el modelo de Alisado y ARIMA.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">datos &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb53-2" data-line-number="2">  <span class="dt">factor =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Alisado&quot;</span>, <span class="dv">12</span>), </a>
<a class="sourceLine" id="cb53-3" data-line-number="3">             <span class="kw">rep</span>(<span class="st">&quot;Arima&quot;</span>, <span class="dv">12</span>)),</a>
<a class="sourceLine" id="cb53-4" data-line-number="4">  <span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>),</a>
<a class="sourceLine" id="cb53-5" data-line-number="5">  <span class="dt">y =</span> <span class="kw">c</span>(errorAlisadoPas, errorArima)</a>
<a class="sourceLine" id="cb53-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb53-7" data-line-number="7"></a>
<a class="sourceLine" id="cb53-8" data-line-number="8"><span class="kw">ggplot</span>(datos, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y,  <span class="dt">colour=</span> factor)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb53-10" data-line-number="10"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figura 6.1. Error de predicción (MAPE) según horizonte temporal y enfoque&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb53-11" data-line-number="11"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Horizonte temporal de predicción&quot;) +</span></a>
<a class="sourceLine" id="cb53-12" data-line-number="12"><span class="st">  ylab(&quot;</span>%<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb53-13" data-line-number="13"><span class="st">  scale_x_continuous(breaks= 1:12) +</span></a>
<a class="sourceLine" id="cb53-14" data-line-number="14"><span class="st">  scale_y_continuous(breaks= seq(1.5, 4, .5)) +</span></a>
<a class="sourceLine" id="cb53-15" data-line-number="15"><span class="st">  guides(colour = guide_legend(title = &quot;</span>Métodos<span class="st">&quot;)) + </span></a>
<a class="sourceLine" id="cb53-16" data-line-number="16"><span class="st">  theme(legend.position=c(0.02,0.98), legend.justification=c(0,1))</span></a></code></pre></div>
<p><img src="03-14-Ejemplo-Pasajeros_files/figure-html/unnamed-chunk-31-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Con independencia del horizonte temporal, el error de previsión extra-muestral del modelo ARIMA es menor que el error del modelo de alisado, aunque la diferencia se reduce conforme aumenta el horizonte temporal de previsión. En concreto, para previsiones a un mes vista, ARIMA comete un error 0.8 puntos porcentuales menor que el alisado, mientras que para predicciones a seis meses vista la diferencia es solo de medio punto y para un horizonte de doce meses de 0.4 puntos.</p>
<p>El método ARIMA nos permite obtener la predicciones más precisas y además entender un poco mejor cuales son los determinantes del número de pasajeros en transporte urbano y su efecto sobre la serie. El método de Alisado exponencial permite obtener predicciones bastante buenas con una simple línea de código. La conveniencia de uno o otro método dependerá de la importancia que se dé a la calidad de las predicciones, la comprensión de los determinantes de la serie o la complejidad de la metodología, entre otros aspectos.</p>
<p><br />
<br />
</p>
</div>
<div id="lista-de-funciones-utilizadas" class="section level1">
<h1><span class="header-section-number">7</span> Lista de funciones utilizadas</h1>
<table>
<thead>
<tr class="header">
<th align="left">Paquete</th>
<th align="left">Funciones</th>
<th align="left">Paquete</th>
<th align="left">Funciones</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">aod</td>
<td align="left">wald.test</td>
<td align="left">forecast</td>
<td align="left">ggsubseriesplot</td>
</tr>
<tr class="even">
<td align="left">base</td>
<td align="left">abs</td>
<td align="left"></td>
<td align="left">monthdays</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">as.Date</td>
<td align="left"></td>
<td align="left">ndiffs</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">as.numeric</td>
<td align="left"></td>
<td align="left">nsdiffs</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">as.POSIXlt</td>
<td align="left"></td>
<td align="left">remainder</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">c</td>
<td align="left"></td>
<td align="left">snaive</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">cbind</td>
<td align="left">ggplot2</td>
<td align="left">aes</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">class</td>
<td align="left"></td>
<td align="left">geom_hline</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">colMeans</td>
<td align="left"></td>
<td align="left">geom_line</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">colnames</td>
<td align="left"></td>
<td align="left">geom_point</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">colSums</td>
<td align="left"></td>
<td align="left">ggplot</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">data.frame</td>
<td align="left"></td>
<td align="left">ggtitle</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">diff</td>
<td align="left"></td>
<td align="left">guide_legend</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">expression</td>
<td align="left"></td>
<td align="left">guides</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">is.element</td>
<td align="left"></td>
<td align="left">scale_colour_manual</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">length</td>
<td align="left"></td>
<td align="left">scale_x_continuous</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">library</td>
<td align="left"></td>
<td align="left">scale_y_continuous</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">list</td>
<td align="left"></td>
<td align="left">theme</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">log</td>
<td align="left"></td>
<td align="left">theme_bw</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">matrix</td>
<td align="left"></td>
<td align="left">theme_set</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">mean</td>
<td align="left"></td>
<td align="left">xlab</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">names</td>
<td align="left"></td>
<td align="left">ylab</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">nrow</td>
<td align="left">gridExtra</td>
<td align="left">grid.arrange</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">rbind</td>
<td align="left">knitr</td>
<td align="left">kable</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">rep</td>
<td align="left">seasonal</td>
<td align="left">seas</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">round</td>
<td align="left">stats</td>
<td align="left">aggregate</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">rownames</td>
<td align="left"></td>
<td align="left">coef</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">seq</td>
<td align="left"></td>
<td align="left">cycle</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">subset</td>
<td align="left"></td>
<td align="left">residuals</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">summary</td>
<td align="left"></td>
<td align="left">sd</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">table</td>
<td align="left"></td>
<td align="left">stl</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">tapply</td>
<td align="left"></td>
<td align="left">time</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">trunc</td>
<td align="left"></td>
<td align="left">ts</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">try</td>
<td align="left"></td>
<td align="left">vcov</td>
</tr>
<tr class="odd">
<td align="left">forecast</td>
<td align="left">accuracy</td>
<td align="left">timeDate</td>
<td align="left">dayOfWeek</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Arima</td>
<td align="left"></td>
<td align="left">Easter</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">auto.arima</td>
<td align="left"></td>
<td align="left">format</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">autoplot</td>
<td align="left"></td>
<td align="left">isBizday</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">autolayer</td>
<td align="left"></td>
<td align="left">timeCalendar</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">easter</td>
<td align="left"></td>
<td align="left">timeSequence</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">ets</td>
<td align="left">utils</td>
<td align="left">read.csv2</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">forecast</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">ggAcf</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><br />
<br />
<br />
<br />
</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQW7DoWxpc2lzIGRlIGxhIHNlcmllIFBhc2FqZXJvcyBlbiB0cmFuc3BvcnRlIHVyYmFubyIKc3VidGl0bGU6ICJQcmVkaWNjacOzbiBjb24gZGF0b3MgdGVtcG9yYWxlcyAoQklBKSIKYXV0aG9yOiAiSXbDoW4gQXJyaWJhcyAoRGVwdG8uIEFuw6FsaXNpcyBFY29uw7NtaWNvLiBVbml2ZXJzaXRhdCBkZSBWYWzDqG5jaWEpIgpvdXRwdXQ6IAogIGh0bWxfZG9jdW1lbnQ6CiAgICB0aGVtZTogY2VydWxlYW4KICAgIGhpZ2hsaWdodDogcHlnbWVudHMgCiAgICBmaWdfY2FwdGlvbjogZmFsc2UKICAgIGRmX3ByaW50OiBrYWJsZQogICAgdG9jOiB0cnVlCiAgICB0b2NfZGVwdGg6IDIKICAgIHRvY19mbG9hdDogCiAgICAgIGNvbGxhcHNlZDogdHJ1ZQogICAgbnVtYmVyX3NlY3Rpb25zOiB0cnVlCiAgICBzZWxmX2NvbnRhaW5lZDogdHJ1ZQogICAgY29kZV9kb3dubG9hZDogdHJ1ZQotLS0KCmBgYHtyIGNodW5rX3NldHVwLCBlY2hvID0gRkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldCh3YXJuaW5nID0gRkFMU0UsIAogICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IEZBTFNFLCAKICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQgPSAiIiwKICAgICAgICAgICAgICAgICAgICAgIGZpZy5hbGlnbiA9ICJjZW50ZXIiLCAKICAgICAgICAgICAgICAgICAgICAgIGZpZy5zaG93ID0gImhvbGQiLAogICAgICAgICAgICAgICAgICAgICAgZmlnLmhlaWdodCA9IDQsCiAgICAgICAgICAgICAgICAgICAgICBmaWcud2lkdGggPSA4LAogICAgICAgICAgICAgICAgICAgICAgb3V0LndpZHRoID0gIjgwJSIpIApgYGAKCmBgYHtyIG9wdGlvbnNfc2V0dXAsIGVjaG8gPSBGQUxTRX0Kb3B0aW9ucyhzY2lwZW4gPSA5OTkpICMtIHBhcmEgcXVpdGFyIGxhIG5vdGFjaW9uIGNpZW50aWZpY2EKYGBgCgoKRW4gZXN0ZSBjdXJzbyBoZW1vcyBhcHJlbmRpZG8gYSBkZXNjcmliaXIgdW5hIHNlcmllIHRlbXBvcmFsLCBlc3RpbWFyIHN1IHByb2Nlc28gZ2VuZXJhZG9yIGRlIGRhdG9zIHkgcmVhbGl6YXIgcHJlZGljY2lvbmVzLCB0YW50byBwdW50dWFsZXMgY29tbyBwb3IgaW50ZXJ2YWxvLiBQYXJhIGVsbG8sIGhlbW9zIGVzdHVkaWFkbyBsb3MgcHJpbmNpcGFsZXMgYXNwZWN0b3MgdGXDs3JpY29zIHJlbGFjaW9uYWRvcyBjb24gbGFzIHNlcmllcyB0ZW1wb3JhbGVzLCBzdXMgY29tcG9uZW50ZXMsIGNyaXRlcmlvcyBkZSBib25kYWQgZGUgYWp1c3RlIHkgcHJlZGljY2nDs24sIG1vZGVsb3MgZGUgYWp1c3RlLCBldGMuIFRhbWJpw6luIGhlbW9zIHByYWN0aWNhZG8gbGEgYXBsaWNhY2nDs24gZGUgZXN0b3MgY29uY2VwdG9zIGEgdHJhdsOpcyBkZSBkaWZlcmVudGVzIHNlcmllcyB0ZW1wb3JhbGVzOiBUw610dWxvcyBwdWJsaWNhZG9zLCBOYWNpbWllbnRvcywgQWZvcm8gZGUgdmVow61jdWxvcywgQ29uc3VtbyBkZSBhbGltZW50b3MgcGVyIGPDoXBpdGEsIFByb2R1Y2Npw7NuIGRlIGNob2NvbGF0ZSwgUGVybm9jdGFjaW9uZXMgZGUgdHVyaXN0YXMgZXh0cmFuamVyb3MsIGVudHJlIG90cmFzLgoKRWwgcHJvZ3JhbWEgZGUgZXN0YWTDrXN0aWNhIHV0aWxpemFkbywgYFJgLCBoYSBzZXJ2aWRvIGNvbiBkb3MgcHJvcMOzc2l0b3MgZW50cmVtZXpjbGFkb3MgZHVyYW50ZSBlbCBjdXJzby4gRW4gcHJpbWVyIGx1Z2FyLCBwYXJhIGlsdXN0cmFyIGxvcyBhc3BlY3RvcyB0ZcOzcmljb3MgcXVlIHNlIGliYW4gaW50cm9kdWNpZW5kby4gRW4gZXN0ZSBjYXNvLCBgUmAgdGVuw61hIHVuIHVzbyBtw6FzIGluc3RydW1lbnRhbCB5IGVuIGdlbmVyYWwgc2UgbW9zdHJhYmEgbGEgc2FsaWRhIG9idGVuaWRhIHNpbiBlbnNlw7FhciBlbCBjw7NkaWdvLiBTaW4gZW1iYXJnbywgZWwgcHJvcMOzc2l0byBwcmluY2lwYWwgaGEgc2lkbyBhcHJlbmRlciBjb21vIHVzYXIgYFJgIGNvbiBlbCBvYmpldGl2byBkZSBhbmFsaXphciB5IHByZWRlY2lyIHVuYSBzZXJpZSB0ZW1wb3JhbC4gRWwgZWplbXBsbyB0cmFuc3ZlcnNhbCB1dGlsaXphZG8gZHVyYW50ZSBlbCBjdXJzbyBkZSBfUGVybm9jdGFjaW9uZXMgZW4gYWxvamFtaWVudG9zIHR1csOtc3RpY29zIGRlIHR1cmlzdGFzIGV4dHJhbmplcm9zXyBlcyBlbCBwcmluY2lwYWwgZXhwb25lbnRlIGRlIGVzdGUgdXNvIGRlIGBSYC4gCgpBaG9yYSBiaWVuLCBhbWJvcyB1c29zIGRlIGBSYCwgaWx1c3RyYXIgYXNwZWN0b3MgdGXDs3JpY29zIHkgYW5hbGl6YXIgdW5hIHNlcmllLCBoYW4gcXVlZGFkbyBkaXN0cmlidWlkb3MgYSBsbyBsYXJnbyBkZSBsb3MgdGVtYXMgdmlzdG9zLiBFbCBlamVtcGxvIF9fUGFzYWplcm9zIGVuIHRyYW5zcG9ydGUgdXJiYW5vX18sIGRlc2Fycm9sbGFkbyBhcXXDrSwgdGllbmUgY29tbyBvYmpldGl2byBkaXNwb25lciBlbiB1biDDum5pY28gZG9jdW1lbnRvIHkgZGUgZm9ybWEgb3JnYW5pemFkYSBkZWwgYW7DoWxpc2lzIGNvbXBsZXRvIGRlIHVuYSBzZXJpZSB0ZW1wb3JhbC4gRW4gZXN0ZSBpbmZvcm1lIHNlIG1vc3RyYXLDoSBzaWVtcHJlIGVsIGPDs2RpZ28gY29tcGxldG8gZW1wbGVhZG8gcGFyYSBsYXMgc2FsaWRhcywgc2UgaGFyw6EgaGluY2FwacOpIGVuIGxhIGFwbGljYWNpw7NuIHByw6FjdGljYSBkZSBsb3MgY29uY2VwdG9zIHRlw7NyaWNvcywgc2UgaW5zaXN0aXLDoSBlbiBsb3MgZGlmZXJlbnRlcyBlbmZvcXVlcyBxdWUgc2UgcHVlZGVuIHkgZGViZW4gZW1wbGVhciBwYXJhIGFuYWxpemFyIHVuYSBzZXJpZSB0ZW1wb3JhbCB5IHNlIGp1c3RpZmljYXLDoW4gdG9kYXMgbGFzIGRlY2lzaW9uZXMgYWRvcHRhZGFzLgoKRXN0ZSBlcywgcG9yIHRhbnRvLCB1biBlamVtcGxvIHF1ZSBzZSBleHRpZW5kZSBtw6FzIGFsbMOhIGRlIGxvIHF1ZSB1biBpbmZvcm1lIGRlIGFuw6FsaXNpcyBkZSB1bmEgc2VyaWUgdGVtcG9yYWwgcHJlY2lzYS4KClBhcmEgZWwgY8OzZGlnbyBkZSBlc3RlIGVqZW1wbG8gc2UgdXRpbGl6YXLDoW4gZnVuY2lvbmVzIGRlIGxhcyBsaWJyZXLDrWFzIGLDoXNpY2FzIGRlIGBSYCB5IGRlIG90cmFzIHF1ZSBzZSBwdWVkZW4gZW5jb250cmFyIGVuIGxhcyBzaWd1aWVudGVzIGxpYnJlcsOtYXM6CgpgYGB7cn0KbGlicmFyeShncmlkRXh0cmEpCmxpYnJhcnkoYW9kKQpsaWJyYXJ5KGZvcmVjYXN0KQpsaWJyYXJ5KGdncGxvdDIpOyB0aGVtZV9zZXQodGhlbWVfYncoKSkKbGlicmFyeShzZWFzb25hbCkKbGlicmFyeShrbml0cikKbGlicmFyeSh0aW1lRGF0ZSkKYGBgCgoKIyBQYXNhamVyb3MgZW4gdHJhbnNwb3J0ZSB1cmJhbm8KCkxhIHNlcmllIHF1ZSBzZSB2YSBhIGFuYWxpemFyIGNvcnJlc3BvbmRlIGFsIG7Dum1lcm8gZGUgcGFzYWplcm9zIGVuIHRyYW5zcG9ydGUgdXJiYW5vIGVuIEVzcGHDsWEuIEVzIHVuYSBzZXJpZSBtZW5zdWFsIHF1ZSBwdWVkZSBzZXIgY29uc3VsdGFkYSBlbiBlbCBbSW5zdGl0dXRvIE5hY2lvbmFsIGRlIEVzdGFkw61zdGljYV0oXGh0dHA6Ly93d3cuaW5lLmVzKSB5IHBhcmEgbGEgcXVlIHNlIGRpc3BvbmUgZGUgZGF0b3MgZGVzZGUgZW5lcm8gZGUgMTk5NiBoYXN0YSBkaWNpZW1icmUgZGUgMjAxOS4KClBvciB0cmFuc3BvcnRlIHVyYmFubyBkZSBwYXNhamVyb3Mgc2UgaGFjZSByZWZlcmVuY2lhIGEgbG9zIHNlcnZpY2lvcyBkZSB0cmFuc3BvcnRlIHRlcnJlc3RyZSBkZSBwYXNhamVyb3MsIHVyYmFubyB5IHN1YnVyYmFubywgcG9yIGl0aW5lcmFyaW9zIHJlZ3VsYXJlcywgY29uIGhvcmFyaW8gZXN0YWJsZWNpZG8geSBjb24gcGFyYWRhcyBmaWphcywgcmVhbGl6YWRvcyBwb3IgYXV0b2J1c2VzLCB0cmFudsOtYXMsIHRyb2xlYnVzZXMsIG1ldHJvcyB5IG1ldHJvcyBsaWdlcm9zLiBUYW1iacOpbiBzZSBpbmNsdXllbiBsYXMgbMOtbmVhcyBkZSBzZXJ2aWNpbyBhbCBhZXJvcHVlcnRvIHkgYSBsYXMgZXN0YWNpb25lcyB5IGxhIGV4cGxvdGFjacOzbiBkZSBmdW5pY3VsYXJlcyB5IHRlbGVmw6lyaWNvcyBzaSBmb3JtYW4gcGFydGUgZGUgbG9zIHNpc3RlbWFzIGRlIHRyw6Fuc2l0byB1cmJhbm9zIGUgaW50ZXJ1cmJhbm9zLgoKTG9zIGRhdG9zIGRlIGxhIHNlcmllLCBxdWUgZGVub21pbmFyZW1vcyBkZSBmb3JtYSBhYnJldmlhZGEgUGFzYWplcm9zLCBoYW4gc2lkbyBkZXNjYXJnYWRvcyBlbiBlbCBmaWNoZXJvIF9QYXNhamVyb3MuY3N2XyB5IGF1bnF1ZSBlbiBvcmlnZW4gbGEgdW5pZGFkIGVzIG1pbGVzIGRlIHBhc2FqZXJvcywgbGEgY2FtYmlhcmVtb3MgYSBtaWxsb25lcyBkZSBwYXNhamVyb3MuCgpgYGB7cn0KbWVzZXMgPC0gYygiRW5lIiwgIkZlYiIsICJNYXIiLCAiQWJyIiwgIk1heSIsICJKdW4iLCAKICAgICAgICAgICAiSnVsIiwgIkFnbyIsICJTZXAiLCAiT2N0IiwgIk5vdiIsICJEaWMiKQoKUGFzYWplcm9zIDwtIHJlYWQuY3N2MigiLi9zZXJpZXMvUGFzYWplcm9zLmNzdiIsIGhlYWRlciA9IFRSVUUpClBhc2FqZXJvcyA8LSB0cyhQYXNhamVyb3MvMTAwMCwgc3RhcnQgPSAxOTk2LCBmcmVxID0gMTIpCmBgYAoKCiMgRGVzY3JpcHRpdmEKCkxhIGZpZ3VyYSAyLjEgbXVlc3RyYSBsYSBldm9sdWNpw7NuIGRlIGxhIHNlcmllIFBhc2FqZXJvcyBlbiB0cmFuc3BvcnRlIHVyYmFubyBkZXNkZSAxOTk2IGhhc3RhIDIwMTkuIERlc3RhY2EgcXVlIGxhIHRlbmRlbmNpYSBkZSBsYSBzZXJpZSBoYSBzZWd1aWRvIGVsIGNpY2xvIGVjb27Ds21pY28uIER1cmFudGUgZWwgcGVyaW9kbyBkZSBjcmVjaW1pZW50byBkZSBmaW5hbGVzIGRlbCBzaWdsbyBwYXNhZG8geSBwcmluY2lwaW9zIGRlIGVzdGUsIGVsIG7Dum1lcm8gZGUgcGFzYWplcm9zIGVuIHRyYW5zcG9ydGUgdXJiYW5vIGNyZWNpw7MgZGUgZm9ybWEgc29zdGVuaWRhLiBDb24gbGEgY3Jpc2lzIGVjb27Ds21pY2EgaW5pY2lhZGEgYSBmaW5hbGVzIGRlIDIwMDcgc2Ugb2JzZXJ2YSB1biBjYW1iaW8gZW4gbGEgdGVuZGVuY2lhIHkgZWwgbsO6bWVybyBkZSBwYXNhamVyb3Mgc2UgcmVkdWNlLiBObyBlcyBoYXN0YSBlbCBmaW5hbCBkZSBsYSBjcmlzaXMgZW4gMjAxNCBxdWUgbGEgdGVuZGVuY2lhIHZ1ZWx2ZSBhIGNhbWJpYXIgeSBwYXNhciBhIHNlciBjcmVjaWVudGUgZGUgbnVldm8uCgpgYGBge3J9CmF1dG9wbG90KFBhc2FqZXJvcywgY29sb3VyID0gImRhcmtibHVlIiwKICAgICAgICAgeGxhYiA9ICIiLAogICAgICAgICB5bGFiID0gIk1pbGxvbmVzIGRlIHBhc2FqZXJvcyIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDIuMS4gUGFzYWplcm9zIGVuIHRyYW5zcG9ydGUgdXJiYW5vIChkYXRvcyBtZW5zdWFsZXMpIikgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgxOTk2LCAyMDE5LCAyKSkgCmBgYAoKTGEgc2VyaWUgcHJlc2VudGEgdW5hIGFjdXNhZGEgZXN0YWNpb25hbGlkYWQsIGNhdXNhZGEgcHJpbmNpcGFsbWVudGUgcG9yIGxhIGRpc3RyaWJ1Y2nDs24gZGUgbGFzIHZhY2FjaW9uZXMgYSBsbyBsYXJnbyBkZSB1biBhw7FvIHkgZWwgbsO6bWVybyBkZSBkw61hcyBsYWJvcmFibGVzIGRlIGNhZGEgbWVzLiBQZW5zZW1vcyBxdWUgZWwgcHJpbmNpcGFsIHVzbyBkZWwgdHJhbnNwb3J0ZSB1cmJhbm8gZXMgZWwgdHJhc2xhZG8gaGFzdGEgeSBkZXNkZSBlbCBsdWdhciBkZSB0cmFiYWpvLCBzZWd1aWRvIGRlbCBvY2lvIChpciBkZSBjb21wcmFzLCBhbCBjaW5lLCBhIHJlc3RhdXJhbnRlcywgZXRjLikuIEFzw60sIGNhZGEgYcOxbyBlbCBtZXMgY29uIG1lbm9yIG7Dum1lcm8gZGUgcGFzYWplcm9zIGVzIGFnb3N0byAobG9zIHZhbGxlcyBlbiBsYSBmaWd1cmEgMi4xKSBwb3IgZXN0YXIgbGEgbWF5b3LDrWEgZGUgbGEgZ2VudGUgZGUgdmFjYWNpb25lcywgZnVlcmEgZGUgc3VzIGNpdWRhZGVzIGRlIHJlc2lkZW5jaWEgaGFiaXR1YWxlcywgeSBubyB1c2FyIHRhbiBpbnRlbnNhbWVudGUgZWwgdHJhbnNwb3J0ZSB1cmJhbm8uCgpFbCBlc3F1ZW1hIHBhcmVjZSBzZXIgYWRpdGl2byBwb3JxdWUgbm8gc2UgYXByZWNpYSBxdWUgbGEgYW1wbGl0dWQgZXN0YWNpb25hbCBzZSBhbXBsw61lIGNvbmZvcm1lIGVsIG7Dum1lcm8gZGUgcGFzYWplcm9zIGF1bWVudGEuCgpFbiBsb3Mgc2lndWllbnRlcyBlcMOtZ3JhZmVzIHNlIGhhcsOhIHVuYSBkZXNjcmlwdGl2YSBkZSBsYSB0ZW5kZW5jaWEgeSBsYSBlc3RhY2lvbmFsaWRhZCBtw6FzIGRldGFsbGFkYS4gCgpcCgojIyBBbsOhbGlzaXMgZGUgbGEgdGVuZGVuY2lhCgpTaSBhbnVhbGl6YW1vcyBsYSBzZXJpZSBwb2RlbW9zLCBwb3IgdW4gbGFkbywgaWRlbnRpZmljYXIgbWVqb3IgZW4gcXVlIGHDsW9zIHNlIHByb2R1Y2VuIGxvcyBjYW1iaW9zIGVuIGxhIHRlbmRlbmNpYSB5LCBwb3Igb3RybyBsYWRvLCBwb25lciBjaWZyYXMgYWwgdm9sdW1lbiBkZSBwYXNhamVyb3MgZW4gdHJhbnNwb3J0ZSB1cmJhbm8uCgpgYGB7cn0KUGFzYWplcm9zQW51YWwgPC0gYWdncmVnYXRlKFBhc2FqZXJvcywgRlVOID0gc3VtKQphdXRvcGxvdChQYXNhamVyb3NBbnVhbCwgY29sb3VyID0gImRhcmtibHVlIiwKICAgICAgICAgeGxhYiA9ICIiLAogICAgICAgICB5bGFiID0gIk1pbGxvbmVzIGRlIHBhc2FqZXJvcyIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDIuMi4gUGFzYWplcm9zIGVuIHRyYW5zcG9ydGUgdXJiYW5vIChkYXRvcyBhbnVhbGVzKSIpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzPSBzZXEoMTk5NiwgMjAxOSwgMikpCmBgYAoKTGEgZmlndXJhIDIuMiBtdWVzdHJhIGVsIHZvbHVtZW4gYW51YWwgZGUgcGFzYWplcm9zIGVuIHRyYW5zcG9ydGUgdXJiYW5vLiBFbCBjcmVjaW1pZW50byBjb250aW51YWRvLCBwb3NpYmxlbWVudGUgaW5pY2lhZG8gYW50ZXMgZGUgMTk5NiB5IHF1ZSBwZXJtaXRpw7Mgc3VwZXJhciBsb3MgMywwMDAgbWlsbG9uZXMgZGUgcGFzYWplcm9zIGVuIDIwMDcsIHNlIHZlIGludGVycnVtcGlkbyBjb24gZWwgaW5pY2lvIGRlIGxhIHBhc2FkYSBjcmlzaXMgZWNvbsOzbWljYS4gTGEgY2HDrWRhIGlycmVndWxhciBlbiBlbCBuw7ptZXJvIGRlIHBhc2FqZXJvcyBzZSBpbnRlcnJ1bXBlIGVuIDIwMTQsIGHDsW8gcXVlIG1hcmNhIGxhIHNhbGlkYSBkZSBsYSBjcmlzaXMgZWNvbsOzbWljYSB5IGVsIGluaWNpbyBkZSBsYSByZWN1cGVyYWNpw7NuIGVuIGVsIHNlcmllLiBBY3R1YWxtZW50ZSBzZSBoYW4gc3VwZXJhZG8gbG9zIDMsMTAwIG1pbGxvbmVzIGRlIHBhc2FqZXJvcy4KCkVsIGluY3JlbWVudG8gZW4gZWwgdXNvIGRlbCB0cmFuc3BvcnRlIHVyYmFubyBvYnNlcnZhZG8gYW50ZXMgeSBkZXNwdcOpcyBkZSBsYSBjcmlzaXMgcHVlZGUgdGVuZXIgZGlzdGludGFzIGNhdXNhczogdW4gdXNvIG3DoXMgaW50ZW5zaXZvIGRlbCB0cmFuc3BvcnRlIHVyYmFubyBlbiBkZXRyaW1lbnRvIGRlIG90cm9zIG1lZGlvcyBkZSB0cmFuc3BvcnRlLCB1bmEgcmVvcmdhbml6YWNpw7NuIGRlIGxvcyBzZXJ2aWNpb3MgZGUgdHJhbnNwb3J0ZSB1cmJhbm8gcXVlIGhheWEgbWVqb3JhZG8gbGEgY29uZWN0aXZpZGFkIGRlbnRybyBkZSBsb3MgbXVuaWNpcGlvcywgbyB1biBhdW1lbnRvIGVuIGVsIG7Dum1lcm8gZGUgbMOtbmVhcyBkZSBhdXRvYsO6cywgdHJhbnbDrWEgbyBtZXRybyBlbiBkZXRlcm1pbmFkYXMgY2l1ZGFkZXMuCgpObyBlc3TDoSBjbGFyYSBsYSBjYXVzYSBkZWwgcmVwdW50ZSBhaXNsYWRvIG9ic2VydmFkbyBlbCBhw7FvIDIwMTEsIGVuIHBsZW5hIGNyaXNpcywgcGVybyBwdWVkZSBkZWJlcnNlIGEgdW5hIGxpZ2VyYSByZWN1cGVyYWNpw7NuIGVuIGxhIGVjb25vbcOtYSBxdWUgdHV2byBsdWdhciBhIGZpbmFsZXMgZGUgMjAxMCB5IHByaW5jaXBpb3MgZGUgMjAxMS4KClwKCiMjIEFuw6FsaXNpcyBkZSBsYSBlc3RhY2lvbmFsaWRhZAoKTGEgcHJpbmNpcGFsIGNhdXNhIGRlIGxhIGVzdGFjaW9uYWxpZGFkIG9ic2VydmFkYSBlbiBsYSBzZXJpZSBlcyBsYSBlc3RydWN0dXJhIHZhY2FjaW9uYWwgZGUgbGEgc29jaWVkYWQsIGVzcGVjaWFsbWVudGUgY2FyYWN0ZXJpemFkYSBwb3IgbGFzIHZhY2FjaW9uZXMgZGUgdmVyYW5vIChqdWxpbyBhIHNlcHRpZW1icmUpIHkgbGFzIHZhY2FjaW9uZXMgZGUgU2VtYW5hIFNhbnRhIChlbiBtYXJ6byB5L28gYWJyaWwsIHNlZ8O6biBlbCBhw7FvKS4gQWRlbcOhcywgZGViaWRvIGEgcXVlIGVsIHRyYW5zcG9ydGUgdXJiYW5vIHNlIHVzYSBwcmluY2lwYWxtZW50ZSBwYXJhIGlyIGEgdHJhYmFqYXIsIHRhbWJpw6luIGluZmx1eWUgZWwgbsO6bWVybyBkZSBkw61hcyBsYWJvcmFibGVzIGRlbCBtZXMuIFBvciBlamVtcGxvLCBlbiAyMDE3IGVsIG1lcyBkZSBqdW5pbyB0dXZvIDIyIGTDrWFzIGxhYm9yYWJsZXMsIG1pZW50cmFzIHF1ZSBlbiAyMDE5IHR1dm8gMjAgZMOtYXMgbGFib3JhYmxlcy4gRXN0YSBkaWZlcmVuY2lhIGRlIGRvcyBkw61hcyB0ZW5kcsOhIHVuIGVmZWN0byBzb2JyZSBlbCB2b2x1bWVuIGRlIHBhc2FqZXJvcy4KCkVsIG7Dum1lcm8gZGUgZMOtYXMgbGFib3JhYmxlcyBkZSB1biBtZXMgdmllbmUgbWFyY2FkbyBwb3IgbG9zIGZpbmVzIGRlIHNlbWFuYSBkZWwgbWVzIHkgcG9yIGxhcyBmZXN0aXZpZGFkZXMgbmFjaW9uYWxlcy4gRXMgY2llcnRvIHF1ZSBlbCBzw6FiYWRvIHNlIHRyYWJhamEgZW4gZGl2ZXJzb3Mgc2VjdG9yZXMgKHRyYW5zcG9ydGUsIG9jaW8sIGRpc3RyaWJ1Y2nDs24pIHBlcm8gbGEgY2HDrWRhIGVuIGVsIG7Dum1lcm8gZGUgdHJhYmFqYWRvcmVzIHJlc3BlY3RvIGRlIGxvcyBkw61hcyBlbnRyZSBzZW1hbmEgKGx1bmVzIGEgdmllcm5lcykgZXMgbXV5IG5vdGFibGUuIFRhbWJpw6luIGVzIGNpZXJ0byBxdWUsIGFkZW3DoXMgZGUgbGFzIGZlc3RpdmlkYWRlcyBuYWNpb25hbGVzLCBoYXkgbXVjaGFzIGZlc3RpdmlkYWRlcyBhdXRvbsOzbWljYXMgbyBtdW5pY2lwYWxlcyBxdWUgcG9kcsOtYW4gYWZlY3RhciBhbCB2b2x1bWVuIGRlIHBhc2FqZXJvcyBlbiB0cmFuc3BvcnRlIHVyYmFuby4gUG9yIGVqZW1wbG8sIGxhcyBmZXN0aXZpZGFkZXMgcmVnaW9uYWxlcyBlbiBjb211bmlkYWRlcyBjb21vIE1hZHJpZCBvIENhdGFsdcOxYSBwdWVkZW4gdGVuZXIgdW4gZWZlY3RvIHNpZ25pZmljYXRpdm8gc29icmUgbGEgc2VyaWUgUGFzYWplcm9zLiBTaW4gZW1iYXJnbywgbGFzIGZlc3RpdmlkYWRlcyBubyBuYWNpb25hbGVzIG5vIHNlIHZhbiBhIHRlbmVyIGVuIGN1ZW50YS4KClBvciB0YW50bywgcGFyYSByZWFsaXphciB1biBhbsOhbGlzaXMgZGV0YWxsYWRvIGRlIGxhIGVzdGFjaW9uYWxpZGFkLCBlcyBuZWNlc2FyaW8gY3JlYXIgdW5hIHNlcmllIGNvbiBlbCBuw7ptZXJvIGRlIGTDrWFzIGxhYm9yYWJsZXMgZGUgY2FkYSBtZXMuIEFkZW3DoXMsIGVzdGEgc2VyaWUgc2UgdXNhcsOhIG3DoXMgYWRlbGFudGUgcGFyYSBtb2RlbGl6YXIgeSBwcmVkZWNpciBsYSBzZXJpZSBQYXNhamVyb3MuCgojIyMgRMOtYXMgbGFib3JhYmxlcyBkZSBjYWRhIG1lcyB7LX0KCkxhIGxpYnJlcsOtYSBgdGltZURhdGFgIHByb3BvcmNpb25hIHVuYSBzZXJpZSBkZSBmdW5jaW9uZXMgcXVlIHBlcm1pdGVuIGRlZmluaXIgdW4gY2FsZW5kYXJpbyBkZSBmZXN0aXZpZGFkZXMsIGlkZW50aWZpY2FyIGxvcyBmaW5lcyBkZSBzZW1hbmEgeSwgYSBwYXJ0aXIgZGUgYXF1w60sIGNyZWFyIGxhIHNlcmllIGRlIGTDrWFzIGxhYm9yYWJsZXMgKHbDqWFzZSBjw7NkaWdvIG3DoXMgYWJham8pLgoKKiBDb24gYHRpbWVDYWxlbmRhcmAgc2UgZGVmaW5lbiBsYXMgX2NvbnNpZGVyYWRhc18gZmVzdGl2aWRhZGVzIG5hY2lvbmFsZXM6IEHDsW8gbnVldm8gKDEgZGUgZW5lcm8pLCBSZXllcyAoNiBkZSBlbmVybyksIFZpZXJuZXMgU2FudG8gKGZlY2hhIHZhcmlhYmxlKSwgRMOtYSBkZWwgVHJhYmFqbyAoMSBkZSBtYXlvKSwgRMOtYSBkZSBsYSBBc3VuY2nDs24gKDE1IGRlIGFnb3N0byksIETDrWEgZGUgbGEgSGlzcGFuaWRhZCAoMTIgZGUgb2N0dWJyZSksIETDrWEgZGUgVG9kb3MgbG9zIFNhbnRvcyAoMSBkZSBub3ZpZW1icmUpLCBsYSBDb25zdGl0dWNpw7NuICg2IGRlIGRpY2llbWJyZSkgbGEgSW5tYWN1bGFkYSBDb25jZXBjacOzbiAoOCBkZSBkaWNpZW1icmUpIHkgTmF2aWRhZCAoMjUgZGUgZGljaWVtYnJlKS4gCgogIFBvciBjbGFyaWRhZCwgY2FkYSBmZXN0aXZvIHNlIGhhIGRlZmluaWRvIGRlIGZvcm1hIGluZGVwZW5kaWVudGUgcGFyYSBkZXNwdcOpcyBjcmVhciB1bmEgdmFyaWFibGUgY29uIHRvZGFzIGxhcyBmZXN0aXZpZGFkZXMgKF9GZXN0aXZvc05hY2lvbmFsZXNfKS4KCiAgRWwgcmFuZ28gcGFyYSB0b2RvcyBsb3MgY8OhbGN1bG9zIHZhIGRlc2RlIDE5OTYgaGFzdGEgMjAyNCwgcXVlIGluY2x1eWUgZWwgcmFuZ28gZGUgbGEgc2VyaWUgUGFzYWplcm9zIG3DoXMgY2luY28gYcOxb3MgZGUgcHJlZGljY2nDs24uCgogIExhIGZ1bmNpw7NuIHV0aWxpemFkYSBgRWFzdGVyYCBkZSBsYSBsaWJyZXLDrWEgYHRpbWVEYXRlYCBkaWZpZXJlIGRlIGxhIGZ1bmNpw7NuIGBlYXN0ZXJgIGRlIGBmb3JlY2FzdGAuCgoqIEEgY29udGludWFjacOzbiwgY29uIGB0aW1lU2VxdWVuY2VgIHNlIGNyZWEgdW5hIHNlcmllIGRpYXJpYSBkZXNkZSBlbCAxIGRlIGVuZXJvIGRlIDE5OTYgaGFzdGEgZWwgMzEgZGUgZGljaWVtYnJlIGRlIDIwMjQuCgoqIExhcyBkb3Mgc2lndWllbnRlcyBsw61uZWFzIGVsaW1pbmFuIGRlIGxhIHNlcmllIGRpYXJpYSBsb3MgZmVzdGl2b3MgeSBsb3MgZmluZXMgZGUgc2VtYW5hLCAoZnVuY2nDs24gYGlzQml6ZGF5YCksIHBhcmEgZGVzcHXDqXMgZGFyIGEgZXN0YSBudWV2YSBzZXJpZSBlbCBmb3JtYXRvIGHDsW8tbWVzIGVsaW1pbmFuZG8gZWwgZMOtYS4gRGUgZXN0YSBmb3JtYSwgbGEgc2VyaWUgZGUgZMOtYXMgbGFib3JhbGVzIHRlbmRyw6EgZWwgbWlzbW8gaWRlbnRpZmljYWRvciBwYXJhIHRvZG9zIGxvcyBkw61hcyBkZWwgbWlzbW8gbWVzLgoKKiBEZXNwdcOpcywgc2UgY3JlYSB1bmEgdGFibGEgcXVlLCBwb3IgbGEgbmF0dXJhbGV6YSBkZSBsYSBzZXJpZSBkZSBkw61hcyBsYWJvcmFsZXMsIHRlbmRyw6EgcGFyYSBjYWRhIGHDsW8tbWVzIGVsIG51bWVybyBkZSBkw61hcyBsYWJvcmFibGVzLiBQb3Igw7psdGltbyBmZWNoYW1vcyBsYSB0YWJsYSwgcXVlIGVzIG51ZXN0cmEgc2VyaWUgZGUgZMOtYXMgbGFib3JhYmxlcyB5IG1vc3RyYW1vcyBhbGd1bm9zIGRhdG9zLgoKKiBMYXMgZG9zIMO6bHRpbWFzIGzDrW5lYXMgZGUgY8OzZGlnbyBkaXZpZGVuIGxhIHNlcmllIGVuIGVsIHBlcmlvZG8gbXVlc3RyYWwgeSBlbCBkZSBwcmVkaWNjacOzbi4KClwKCmBgYHtyfQpBbm9OdWV2byA8LSB0aW1lQ2FsZW5kYXIoZCA9IDEsIG0gPSAxLCB5ID0gMTk5NjoyMDI0KQpSZXllcyA8LSB0aW1lQ2FsZW5kYXIoZCA9IDYsIG0gPSAxLCB5ID0gMTk5NjoyMDI0KQpWaWVybmVzU2FudG8gPC0gRWFzdGVyKDE5OTY6MjAyNCwgc2hpZnQgPSAtMikKRGlhVHJhYmFqbyA8LSB0aW1lQ2FsZW5kYXIoZCA9IDEsIG0gPSA1LCB5ID0gMTk5NjoyMDI0KQpBc3VuY2lvbiA8LSB0aW1lQ2FsZW5kYXIoZCA9IDE1LCBtID0gOCwgeSA9IDE5OTY6MjAyNCkKSGlzcGFuaWRhZCA8LSB0aW1lQ2FsZW5kYXIoZCA9IDEyLCBtID0gMTAsIHkgPSAxOTk2OjIwMjQpClRvZG9TYW50b3MgPC0gdGltZUNhbGVuZGFyKGQgPSAxLCBtID0gMTEsIHkgPSAxOTk2OjIwMjQpCkNvbnN0aXR1Y2lvbiA8LSB0aW1lQ2FsZW5kYXIoZCA9IDYsIG0gPSAxMiwgeSA9IDE5OTY6MjAyNCkKSW5tYWN1bGFkYSA8LSB0aW1lQ2FsZW5kYXIoZCA9IDgsIG0gPSAxMiwgeSA9IDE5OTY6MjAyNCkKTmF2aWRhZCA8LSB0aW1lQ2FsZW5kYXIoZCA9IDI1LCBtID0gMTIsIHkgPSAxOTk2OjIwMjQpCgpGZXN0aXZvc05hY2lvbmFsZXMgPC0gYyhBbm9OdWV2bywgUmV5ZXMsIFZpZXJuZXNTYW50bywKICAgICAgICAgICAgICAgICAgICAgICAgRGlhVHJhYmFqbywgQXN1bmNpb24sICBIaXNwYW5pZGFkLCBUb2RvU2FudG9zLCAKICAgICAgICAgICAgICAgICAgICAgICAgQ29uc3RpdHVjaW9uLCBJbm1hY3VsYWRhLCBOYXZpZGFkKQoKZmVjaGFEaWFyaWEgPC0gdGltZVNlcXVlbmNlKGZyb20gPSAiMTk5Ni0wMS0wMSIsIHRvID0gIjIwMjQtMTItMzEiKQpiaXogPC0gZmVjaGFEaWFyaWFbaXNCaXpkYXkoZmVjaGFEaWFyaWEsIGhvbGlkYXlzID0gRmVzdGl2b3NOYWNpb25hbGVzKV0KYml6ZGF5cyA8LSBmb3JtYXQoYml6LCBmb3JtYXQgPSAiJVktJW0iKQoKRGlhc0xhYm9yYWJsZXMgPC0gdGFibGUoYml6ZGF5cykKRGlhc0xhYm9yYWJsZXMgPC0gdHMoRGlhc0xhYm9yYWJsZXMsIHN0YXJ0ID0gMTk5NiwgZnJlcXVlbmN5ID0gMTIpCgpzdWJzZXQoRGlhc0xhYm9yYWJsZXMsIHN0YXJ0ID0gMjg5KSAjTW9zdHJhbW9zIHNvbG8gbG9zIDUgw7psdGltb3MgYcOxb3MKCnBEaWFzTGFib3JhYmxlcyA8LSBzdWJzZXQoRGlhc0xhYm9yYWJsZXMsIHN0YXJ0ID0gbGVuZ3RoKERpYXNMYWJvcmFibGVzKSAtIDU5KQpEaWFzTGFib3JhYmxlcyA8LSBzdWJzZXQoRGlhc0xhYm9yYWJsZXMsIGVuZCA9IGxlbmd0aChEaWFzTGFib3JhYmxlcykgLSA2MCkKYGBgCgpFcyBjb252ZW5pZW50ZSBpbmRpY2FyIHF1ZSBsYSBpZGVudGlmaWNhY2nDs24gZGUgbGFzIGZlc3RpdmlkYWRlcyBuYWNpb25hbGVzIGRpc3RhIGRlIHNlciBwZXJmZWN0YSBwb3IgdmFyaW9zIG1vdGl2b3M6CgoqIGFsZ3Vub3MgZmVzdGl2b3MgbmFjaW9uYWxlcywgc2kgY2FlbiBlbiBkb21pbmdvLCBzZSBwYXNhbiBhIGx1bmVzIChwb3IgZWplbXBsbyBSZXllcyB5IGxhIElubWFjdWxhZGEgZGUgMjAxOSksIGFzcGVjdG8gcXVlIG5vIHNlIGhhIHRlbmlkbyBlbiBjdWVudGEuCiogYWxndW5vcyBmZXN0aXZvcyBuYWNpb25hbGVzIHB1ZWRlbiBzZXIgc3VzdGl0dWlkb3MgcG9yIG90cm9zIGTDrWFzIHBvciBsYXMgQ29tdW5pZGFkZXMgQXV0w7Nub21hcywgcG9yIGVqZW1wbG8gUmV5ZXMgbyBKdWV2ZXMgU2FudG8uCgpcCgojIyMgQW7DoWxpc2lzIGdyw6FmaWNvIGRlIGxhIGVzdGFjaW9uYWxpZGFkIHstfQoKVmVhbW9zIGFob3JhIHVuYSBkZXNjcmlwdGl2YSBkZXRhbGxhZGEgZGUgbGEgZXN0YWNpb25hbGlkYWQgZGUgbGEgc2VyaWUgUGFzYWplcm9zLCBoYWNpZW5kbyBlc3BlY2lhbCBoaW5jYXBpw6kgZW4gZWwgZWZlY3RvIGRlIGxhcyB2YWNhY2lvbmVzICh2ZXJhbm8geSBTZW1hbmEgU2FudGEpIHkgZWwgbsO6bWVybyBkZSBkw61hcyBsYWJvcmFibGVzLiBQYXJhIGVsbG8sIG1vc3RyYXJlbW9zIGdyw6FmaWNhbWVudGUgbGFzIHN1YnNlcmllcyBkZWZpbmlkYXMgcG9yIGVsIG1lcyB0YW50byBwYXJhIFBhc2FqZXJvcyBjb21vIHBhcmEgX1Bhc2FqZXJvcyBwb3IgZMOtYSBsYWJvcmFibGVfLCBlc3RhIHNlZ3VuZGEgcmVzdWx0YWRvIGRlIGRpdmlkaXIgUGFzYWplcm9zIHBvciBEaWFzTGFib3JhYmxlcy4KCmBgYHtyLCBmaWcuaGVpZ2h0ID0gNX0KUGFzYWplcm9zREwgPC0gUGFzYWplcm9zL0RpYXNMYWJvcmFibGVzCgpnMSA8LSBnZ3N1YnNlcmllc3Bsb3QoUGFzYWplcm9zKSArCiAgeWxhYigiTWlsbG9uZXMgZGUgcGFzYWplcm9zIikgKwogIHhsYWIoIiIpICsKICBnZ3RpdGxlKCJGaWd1cmEgMi4zYS4gR3LDoWZpY28gZXN0YWNpb25hbCBwYXJhIFBhc2FqZXJvcyIpCgpnMiA8LSBnZ3N1YnNlcmllc3Bsb3QoUGFzYWplcm9zREwpICsKICB5bGFiKCJNaWxsb25lcyBkZSBwYXNhamVyb3MiKSArCiAgeGxhYigiIikgKwogIGdndGl0bGUoIkZpZ3VyYSAyLjNiLiBHcsOhZmljbyBlc3RhY2lvbmFsIHBhcmEgUGFzYWplcm9zIHBvciBkw61hIGxhYm9yYWwiKQoKZ3JpZC5hcnJhbmdlKAogIGdyb2JzID0gbGlzdChnMSwgZzIpLAogIG5jb2wgPSAxCikKYGBgCkxhcyBmaWd1cmFzIDIuM2EgeSAyLjNiIG11ZXN0cmFuIHBhcmEgY2FkYSBtZXMgbGEgc2VyaWUgZGUgcGFzYWplcm9zICh0b3RhbCBvIHBvciBkw61hIGxhYm9yYWJsZSkgeSBlbCB2YWxvciBtZWRpbyAobMOtbmVhIGF6dWwgaG9yaXpvbnRhbCkuIEVuIGFtYm9zIGNhc29zIHNlIGlkZW50aWZpY2EgcGVyZmVjdGFtZW50ZSBlbCBlZmVjdG8gZGUgbG9zIHBlcmlvZG9zIHZhY2FjaW9uYWxlcyBzb2JyZSBlbCB0cmFuc3BvcnRlIHVyYmFubyBkZSBwYXNhamVyb3MuIEVuIGxhcyB2YWNhY2lvbmVzIGRlIHZlcmFubyBzZSBvYnNlcnZhIHVuYSBmdWVydGUgY2HDrWRhIGVuIGVsIG7Dum1lcm8gZGUgcGFzYWplcm9zLCBlc3BlY2lhbG1lbnRlIGVuIGFnb3N0byB5LCBlbiBtZW5vciBtZWRpZGEsIGVuIGp1bGlvIHkgc2VwdGllbWJyZS4gUG9yIG90cm8gbGFkbywgbGFzIHN1YnNlcmllcyBkZSBtYXJ6byB5IGFicmlsIG11ZXN0cmFuIG11Y2hhIG3DoXMgaXJyZWd1bGFyaWRhZCBxdWUgbGFzIGRlIG90cm9zIG1lc2VzIGRlYmlkbyBhIHF1ZSBlbCB2b2x1bWVuIGRlIHBhc2FqZXJvcyBkZXBlbmRlIGRlIGPDs21vIGhhIGNhw61kbyBsYSBTZW1hbmEgU2FudGEuIFNpIHVuIGHDsW8gZXN0YSBjYWUgZW4gbWFyem8sIGVzZSBtZXMgcHJlc2VudGFyw6EgdW4gdm9sdW1lbiBkZSBwYXNhamVyb3MgaW5mZXJpb3IgYWwgZGUgbG9zIG1lc2VzIGRlIG1hcnpvIHNpbiBTZW1hbmEgU2FudGEsIG1pZW50cmFzIHF1ZSBlbiBhYnJpbCBzZSBkYXLDoSBlbCBlZmVjdG8gY29udHJhcmlvLiBEaWNpZW1icmUsIHBhcmEgc2VyIHVuIG1lcyBkZSAzMSBkw61hcywgcHJlc2VudGEgdGFtYmnDqW4gdW4gcmVkdWNpZG8gbsO6bWVybyBkZSBwYXNhamVyb3MgZGViaWRvIGEgbGFzIHZhY2FjaW9uZXMgbmF2aWRlw7Fhcy4KCkxhIGZpZ3VyYSAyLjNhIG11ZXN0cmEgZWwgZWZlY3RvIGVzdGFjaW9uYWwgdG90YWwgZGViaWRvIGFsIG7Dum1lcm8gZGUgZMOtYXMgZGVsIG1lcyB5IGRlIGTDrWFzIGxhYm9yYWxlcy4gUG9yIGVqZW1wbG8sIGVuIGZlYnJlcm8sIGVsIG1lcyBjb24gbWVub3MgZMOtYXMgeSBwb3IgdGFudG8gY29uIG1lbm9zIGTDrWFzIGxhYm9yYWxlcywgZW4gbWVkaWEgc2UgdHJhbnNwb3J0YW4gbWVub3MgcGFzYWplcm9zLCBjb21wYXJhZG8gY29uIGVuZXJvIG8gbWFyem8uIE9jdHVicmUsIHVuIG1lcyBjb24gMzEgZMOtYXMsIG11ZXN0cmEgdW4gdm9sdW1lbiBtZWRpbyBkZSBwYXNhamVyb3MgbWF5b3IgcXVlIG5vdmllbWJyZSBkZSAzMCBkw61hcy4KCkVuIGxhIGZpZ3VyYSAyLjNiIHNlIGhhIGVsaW1pbmFkbyBlbCBlZmVjdG8gZGUgbG9zIGTDrWFzIGxhYm9yYWJsZXMgYWwgdHJhYmFqYXIgY29uIGxhIHNlcmllIGRlIHBhc2FqZXJvcyB0cmFuc3BvcnRhZG9zIHBvciBkw61hIGxhYm9yYWJsZS4gU2kgbGEgY29tcGFyYW1vcyBjb24gbGEgZmlndXJhIDIuM2EsIGRlc3RhY2EgcXVlIGxhcyBkaWZlcmVuY2lhcyBlbnRyZSBsYXMgbWVkaWFzIChsaW5lYXMgYXp1bGVzKSBzZSBoYW4gcmVkdWNpZG86IHByw6FjdGljYW1lbnRlIG5vIGhheSBkaWZlcmVuY2lhcyBlbnRyZSBsb3MgbWVzZXMgZGUgZW5lcm8gYSBqdW5pbywgbyBlbnRyZSBsb3MgbWVzZXMgZGUgb2N0dWJyZSBhIGRpY2llbWJyZS4KCkNhYmUgcGVuc2FyIHF1ZSBhbCBleGNsdWlyIGRlIGxhIHNlcmllIGRlIGTDrWFzIGxhYm9yYWJsZXMgbGEgU2VtYW5hIFNhbnRhLCBlbiBsYSBmaWd1cmEgMi4zYiBsYXMgc3Vic2VyaWVzIGRlIG1hcnpvIHkgYWJyaWwgZGViZXLDrWFuIHNlciB0YW4gc3VhdmVzIGNvbW8gbGFzIG9ic2VydmFkYXMgcGFyYSBvdHJvIG1lc2VzLCBwZXJvIG5vIGVzIGFzw60uIENsYXJhbWVudGUgbGEgc2ltcGxlIGV4Y2x1c2nDs24gZGUgbG9zIGZlc3Rpdm9zIG5hY2lvbmFsZXMgZGUgU2VtYW5hIFNhbnRhIG5vIGVzIHN1ZmljaWVudGUgcGFyYSByZWNvZ2VyIGJpZW4gc3UgZWZlY3RvIHNvYnJlIGVsIHRyYW5zcG9ydGUgdXJiYW5vLiBMYSByYXrDs24gaGF5IHF1ZSBidXNjYXJsYSBlbiBsYXMgdmFjYWNpb25lcyBlc2NvbGFyZXMgZGUgZXN0ZSBwZXJpb2RvLCBxdWUgZW4gYWxndW5hcyBjb211bmlkYWRlcyBhdXTDs25vbWFzIHRpZW5lIGx1Z2FyIGR1cmFudGUgbGEgcHJvcGlhIHNlbWFuYSBkZSBTZW1hbmEgU2FudGEsIG1pZW50cmFzIHF1ZSBlbiBvdHJhcyBjb211bmlkYWRlcyB0aWVuZSBsdWdhciBlbiBsYSBzZW1hbmEgcG9zdGVyaW9yLiBEZSBlc3RhIGZvcm1hLCBlbCBlZmVjdG8gc29icmUgZWwgdHJhbnNwb3J0ZSB1cmJhbm8gZGUgU2VtYW5hIFNhbnRhIG5vIGVzIGhvbW9nw6luZW8gZW4gZWwgdGVycml0b3JpbyBuYWNpb25hbCB5IHJlc3VsdGEgZGlmw61jaWwgaW5jbHVpcmxvIGVuIGVsIGFuw6FsaXNpcyBkZSBsYSBzZXJpZSBQYXNhamVyb3MuIEN1YW5kbyBzZSBhbmFsaWNlIGxhIHNlcmllIHBvciBtb2RlbG9zIEFyaW1hIHNlcsOhIGNvbnZlbmllbnRlIHJlY29yZGFyIGVzdGUgaGVjaG8uCgpcCgojIyMgQW7DoWxpc2lzIG51bcOpcmljbyBkZSBsYSBlc3RhY2lvbmFsaWRhZCB7LX0KClBvZGVtb3Mgb2J0ZW5lciBsYSBjb21wb25lbnRlIGVzdGFjaW9uYWwgZGUgZm9ybWEgc2VuY2lsbGEgcGFyYSBwb2RlciB2YWxvcmFyIG51bcOpcmljYW1lbnRlIGVsIGVmZWN0byBlc3RhY2lvbmFsIHkgdmVyIHF1ZSBlZmVjdG8gdGllbmUgZWwgbsO6bWVybyBkZSBkw61hcyBsYWJvcmFibGVzLiBQcmV2aWFtZW50ZSwgZGViZW1vcyBkZXRlcm1pbmFyIGVsIGVzcXVlbWEsIGFkaXRpdm8gbyBtdWx0aXBsaWNhdGl2bywgZGUgbGEgc2VyaWUuCgpMYSBncsOhZmljYSBtZWRpYS1kZXN2aWFjacOzbiB0w61waWNhIChmaWd1cmEgMi40KSByZWZ1ZXJ6YSBsYSBpbXByZXNpw7NuIHF1ZSBzZSBvYnRlbsOtYSBkZSBsYSBncsOhZmljYSBkZSBsYSBzZXJpZSAoZmlndXJhIDIuMSksIHF1ZSBlbCBlc3F1ZW1hIGVzIGFkaXRpdm8uCgpgYGB7cn0KTWVkaWFBbnVhbCA9IGFzLm51bWVyaWMoYWdncmVnYXRlKFBhc2FqZXJvcywgRlVOID0gbWVhbikpCkRlc3ZpYWNpb25BbnVhbCA9IGFzLm51bWVyaWMoYWdncmVnYXRlKFBhc2FqZXJvcywgRlVOID0gc2QpKQoKZ2dwbG90KCkgKwogIGdlb21fcG9pbnQoYWVzKHggPSBNZWRpYUFudWFsLCB5ID0gRGVzdmlhY2lvbkFudWFsKSwgc2l6ZSA9IDIpICsKICB4bGFiKCJNZWRpYSBkZSBwYXNhamVyb3MgcG9yIGHDsW8iKSArIAogIHlsYWIoIkRlc3ZpYWNpw7NuIHTDrXBpY2EgZGUgcGFzYWplcm9zIHBvciBhw7FvIikgKyAKICBnZ3RpdGxlKCJGaWd1cmEgMi40LiBJZGVudGlmaWNhY2nDs24gZGVsIHRpcG8gZGUgZXNxdWVtYSIpCmBgYAoKYGBge3J9ClBhc2FqZXJvc01lZGlhIDwtIHRhcHBseShQYXNhamVyb3MgLSBtZWFuKFBhc2FqZXJvcyksIAogICAgICAgICAgICAgICAgICAgICAgICAgY3ljbGUoUGFzYWplcm9zKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICBtZWFuKQpQYXNhamVyb3NETE1lZGlhIDwtIHRhcHBseSgoUGFzYWplcm9zREwgLSBtZWFuKFBhc2FqZXJvc0RMKSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICBjeWNsZShQYXNhamVyb3NETCksIAogICAgICAgICAgICAgICAgICAgICAgICAgICBtZWFuKQoKZGF0b3MgPC0gY2JpbmQoUGFzYWplcm9zTWVkaWEsIFBhc2FqZXJvc0RMTWVkaWEpCmNvbG5hbWVzKGRhdG9zKSA8LSBjKCJQYXNhamVyb3MiLCAiUGFzYWplcm9zIHBvciBkw61hIGxhYm9yYWJsZSIpCnJvd25hbWVzKGRhdG9zKSA8LSBtZXNlcwoKa2FibGUoZGF0b3MsIAogICAgICBkaWdpdHMgPSAyLAogICAgICBjYXB0aW9uID0gIkVmZWN0byBlc3RhY2lvbmFsIikKYGBgCgpMYSB0YWJsYSAxIHBvbmUgZW4gY2lmcmFzIGVsIGVmZWN0byBlc3RhY2lvbmFsIHNvYnJlIGxvcyBQYXNhamVyb3MgKHByaW1lcmEgY29sdW1uYSk6IGVuIGFnb3N0byBsYSBjYcOtZGEgZW4gZWwgbsO6bWVybyBkZSBwYXNhamVyb3MsIHJlc3BlY3RvIGRlIGxhIG1lZGlhIGFudWFsLCBzZSBjaWZyYSBlbiA3MiBtaWxsb25lcyBkZSBwYXNhamVyb3MuIEVuIGp1bGlvLCBzZXB0aWVtYnJlIHkgZW4gbWVub3IgbWVkaWRhIGZlYnJlcm8gdGFtYmnDqW4gZWwgdXNvIGRlbCB0cmFuc3BvcnRlIHVyYmFubyBlcyBpbmZlcmlvciBhIGxhIG1lZGlhICBhbnVhbCwgZW4gZWwgY2FzbyBkZSBsb3MgZG9zIHByaW1lcm9zIG1lc2VzIHBvciBsYXMgdmFjYWNpb25lcyBkZSB2ZXJhbm8geSBlbiBmZWJyZXJvIGRlYmlkbyBhIHNlciBlbCBtZXMgY29uIG1lbm9zIGTDrWFzIGRlbCBhw7FvLiBQb3Igb3RybyBsYWRvLCBkZXN0YWNhIGVsIGVsZXZhZG8gbsO6bWVybyBkZSBwYXNhamVyb3MgZW4gbG9zIG1lc2VzIGRlIG1hcnpvLCBtYXlvIHkgb2N0dWJyZSwgcG9yIHRlbmVyIDMxIGTDrWFzLCB5IG5vdmllbWJyZSwgcG9yIHJhem9uZXMgZGVzY29ub2NpZGFzLgoKVHJhcyBsYSBjb3JyZWNjacOzbiBwb3IgZWwgbsO6bWVybyBkZSBkw61hcyBsYWJvcmFsZXMsIGVsIGVmZWN0byBlc3RhY2lvbmFsIGVzIG3DoXMgc3VhdmUgKHbDqWFzZSBsYSBzZWd1bmRhIGNvbHVtbmEgZW4gbGEgdGFibGEgMSkuIEFob3JhLCBsb3MgbWVzZXMgZGUgZmVicmVybyB5IG1hcnpvIHRpZW5lbiB1biBlZmVjdG8gc2ltaWxhciwgYWwgaWd1YWwgcXVlIG9jdHVicmUgeSBub3ZpZW1icmUuIFRhbWJpw6luIHNlIG9ic2VydmEgcXVlIGxhcyBkaWZlcmVuY2lhcyBlbnRyZSBtYXJ6byB5IGFicmlsIHNlIGhhbiByZWR1Y2lkbyBlbm9ybWVtZW50ZS4gVGFtYmnDqW4gZWwgZWZlY3RvIF9uw7ptZXJvIGRlIGTDrWFzIGRlbCBtZXNfIGhhIGRlc2FwYXJlY2lkbyBlbiBncmFuIG1lZGlkYS4KClwKCiMjIERlc2NvbXBvc2ljacOzbiBkZSBsYSBzZXJpZQoKWWEgaGVtb3MgcmVhbGl6YWRvIHVuYSBkZXRhbGxhZGEgZGVzY3JpcGNpw7NuIGRlIGxhcyBwcmluY2lwYWxlcyBjb21wb25lbnRlcyBkZSBsYSBzZXJpZSwgdGVuZGVuY2lhIHkgZXN0YWNpb25hbGlkYWQuIEFob3JhIHZhbW9zIGEgcHJvY2VkZXIgYSBkZXNjb21wb25lcmxhIGEgZmluIGRlIGFuYWxpemFyLCBhdW5xdWUgc2VhIGRlIGZvcm1hIGdyw6FmaWNhLCBlbCBlcnJvciB5IHRlbmVyIHlhIHVuYSBwcmltZXJhIGltcHJlc2nDs24gc29icmUgbGEgcmVsZXZhbmNpYSBkZSBsYSBjb21wb25lbnRlIGRlIGludGVydmVuY2nDs24gZW4gUGFzYWplcm9zLgoKRGFkbyBxdWUgbGEgc2VyaWUgcHJlc2VudGEgdW4gZXNxdWVtYSBhZGl0aXZvLCB1c2FyZW1vcyBlbCBtw6l0b2RvIGRlIGRlc2NvbXBvc2ljacOzbiBwb3IgcmVncmVzaW9uZXMgbG9jYWxlcyBwb25kZXJhZGFzLCBhc3VtaWVuZG8gdW5hIGNvbXBvbmVudGUgZXN0YWNpb25hbCBjb25zdGFudGUgeSBjb25zaWRlcmFuZG8gbGEgcHJlc2VuY2lhIGRlIHBvc2libGVzIHZhbG9yZXMgZXh0cmVtb3MuCgpgYGB7cn0KUGFzYWplcm9zU3RsIDwtIHN0bChQYXNhamVyb3NbLDFdLCBzLndpbmRvdyA9ICJwZXJpb2RpYyIsIHJvYnVzdCA9IFRSVUUpCgplcnJvciA8LSByZW1haW5kZXIoUGFzYWplcm9zU3RsKQpzZGVycm9yIDwtIHNkKGVycm9yKQoKYXV0b3Bsb3QoZXJyb3IsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICJFcnJvciIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDIuNS4gRXJyb3IgKyBJbnRlcnZlbmNpw7NuIiwKICAgICAgICAgY29sb3VyID0gImRhcmtibHVlIikgKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IGMoMywgMiwgLTIsIC0zKSpzZGVycm9yLCAKICAgICAgICAgICAgIGNvbG91ciA9IGMoInJlZCIsICJncmVlbiIsICJncmVlbiIsICJyZWQiKSwKICAgICAgICAgICAgIGx0eSA9IDIpICsgCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcz0gc2VxKDE5OTYsIDIwMTksIDQpKQpgYGAKCkxhIGZpZ3VyYSAyLjUgbXVlc3RyYSBlbCBlcnJvciBkZSBsYSBkZXNjb21wb3NpY2nDs24geSBsb3MgaW50ZXJ2YWxvcyBkZSBjb25maWFuemEgYWwgOTUlIChsw61uZWFzIHZlcmRlcykgeSBlbCA5OS43JSAobMOtbmVhcyByb2phcykuIFNlIGFwcmVjaWFuIGNsYXJhbWVudGUgbcO6bHRpcGxlcyB2YWxvcmVzIGV4dHJlbW9zIChzdXBlcmFuIGxhcyB0cmVzIGRlc3ZpYWNpb25lcyB0w61waWNhcykgZW4gZm9ybWEgZGUgX2NvbXBlbnNhY2nDs25fIChkb3MgZXJyb3JlcyBleHRyZW1vcyBjb25zZWN1dGl2b3MgZGUgc2lnbm8gb3B1ZXN0bykgcXVlIGNvcnJlc3BvbmRlbiBhIGxvcyBtZXNlcyBkZSBtYXJ6byB5IGFicmlsIGRlIDE5OTcsIDIwMDIsIDIwMDggeSAyMDEzLCB5IG90cm8gdmFsb3IgZXh0cmVtbyBlbiBhYnJpbCBkZSAyMDA1LiBBZGVtw6FzLCBlbiBtYXJ6byB5IGFicmlsIGRlIDIwMTYgaGF5IGRvcyB2YWxvcmVzIGF0w61waWNvcy4gTsOzdGVzZSBxdWUgdG9kb3MgbG9zIHZhbG9yZXMgaWRlbnRpZmljYWRvcyBjb3JyZXNwb25kZW4gYSBsb3MgbWVzZXMgZGUgbWFyem8geSBhYnJpbCwgeSBlbiB0b2RvcyBsb3MgY2Fzb3MgZWwgZXJyb3IgbmVnYXRpdm8gdGllbmUgbHVnYXIgZW4gbWFyem8geSBlbCBwb3NpdGl2byBlbiBhYnJpbC4gU2kgbWlyYW1vcyB1biBjYWxlbmRhcmlvIHZlcmVtb3MgcXVlIHRpZW5lbiBsdWdhciBlbiBsb3MgYcOxb3MgZW4gcXVlIFNlbWFuYSBTYW50YSBjYXnDsyBlbiBtYXJ6by4KClNpIHJlcGV0aW1vcyBlc3RlIGFuw6FsaXNpcyBwYXJhIGxhIHNlcmllIGRlIFBhc2FqZXJvcyBwb3IgZMOtYSBsYWJvcmFibGUsIGxvcyByZXN1bHRhZG9zIHNvbiBiaWVuIGRpZmVyZW50ZXMgKHbDqWFzZSBmaWd1cmEgMi42KS4gQWhvcmEgc29sbyBzZSBkZXRlY3RhbiBkb3MgdmFsb3JlcyBleHRyZW1vcyBlbiBkaWNpZW1icmUgZGUgMjAwMCB5IDIwMDYuIFRhbWJpw6luIGRlc3RhY2EgZWwgZXJyb3IgZGUgZGljaWVtYnJlIGRlIDIwMTcuIExvcyBlcnJvcmVzIGVuIGRpY2llbWJyZSBzZSBkYW4gY3VhbmRvIE5hdmlkYWQgY2FlIGVuIGx1bmVzLCBkZSBmb3JtYSBxdWUgbGEgY2HDrWRhIGVuIGVsIHRyYW5zcG9ydGUgdXJiYW5vIGRlYmlkYSBhIGxhIG5vY2hlYnVlbmEgY29pbmNpZGUgY29uIGxhIGRlIGN1YWxxdWllciBkb21pbmdvLiBBc8OtLCBlc3RvcyBtZXNlcyBkZSBkaWNpZW1icmUgcHJlc2VudGFuIG3DoXMgdHJhbnNwb3J0ZSB1cmJhbm8gcXVlIGxvcyBtZXNlcyBkZSBkaWNpZW1icmUgZG9uZGUgbGEgbm9jaGVidWVuYSBjYWUgZW50cmUgc2VtYW5hLiAKCmBgYHtyfQpQYXNhamVyb3NTdGwgPC0gc3RsKFBhc2FqZXJvc0RMWywxXSwgcy53aW5kb3cgPSAicGVyaW9kaWMiLCByb2J1c3QgPSBUUlVFKQoKZXJyb3IgPC0gcmVtYWluZGVyKFBhc2FqZXJvc1N0bCkKc2RlcnJvciA8LSBzZChlcnJvcikKCmF1dG9wbG90KGVycm9yLAogICAgICAgICB4bGFiID0gIiIsCiAgICAgICAgIHlsYWIgPSAiRXJyb3IiLAogICAgICAgICBtYWluID0gIkZpZ3VyYSAyLjYuIEVycm9yICsgSW50ZXJ2ZW5jacOzbiIsCiAgICAgICAgIGNvbG91ciA9ICJkYXJrYmx1ZSIpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSBjKDMsIDIsIC0yLCAtMykqc2RlcnJvciwgCiAgICAgICAgICAgICBjb2xvdXIgPSBjKCJyZWQiLCAiZ3JlZW4iLCAiZ3JlZW4iLCAicmVkIiksCiAgICAgICAgICAgICBsdHkgPSAyKSArIAogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgxOTk2LCAyMDE5LCA0KSkKYGBgCgpQYXJhIGxhIGlkZW50aWZpY2FjacOzbiBkZSBsb3MgdmFsb3JlcyBleHRyZW1vcyBzZSBoYSBoZWNobyB1c28gZGUgbGFzIGZ1bmNpb25lcyBgZWFzdGVyYCBkZWwgcGFxdWV0ZSBgZm9yZWNhc3RgIHkgYGRheU9mV2Vla2AgZGVsIHBhcXVldGUgYHRpbWVEYXRlYC4KClwKCiMjIENvbmNsdXNpw7NuIAoKTGEgc2VyaWUgZGUgcGFzYWplcm9zIGVuIHRyYW5zcG9ydGUgdXJiYW5vIG11ZXN0cmEgdW5hIHRlbmRlbmNpYSBjcmVjaWVudGUgc29sbyBpbnRlcnJ1bXBpZGEgZW50cmUgMjAwOCB5IDIwMTMgZGViaWRvIGEgbGEgcmVjaWVudGUgY3Jpc2lzIGVjb27Ds21pY2EuCgpMb3MgcHJpbmNpcGFsZXMgZGV0ZXJtaW5hbnRlcyBkZSBsYSBlc3RhY2lvbmFsaWRhZCBkZSBsYSBzZXJpZSBQYXNhamVyb3Mgc29uIGxvcyBncmFuZGVzIHBlcmlvZG9zIHZhY2FjaW9uYWxlcyBlbiBFc3Bhw7FhIChTZW1hbmEgU2FudGEgeSB2ZXJhbm8pIHkgZWwgbsO6bWVybyBkZSBkw61hcyBsYWJvcmFsZXMgZGVsIG1lcy4gU2luIGVtYmFyZ28sIGVuIGxhIHNlcmllIFBhc2FqZXJvcyBjb3JyZWdpZGEgcG9yIGTDrWFzIGxhYm9yYWJsZXMsIGxhIGNvbXBvbmVudGUgZXN0YWNpb25hbCBzZSBoYSBzdWF2aXphZG8geSBwcsOhY3RpY2FtZW50ZSBxdWVkYSBkZXRlcm1pbmFkYSBwb3IgbGFzIHZhY2FjaW9uZXMuCgpMYSBpbnRlcnZlbmNpw7NuIHRpZW5lIGx1Z2FyIGVuIGxvcyBtZXNlcyBkZSBtYXJ6byB5IGFicmlsIGRlYmlkbyBhbCBjYXLDoWN0ZXIgbcOzdmlsIGRlIGxhIFNlbWFuYSBTYW50YSwgeSBlbiBkaWNpZW1icmUgY3VhbmRvIGVsIGTDrWEgZGUgTmF2aWRhZCBjYWUgZW4gbHVuZXMgZGUgZm9ybWEgcXVlIGxhIGNhw61kYSBkZSBwYXNhamVyb3MgZGUgbm9jaGVidWVuYSBzZSBzb2xhcGEgY29uIGxhIGRlIGN1YWxxdWllciBkb21pbmdvLgoKXApcCgojIFVuIHByZWRpY2Npw7NuIHLDoXBpZGEgeSBzZW5jaWxsYQoKRW4gbG9zIHNpZ3VpZW50ZXMgZXDDrWdyYWZlcyBhcGxpY2FyZW1vcyB0w6ljbmljYXMgZGUgcHJlZGljY2nDs24gY3JlY2llbnRlcyBlbiBjb21wbGVqaWRhZCBjb25jZXB0dWFsIHkgY29tcHV0YWNpb25hbCwgeSBxdWUgcmVxdWVyaXLDoW4gZGUgbcOhcyBoaXDDs3Rlc2lzIHBhcmEgc3UgY29ycmVjdGEgYXBsaWNhY2nDs24uIEF1bnF1ZSBhY3R1YWxtZW50ZSBtw6FzIGNvbXBsZWppZGFkIG5vIHNpZW1wcmUgaW1wbGljYSBtw6FzIHJlY3Vyc29zICh0ZW1wb3JhbGVzLCBodW1hbm9zLCBpbmZvcm3DoXRpY29zKSwgY2FiZSBwcmVndW50YXJzZSBzaSB2YWxlIGxhIHBlbmEuIEFzw60sIG3DoXMgcG9yIHVuYSBjdWVzdGnDs24gdGXDs3JpY2EgcXVlIHByw6FjdGljYSwgdmVhbW9zIGN1YWwgc2Vyw61hIGxhIGNhbGlkYWQgZGUgbGFzIHByZWRpY2Npb25lcyBzaSBhcGxpY2Ftb3MgdW5hIG1ldG9kb2xvZ8OtYSBzZW5jaWxsYSwgZW4gZXN0ZSBjYXNvIGVsIG3DqXRvZG8gaW5nZW51byBjb24gZXN0YWNpb25hbGlkYWQuCgpgYGB7ciwgZWNobyA9IEZBTFNFfQpQYXNhamVyb3NTbmFpdmUgPC0gc25haXZlKFBhc2FqZXJvcywgaCA9IDYwKQpgYGAKCkxvcyBpbmRpY2Fkb3JlcyBkZSBjYWxpZGFkIGRlIGFqdXN0ZSAocHJlZGljY2nDs24gaW50cmEtbXVlc3RyYWwgYSB1biBwZXJpb2RvIHZpc3RhKSBpbmRpY2FuIHF1ZSByZXBldGlyIGxhIMO6bHRpbWEgb2JzZXJ2YWNpw7NuIGRlbCBtaXNtbyBtZXMgcHVlZGUgc2VyIHN1ZmljaWVudGUgcGFyYSBvYnRlbmVyIHVuYSBidWVuYSBwcmVkaWNjacOzbiBhIGNvcnRvIHBsYXpvLiBFbiBtZWRpYSBlbCBlcnJvciBlcyBkZSBgciByb3VuZChhY2N1cmFjeShQYXNhamVyb3NTbmFpdmUpWzJdLCAxKWAgbWlsbG9uZXMgZGUgcGFzYWplcm9zIChSTVNFKSwgYXByb3hpbWFkYW1lbnRlIHVuIGByIHJvdW5kKGFjY3VyYWN5KFBhc2FqZXJvc1NuYWl2ZSlbNV0sIDEpYCUuIEEgbGFyZ28gcGxhem8sIGxhcyBwcmVkaWNjaW9uZXMgcHVlZGVuIHBlcmRlciBjYWxpZGFkIHLDoXBpZGFtZW50ZSBwdWVzdG8gcXVlIG5vIGNhcHR1cmFuIG5pbmfDum4gdGlwbyBkZSB0ZW5kZW5jaWEuIExhIGZpZ3VyYSAzLjEgbXVlc3RyYSBjb21vIGxhIHByZWRpY2Npw7NuIGRlbCBuw7ptZXJvIGRlIHBhc2FqZXJvcyBwYXJhIGxvcyBhw7FvcyAyMDIwIGEgMjAyNCBzZSBtYW50aWVuZSBlc3RhY2lvbmFyaWEgeSBubyByZWZsZWphIGxhIHRlbmRlbmNpYSBjcmVjaWVudGUgb2JzZXJ2YWRhIGRlc2RlIDIwMTQuCgpgYGB7cn0KUGFzYWplcm9zU25haXZlIDwtIHNuYWl2ZShQYXNhamVyb3MsIGggPSA2MCkKYWNjdXJhY3koUGFzYWplcm9zU25haXZlKQphdXRvcGxvdChQYXNhamVyb3NTbmFpdmUsIAogICAgICAgICBQSSA9IEZBTFNFLAogICAgICAgICB4bGFiID0gIiIsCiAgICAgICAgIHlsYWIgPSAiTWlsbG9uZXMgZGUgcGFzYWplcm9zIiwKICAgICAgICAgbWFpbiA9ICJGaWd1cmEgMy4xLiBQYXNhamVyb3MgZW4gdHJhbnNwb3J0ZSB1cmJhbm8geSBwcmVkaWNjacOzbi5cbk3DqXRvZG8gaW5nZW51byBjb24gZXN0YWNpb25hbGlkYWQiKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcz0gc2VxKDE5OTYsIDIwMjQsIDIpKQpgYGAKCkVzdGUgc2Vyw6EgbnVlc3RybyBwdW50byBkZSByZWZlcmVuY2lhLiBDYWJlIGVzcGVyYXIgcXVlIGVuIGxvcyBzaWd1aWVudGVzIGVww61ncmFmZXMsIGRvbmRlIGFwbGljYXJlbW9zIHTDqWNuaWNhcyBkZSBBbGlzYWRvIGV4cG9uZW5jaWFsIHkgbW9kZWxvcyBBcmltYSwgc2Ugb2JzZXJ2ZSB1biBpbmNyZW1lbnRvIHNpZ25pZmljYXRpdm8gZW4gbGEgY2FsaWRhZCBkZWwgYWp1c3RlLgoKKipOb3RhKio6IGxhIENvdmlkLTE5IGhhIHN1cHVlc3RvIHVuIF9zaG9ja18gZGUgdW5hIG1hZ25pdHVkIGluZXNwZXJhZGEgZW4gdG9kb3MgbG9zIGFzcGVjdG9zIGRlIGxhIHNvY2llZGFkIGVzcGHDsW9sYSB5LCBlbiBjb25jcmV0bywgZW4gbG9zIGjDoWJpdG9zIGRlIHRyYW5zcG9ydGUgdXJiYW5vLiBFcyBwb3IgZWxsbyBxdWUgdG9kYXMgbGFzIHByZWRpY2Npb25lcyBxdWUgYXBhcmVjZW4gZW4gZXN0ZSBlamVtcGxvIGRlIGFwbGljYWNpw7NuIHNvYnJlLWVzdGltYXLDoW4gZW5vcm1lbWVudGUgbGFzIGNpZnJhcyBkZSB0cmFuc3BvcnRlIHJlYWxlcy4gQ3VhbHF1aWVyIG3DqXRvZG8gZGUgcHJlZGljY2nDs24gYXN1bWUgcXVlIGxhcyBjb25kaWNpb25lcyBkZWwgZW50b3JubyBlbiBxdWUgc2UgYXBsaWNhIG5vIHZhbiBhIGNhbWJpYXIgZW4gZWwgZnV0dXJvLgoKClwKXAoKIyBBbGlzYWRvIGV4cG9uZW5jaWFsCgpFbiBwcmltZXIgbHVnYXIgYW5hbGl6YXJlbW9zIGxhIGNhcGFjaWRhZCBwcmVkaWN0aXZhIGRlIGxvcyBtw6l0b2RvcyBkZSBBbGlzYWRvIGV4cG9uZW5jaWFsIHNvYnJlIGxhIHNlcmllIFBhc2FqZXJvcy4gQ29uIGVzdGUgZmluLCBhanVzdGFyZW1vcyBlbCBtZWpvciBtb2RlbG8gZGUgYWxpc2FkbyB5IGVzdGltYXJlbW9zIGxvcyBjcml0ZXJpb3MgZGUgY2FsaWRhZCBwYXJhIGVsIGFqdXN0ZSB5IGxhcyBwcmVkaWNjaW9uZXMgZXh0cmEtbXVlc3RyYWxlcyBzZWfDum4gZWwgaG9yaXpvbnRlIHRlbXBvcmFsLiBQb3N0ZXJpb3JtZW50ZSB2ZXJlbW9zIHNpIGVzIHBvc2libGUgbWVqb3JhciBsYXMgcHJlZGljY2lvbmVzIGFuYWxpemFuZG8gbGEgdHJhbnNmb3JtYWNpw7NuIGxvZ2Fyw610bWljYSBkZSBQYXNhamVyb3MgeSBhbmFsaXphbmRvIGxhIHNlcmllIFBhc2FqZXJvcyBwb3IgZMOtYSBsYWJvcmFibGUuCgpcCgojIyBBbsOhbGlzaXMgZGUgbGEgc2VyaWUgUGFzYWplcm9zCgpcCgojIyMgRXN0aW1hY2nDs24gZSBpbnRlcnByZXRhY2nDs24gey19CgpFbCBtb2RlbG8gw7NwdGltbywgZXN0aW1hZG8gY29uIGxhIGZ1bmNpw7NuIGBldHNgIHNpbiBpbXBvbmVyIG5pbmd1bmEgcmVzdHJpY2Npw7NuLCBlcyBFVFMoTSxBZCxBKTogcGVuZGllbnRlIGFkaXRpdmEgY29uIGFtb3J0aWd1YW1pZW50bywgZXN0YWNpb25hbGlkYWQgYWRpdGl2YSB5IHJlc2lkdW8gbXVsdGlwbGljYXRpdm8uCiAgJCR5X3t0KzF9ID0gKGxfdCArIFxwaGkgYl90ICsgc197dCsxLW19KSBcY2RvdCAoMSArIFx2YXJlcHNpbG9uX3t0KzF9KS4kJApgYGB7cn0KUGFzYWplcm9zRXRzIDwtIGV0cyhQYXNhamVyb3MsIG1vZGVsID0gIlpaWiIpCnN1bW1hcnkoUGFzYWplcm9zRXRzKSAKYGBgCgpFbCB2YWxvciBkZSAkXHBoaT0kIGByIHJvdW5kKGNvZWYoUGFzYWplcm9zRXRzKVs0XSwgMilgIGluZGljYSBxdWUgbGEgaW5jbHVzacOzbiBkZSBhbW9ydGlndWFtaWVudG8gZW4gZWwgbW9kZWxvIG1lam9yYSBzZW5zaWJsZW1lbnRlIHN1IGFqdXN0ZSBhIGxvcyBkYXRvcy4gUG9yIG90cm8gbGFkbywgJFxnYW1tYSQgZXMgdMOpY25pY2FtZW50ZSBjZXJvLCBpbmRpY2FuZG8gcXVlIGVsIGVmZWN0byBlc3RhY2lvbmFsIHNlIG1hbnRpZW5lIGNvbnN0YW50ZSBlbiBlbCB0aWVtcG8uIFNpbiBlbWJhcmdvLCBlbCB2YWxvciBkZSAkXGJldGEkLCByZWR1Y2lkbyBwZXJvIG5vIG51bG8sIGluZGljYSBxdWUgbGEgcGVuZGllbnRlIGNhbWJpYSBlbiBlbCB0aWVtcG8gZGUgZm9ybWEgbXV5IGxlbnRhLgoKTGEgY2FsaWRhZCBkZWwgYWp1c3RlIGVzIGJhc3RhbnRlIGJ1ZW5hLCBjb24gdW4gZXJyb3IgcG9yY2VudHVhbCBkZWwgYHIgcm91bmQoYWNjdXJhY3koUGFzYWplcm9zRXRzKVs1XSwgMSlgJSBvIHVuIGVycm9yIGRlIGByIHJvdW5kKGFjY3VyYWN5KFBhc2FqZXJvc0V0cylbMl0sIDEpYCBtaWxsb25lcyBkZSBwYXNhamVyb3MgKFJNU0UpLiBMYSBhcGxpY2FjacOzbiBkZWwgbcOpdG9kbyBkZSBhbGlzYWRvIHN1cG9uZSB1bmEgcmVkdWNjacOzbiBkZSB1biBwdW50byBlbiBlbCBlcnJvciBwb3JjZW50dWFsIHJlc3BlY3RvIGRlbCBtw6l0b2RvIGluZ2VudW8sIG8gdW5hIHJlZHVjY2nDs24gZGUgMy41IG1pbGxvbmVzIGRlIHBhc2FqZXJvcy4gRXMgZGVjaXIsIGVsIG1vZGVsbyBkZSBhbGlzYWRvIGV4cG9uZW5jaWFsIHN1cG9uZSB1bmEgbWVqb3JhIGVuIGxhIGNhbGlkYWQgZGVsIGFqdXN0ZSBkZWwgYHIgMTAwIC0gcm91bmQoMTAwKmFjY3VyYWN5KFBhc2FqZXJvc0V0cylbNl0sIDApYCUgcmVzcGVjdG8gZGVsIG3DqXRvZG8gaW5nZW51byBjb24gZXN0YWNpb25hbGlkYWQgdmlzdG8gZW4gZWwgZXDDrWdyYWZlIHByZXZpbyAoTUFTRSkuCgpFbCBlZmVjdG8gZXN0YWNpb25hbCwgcXVlIHJlY29yZGVtb3Mgc2UgbWFudGllbmUgY29uc3RhbnRlIGVuIGVsIHRpZW1wbywgZXMgcHLDoWN0aWNhbWVudGUgaWTDqW50aWNvIGFsIGVzdGltYWRvIGVuIGxhIGRlc2NyaXB0aXZhIHkgdmllbmUgZGV0ZXJtaW5hZG8gcG9yIGxvcyBwZXJpb2RvcyB2YWNhY2lvbmFsZXMgeSBlbCBuw7ptZXJvIGRlIGTDrWFzIGRlbCBtZXMgKHkgcG9yIGNvbnNpZ3VpZW50ZSBlbCBuw7ptZXJvIGRlIGTDrWFzIGxhYm9yYWJsZXMpLiBWw6lhc2UgbGEgZmlndXJhIDQuMS4gCgpFbiB2ZXJhbm8gKGp1bGlvIGEgc2VwdGllbWJyZSkgZWwgdXNvIGRlbCB0cmFuc3BvcnRlIHVyYmFubyBlcyBpbmZlcmlvciBhIGxhIG1lZGlhIGFudWFsLCBkZXN0YWNhbmRvIGFnb3N0byBjb24gdW4gZGVzY2Vuc28gZGUgNzIgbWlsbG9uZXMgZGUgcGFzYWplcm9zLiBBIHN1IHZleiwgb2N0dWJyZSBkZXN0YWNhIHBvciBzZXIgZWwgbWVzIGNvbiBtYXlvciBpbmNyZW1lbnRvIGVuIGVsIHZvbHVtZW4gZGUgcGFzYWplcm9zICgyNyBtaWxsb25lcykgcmVzcGVjdG8gZGUgbGEgbWVkaWEgYW51YWwuCgpgYGB7cn0KUGFzYWplcm9zRXRzRXN0IDwtIFBhc2FqZXJvc0V0cyRzdGF0ZXNbbnJvdyhQYXNhamVyb3NFdHMkc3RhdGVzKSwgMTQ6M10KbmFtZXMoUGFzYWplcm9zRXRzRXN0KSA8LSBtZXNlcwoKcm91bmQoUGFzYWplcm9zRXRzRXN0LCAyKQoKZ2dwbG90KCkgKwogIGdlb21fbGluZShhZXMoeCA9IDE6MTIsIHkgPSBQYXNhamVyb3NFdHNFc3QpLCBjb2xvdXIgPSAiZGFya2JsdWUiKSArIAogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAsIGNvbG91ciA9ICJibGFjayIsIGx0eSA9IDIpICsKICBnZ3RpdGxlKCJGaWd1cmEgNC4xLiBDb21wb25lbnRlIGVzdGFjaW9uYWwgZXN0aW1hZGEgY29uIEFsaXNhZG8gZXhwb25lbmNpYWwiKSArCiAgeGxhYigiIikgKwogIHlsYWIoIkVmZWN0byBlc3RhY2lvbmFsIikgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IDE6MTIsIAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBtZXNlcykKYGBgCgpcCgojIyMgUHJlZGljY2nDs24gey19CgpQb2RlbW9zIGFob3JhIHBlZGlyIGxvcyB2YWxvcmVzIGRlIHByZWRpY2Npw7NuIHkgc3UgaW50ZXJ2YWxvIGRlIGNvbmZpYW56YSBhbCA5NSUgcGFyYSBsb3MgcHLDs3hpbW9zIGNpbmNvIGHDsW9zLiBObyBtb3N0cmFtb3MgbG9zIHJlc3VsdGFkb3MgbnVtw6lyaWNvcywgcGVybyBzaSBncsOhZmljb3MgKGZpZ3VyYSA0LjIpLiBMYXMgcHJlZGljY2lvbmVzIG11ZXN0cmFuIHVuYSB0ZW5kZW5jaWEgY3JlY2llbnRlIGFtb3J0aWd1YWRhIHksIHBvciB0YW50bywgbm8gdGFuIGFjdXNhZGEgY29tbyBsYSBvYnNlcnZhZGEgZW4gbG9zIGHDsW9zIHByZWNlZGVudGVzLiAKICAKYGBge3J9ClBhc2FqZXJvc0V0c1ByZSA8LSBmb3JlY2FzdChQYXNhamVyb3NFdHMsIGggPSA2MCwgbGV2ZWwgPSA5NSkKYXV0b3Bsb3QoUGFzYWplcm9zRXRzUHJlLAogICAgICAgICB4bGFiID0gIiIsCiAgICAgICAgIHlsYWIgPSAiTWlsbG9uZXMgZGUgcGFzYWplcm9zIiwKICAgICAgICAgbWFpbiA9ICJGaWd1cmEgNC4yLiBQYXNhamVyb3MgKDE5OTYtMjAxOSkgeSBwcmVkaWNjacOzbiAoMjAyMC0yMDI0KS5cbk3DqXRvZG8gZGUgYWxpc2FkbyBleHBvbmVuY2lhbCIpIApgYGAKCkVuIGVsIGHDsW8gMjAyMCBzZSBlc3BlcmFuIGByIHJvdW5kKHN1bShQYXNhamVyb3NFdHNQcmUkbWVhblsxOjEyXSksIDApYCBtaWxsb25lcyBkZSBwYXNhamVyb3MsIAp1biBgciByb3VuZCgxMDAqKHN1bShQYXNhamVyb3NFdHNQcmUkbWVhblsxOjEyXSkgLSBzdW0odGFpbChQYXNhamVyb3MsIDEyKSkpL3N1bShQYXNhamVyb3NFdHNQcmUkbWVhblsxOjEyXSksIDEpYCUgbcOhcyBxdWUgZW4gMjAxOS4KClwKCiMjIyBBbsOhbGlzaXMgZGVsIGVycm9yIHstfQoKRWwgcmVzaWR1byBkZWwgbW9kZWxvIChmaWd1cmEgNC4zKSBtdWVzdHJhIHZhcmlvcyB2YWxvcmVzIHF1ZSBwdWVkZW4gc2VyIGNvbnNpZGVyYWRvcyBjb21vIGF0w61waWNvcyB5IHF1ZSBzZSBkYW4gc2llbXByZSBlbiBsb3MgbWVzZXMgZGUgbWFyem8geSBhYnJpbCBwYXJhIGxvcyBhw7FvcyBkb25kZSBsYSBTZW1hbmEgU2FudGEgcmVjYXnDsyBlbiBtYXJ6by4KCmBgYHtyfQplcnJvciA8LSByZXNpZHVhbHMoUGFzYWplcm9zRXRzKQpzZGVycm9yIDwtIHNkKGVycm9yKQoKYXV0b3Bsb3QoZXJyb3IsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICJFcnJvciIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDQuMy4gRXJyb3IgKyBJbnRlcnZlbmNpw7NuLiBNw6l0b2RvIGRlIGFsaXNhZG8iLAogICAgICAgICBjb2xvdXIgPSAiZGFya2JsdWUiKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gYygtMywgLTIsIDIgLDMpKnNkZXJyb3IsIAogICAgICAgICAgICAgY29sb3VyID0gYygicmVkIiwgImdyZWVuIiwgImdyZWVuIiwgInJlZCIpLCBsdHkgPSAyKSArIAogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgxOTk2LCAyMDE5LCAyKSkKYGBgCgpcCgojIyBPdHJhcyBhbHRlcm5hdGl2YXMgZGUgYW7DoWxpc2lzCgpFbiBsYSBkZXNjcmlwdGl2YSBzZSBoYSB2aXN0byBxdWUgbGEgc2VyaWUgZGUgcGFzYWplcm9zIHBvciBkw61hIGxhYm9yYWJsZSB0aWVuZSB1biBjb21wb3J0YW1pZW50byBtw6FzIHN1YXZlIChsYSBjb21wb25lbnRlIGVzdGFjaW9uYWwgZXJhIG3DoXMgcGxhbmEpIHkgcHJlc2VudGFiYSB1biBtZW5vciBuw7ptZXJvIGRlIHZhbG9yZXMgYXTDrXBpY29zIHF1ZSBsYSBzZXJpZSBvcmlnaW5hbCBQYXNhamVyb3MuIENhYmUgZXNwZXJhciwgcG9yIHRhbnRvLCBxdWUgZXN0YSBzZXJpZSBwcmVzZW50ZSB1biBtZWpvciBhanVzdGUgY29uIGxvcyBtw6l0b2RvcyBkZSBhbGlzYWRvIGV4cG9uZW5jaWFsIHkgb2ZyZXpjYSBtZWpvcmVzIHByZWRpY2Npb25lcy4KClBvciBvdHJvIGxhZG8sIHNpZW1wcmUgdmFsZSBsYSBwZW5hIGFuYWxpemFyIGxhIHRyYW5zZm9ybWFjacOzbiBsb2dhcsOtdG1pY2EgZGUgbGEgc2VyaWUgeSB2ZXIgc2kgb2ZyZWNlIG1lam9yZXMgcmVzdWx0YWRvcyBxdWUgbGEgc2VyaWUgb3JpZ2luYWwuIExhIHRyYW5zZm9ybWFjacOzbiBsb2dhcsOtdG1pY2EgZXMgZXNwZWNpYWxtZW50ZSBlZmljYXogcGFyYSBzZXJpZXMgbm8gbGluZWFsZXMsIGFzw60gcXVlIHBhcmEgUGFzYWplcm9zIHBvc2libGVtZW50ZSBubyBzdXBvbmdhIG5pbmfDum4gbWVqb3JhLgoKTGFzIHRyYW5zZm9ybWFjaW9uZXMgaW5kaWNhZGFzIGVuIGxvcyBkb3MgcMOhcnJhZm9zIHByZWNlZGVudGVzIHNvbiBzb2xvIGRvcyBkZSBsYXMgcG9zaWJsZXMuIFRhbWJpw6luIHNlIHB1ZGUgYW5hbGl6YXIgbGEgc2VyaWUgZGUgcGFzYWplcm9zIHBvciBkw61hIGRlbCBtZXMgbyBsYSB0cmFuc2Zvcm1hY2nDs24gw7NwdGltYSBkZSBCb3gtQ294LiBMYSBpZGVhIGVzIG5vIHF1ZWRhcnNlIGNvbiBsbyBpbm1lZGlhdG8sIGxhIHNlcmllIHRhbCBjdWFsIG5vcyBsYSBoYW4gb2ZyZWNpZG8sIHNpbm8gcHJvYmFyIG90cmFzIGFsdGVybmF0aXZhcy4gUG9yIGVqZW1wbG8sIGxhIHNlcmllIGRlIFBhc2FqZXJvcyBlcyBlbCBhZ3JlZ2FkbyBkZWwgbsO6bWVybyBkZSBwYXNhamVyb3MgcXVlIHZpYWphbiBlbiB0cmFuc3BvcnRlIHVyYmFubyBzZWfDum4gZWwgdGlwbyBkZSB0cmFuc3BvcnRlIChhdXRvYsO6cywgbWV0cm8sIHRyYW52w61hLi4uKS4gU2UgcG9kcsOtYSBwcm9jZWRlciBhIGFuYWxpemFyIGNhZGEgc2VyaWUgcG9yIHNlcGFyYWRvIChwYXNhamVyb3MgZW4gYXV0b2LDunMsIHBhc2FqZXJvcyBlbiBtZXRybywgZXRjLiksIHBhcmEgbHVlZ28gYWdyZWdhciBsb3MgcmVzdWx0YWRvcyB5IHZlciBzaSBlc3RlIGVuZm9xdWUgZGEgbWVqb3JlcyByZXN1bHRhZG9zIHF1ZSBlbCBhbsOhbGlzaXMgZGlyZWN0byBkZSBsYSBzZXJpZSBhZ3JlZ2FkYSBQYXNhamVyb3MuCgpFbiBlc3RlIGVww61ncmFmZSBzZSBhbmFsaXphcsOhbiBsYXMgZG9zIHByaW1lcmFzIHRyYW5zZm9ybWFjaW9uZXMgaW5kaWNhZGFzLCBsYSB0cmFuc2Zvcm1hY2nDs24gbG9nYXLDrXRtaWNhIHkgbG9zIHBhc2FqZXJvcyBwb3IgZMOtYSBsYWJvcmFibGUuIEVsIG9iamV0aXZvIGVzIHZlciBzaSBlcyBwb3NpYmxlIG1lam9yYXIgbGEgY2FsaWRhZCBkZSBsYXMgcHJlZGljY2lvbmVzIG9idGVuaWRhcyBwYXJhIFBhc2FqZXJvcy4gU2UgdXNhcsOhIGNvbW8gY3JpdGVyaW8gZGUgYm9uZGFkIGVsIGVycm9yIGRlIGxhcyBwcmVkaWNjaW9uZXMgZXh0cmEtbXVlc3RyYWxlcyBzZWfDum4gZWwgaG9yaXpvbnRlIHRlbXBvcmFsLCBvYnRlbmlkbyBjb24gZWwgcHJvY2VkaW1pZW50byBfb3JpZ2VuIGRlIHByZWRpY2Npw7NuIG3Ds3ZpbF8uIEFzdW1pcmVtb3MgcXVlIHNvbiBuZWNlc2FyaW9zIDEwIGHDsW9zIHBhcmEgb2J0ZW5lciB1bmEgYnVlbmEgZXN0aW1hY2nDs24gZGVsIG1vZGVsbyB5IGVsIGhvcml6b250ZSB0ZW1wb3JhbCBzZSBmaWphcsOhIGVuIDEyIG1lc2VzICgkayA9IDEyMCwgaCA9IDEyJCkuIFByZXZpYW1lbnRlLCBoYXkgcXVlIGlkZW50aWZpY2FyIGVsIG1lam9yIG1vZGVsbyBwYXJhIGxhcyBzZXJpZXMgdHJhbnNmb3JtYWRhcy4KCmBgYHtyfQpldHMoUGFzYWplcm9zREwpJG1ldGhvZApldHMoUGFzYWplcm9zLCBsYW1iZGEgPSAwKSRtZXRob2QKYGBgCgpcCgpgYGB7cn0KayA8LSAxMjAgICAgICAgICAgICAgICAgIApoIDwtIDEyICAgICAgICAgICAgICAgICAgClRUIDwtIGxlbmd0aChQYXNhamVyb3MpICAKcyA8LSBUVCAtIGsgLSBoICAgICAgICAgIAoKbWFwZUFsaXNhZG9QYXMgPC0gbWF0cml4KE5BLCBzICsgMSwgaCkKbWFwZUFsaXNhZG9sUGFzIDwtIG1hdHJpeChOQSwgcyArIDEsIGgpCm1hcGVBbGlzYWRvUGFzREwgPC0gbWF0cml4KE5BLCBzICsgMSwgaCkKCmZvciAoaSBpbiAwOnMpIHsKICB0cmFpbi5zZXQgPC0gc3Vic2V0KFBhc2FqZXJvcywgc3RhcnQgPSBpICsgMSwgZW5kID0gaSArIGspCiAgdGVzdC5zZXQgPC0gIHN1YnNldChQYXNhamVyb3MsIHN0YXJ0ID0gaSArIGsgKyAxLCBlbmQgPSBpICsgayArIGgpCiAgCiAgdHJhaW5ETC5zZXQgPC0gc3Vic2V0KFBhc2FqZXJvc0RMLCBzdGFydCA9IGkgKyAxLCBlbmQgPSBpICsgaykKICB0ZXN0REwuc2V0IDwtICBzdWJzZXQoUGFzYWplcm9zREwsIHN0YXJ0ID0gaSArIGsgKyAxLCBlbmQgPSBpICsgayArIGgpCiAgCiAgZml0IDwtIGV0cyh0cmFpbi5zZXQsIG1vZGVsID0gIk1BQSIsIGRhbXBlZCA9IFRSVUUpCiAgZmNhc3QgPC0gZm9yZWNhc3QoZml0LCBoID0gaCkKICBtYXBlQWxpc2Fkb1Bhc1tpICsgMSxdIDwtIDEwMCphYnModGVzdC5zZXQgLSBmY2FzdCRtZWFuKS90ZXN0LnNldAogIAogIGZpdCA8LSBldHModHJhaW4uc2V0LCBtb2RlbCA9ICJBQUEiLCBkYW1wZWQgPSBUUlVFLCBsYW1iZGEgPSAwKQogIGZjYXN0IDwtIGZvcmVjYXN0KGZpdCwgaCA9IGgsIGJpYXNhZGogPSBUUlVFKQogIG1hcGVBbGlzYWRvbFBhc1tpICsgMSxdIDwtIDEwMCphYnModGVzdC5zZXQgLSBmY2FzdCRtZWFuKS90ZXN0LnNldAogIAogIGZpdCA8LSBldHModHJhaW5ETC5zZXQsIG1vZGVsID0gIk1BQSIsIGRhbXBlZCA9IFRSVUUpCiAgZmNhc3QgPC0gZm9yZWNhc3QoZml0LCBoID0gaCkKICBtYXBlQWxpc2Fkb1Bhc0RMW2kgKyAxLF0gPC0gMTAwKmFicyh0ZXN0REwuc2V0IC0gZmNhc3QkbWVhbikvdGVzdERMLnNldAp9CgplcnJvckFsaXNhZG9QYXMgPC0gY29sTWVhbnMobWFwZUFsaXNhZG9QYXMpCmVycm9yQWxpc2Fkb1Bhc0RMIDwtIGNvbE1lYW5zKG1hcGVBbGlzYWRvUGFzREwpCmVycm9yQWxpc2Fkb2xQYXMgPC0gY29sTWVhbnMobWFwZUFsaXNhZG9sUGFzKQoKZGF0b3MgPC0gY2JpbmQoMToxMiwgZXJyb3JBbGlzYWRvUGFzLCBlcnJvckFsaXNhZG9QYXNETCwgZXJyb3JBbGlzYWRvbFBhcykKY29sbmFtZXMoZGF0b3MpIDwtIGMoIkhvcml6b250ZSIsICJQYXNhamVyb3MiLCAKICAgICAgICAgICAgICAgICAgICAgIlBhc2FqZXJvcyBwb3IgZMOtYSBsYWJvcmFibGUiLCAiUGFzYWplcm9zIChsb2cpIikKCmthYmxlKGRhdG9zLCAKICAgICAgZGlnaXRzID0gMiwKICAgICAgY2FwdGlvbiA9ICJNQVBFIHNlZ8O6biBzZXJpZSB5IGhvcml6b250ZSB0ZW1wb3JhbCIpCgpkYXRvcyA8LSBkYXRhLmZyYW1lKAogIGZhY3RvciA9IGMocmVwKCJQYXNhamVyb3MiLCAxMiksIAogICAgICAgICAgICAgcmVwKCJQYXNhamVyb3MgcG9yIGTDrWEgbGFib3JhYmxlIiwgMTIpLCAKICAgICAgICAgICAgIHJlcCgiUGFzYWplcm9zIChsb2cpIiwgMTIpKSwKICB4ID0gYygxOjEyLCAxOjEyLCAxOjEyKSwKICB5ID0gYyhlcnJvckFsaXNhZG9QYXMsIGVycm9yQWxpc2Fkb1Bhc0RMLCBlcnJvckFsaXNhZG9sUGFzKQopCgpnZ3Bsb3QoZGF0b3MsIGFlcyh4ID0geCwgeSA9IHksICBjb2xvdXI9IGZhY3RvcikpICsgCiAgZ2VvbV9saW5lKCkgKwogIGdndGl0bGUoIkZpZ3VyYSA0LjQuIEVycm9yIGRlIHByZWRpY2Npw7NuIChNQVBFKSBzZWfDum4gaG9yaXpvbnRlIHRlbXBvcmFsIHkgZW5mb3F1ZSIpICsKICB4bGFiKCJIb3Jpem9udGUgdGVtcG9yYWwgZGUgcHJlZGljY2nDs24iKSArCiAgeWxhYigiJSIpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzPSAxOjEyKSArCiAgc2NhbGVfeV9jb250aW51b3VzKGJyZWFrcz0gc2VxKDIuNiwgNCwgLjIpKSArCiAgZ3VpZGVzKGNvbG91ciA9IGd1aWRlX2xlZ2VuZCh0aXRsZSA9ICJNw6l0b2RvcyIpKSArIAogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbj1jKDAuMDIsMC45OCksIGxlZ2VuZC5qdXN0aWZpY2F0aW9uPWMoMCwxKSkKYGBgCgpBbnRlcyBkZSBwYXNhciBhbCBhbsOhbGlzaXMgZGUgbG9zIHJlc3VsdGFkb3MsIGluZGljYXIgcXVlIGVuIGxhcyBwcmVkaWNjaW9uZXMgc29icmUgZWwgbG9nYXJpdG1vIHNlIGhhIHBlZGlkbyBjb3JyZWNjacOzbiBwb3Igc2VzZ28gKGBiaWFzYWRqID0gVFJVRWApLCB5IHF1ZSBhbCB0cmFiYWphciBjb24gZXJyb3JlcyBwb3JjZW50dWFsZXMgbm8gZXMgbmVjZXNhcmlvIHBhc2FyIGxhIHByZWRpY2Npw7NuIGRlIHBhc2FqZXJvcyBwb3IgZMOtYSBsYWJvcmFibGUgYSBwcmVkaWNjacOzbiBkZSBwYXNhamVyb3MuCgpFbCB0b2RvcyBsb3MgY2Fzb3MgZWwgZXJyb3IgYXVtZW50YSBjb24gZWwgaG9yaXpvbnRlIHRlbXBvcmFsIGRlIHByZWRpY2Npw7NuLCBkZSBmb3JtYSBxdWUgbGFzIHByZWRpY2Npb25lcyBhIGRvY2UgbWVzZXMgdmlzdGEgdGllbmVuIHVuIGVycm9yIHVuIHB1bnRvIHBvcmNlbnR1YWwgc3VwZXJpb3IgYSBsYXMgcHJlZGljY2lvbmVzIGEgdW4gbWVzIHZpc3RhLiAoVsOpYXNlIHRhYmxhIDIpCgpQb3Igb3RybyBsYWRvLCBjb24gaW5kZXBlbmRlbmNpYSBkZWwgaG9yaXpvbnRlIHRlbXBvcmFsLCBsYXMgcHJlZGljY2lvbmVzIHJlYWxpemFkYXMgc29icmUgbGEgc2VyaWUgb3JpZ2luYWwgUGFzYWplcm9zIHNvbiBsYXMgbcOhcyBhanVzdGFkYXMsIHNlZ3VpZGFzIGRlIGxhcyBwcmVkaWNjaW9uZXMgcmVhbGl6YWRhcyBzb2JyZSBzdSB0cmFuc2Zvcm1hY2nDs24gbG9nYXLDrXRtaWNhLiBFbiBjb250cmEgZGUgbG8gZXNwZXJhZG8sIGxhIHByZWRpY2Npw7NuIGEgcGFydGlyIGRlIGxhIHNlcmllIGRlIHBhc2FqZXJvcyBwb3IgZMOtYSBsYWJvcmFibGUgZXMgbGEgcXVlIG1heW9yIGVycm9yIHBvcmNlbnR1YWwgcHJlc2VudGEsIGVuIG1lZGlhIDAuMjUlIHB1bnRvcyBwb3IgZW5jaW1hIGRlbCBlcnJvciBkZSBwcmVkaWNjacOzbiBkZSBQYXNhamVyb3MuIChWw6lhc2UgZmlndXJhIDQuNC4pCgpcCgojIyBDb25jbHVzacOzbgoKTG9zIG1vZGVsb3MgZGUgQWxpc2FkbyBleHBvbmVuY2lhbCByZXN1bHRhbiBleGNlbGVudGVzIHBhcmEgcHJlZGVjaXIgbGEgc2VyaWUgUGFzYWplcm9zLiBFbCBlcnJvciBkZSBhanVzdGUsIGRlbCBgciByb3VuZChhY2N1cmFjeShQYXNhamVyb3NFdHMpWzVdLCAxKWAlLCBlcyB1biBwdW50byBpbmZlcmlvciBhbCBlcnJvciBvYnRlbmlkbyBjb24gZWwgbcOpdG9kbyBpbmdlbnVvIGNvbiBlc3RhY2lvbmFsaWRhZC4gQWRlbcOhcywgZW4gbGFzIHByZWRpY2Npb25lcyBleHRyYS1tdWVzdHJhbGVzIGEgMTIgbWVzZXMgdmlzdGEgZWwgZXJyb3IgcG9yY2VudHVhbCBzaWd1ZSBtYW50ZW5pw6luZG9zZSBiYWpvLCBubyBzdXBlcmFuZG8gZWwgNCUuCgpOaW5nw7puIGVuZm9xdWUgYWx0ZXJuYXRpdm8gcHJvYmFkbyBwYXJhIGxhIHByZWRpY2Npw7NuIGRlbCBuw7ptZXJvIGRlIHBhc2FqZXJvcyBwb3IgbcOpdG9kb3MgZGUgYWxpc2FkbyBoYSBkYWRvIG1lam9yZXMgcmVzdWx0YWRvcyBxdWUgZWwgYW7DoWxpc2lzIGRpcmVjdG8gZGUgbGEgc2VyaWUuCgpcClwKCgojIE1vZGVsb3MgQXJpbWEKCkxhIGFwbGljYWNpw7NuIGRlIGxhIG1ldG9kb2xvZ8OtYSBBcmltYSBhIGxhIHNlcmllIFBhc2FqZXJvcyBpbXBsaWNhIHVuIG5vdGFibGUgaW5jcmVtZW50byBlbiBsYSBjb21wbGVqaWRhZCBkZSBsb3MgbW9kZWxvcyB5IGVuIGxvcyByZXF1ZXJpbWllbnRvcyBlc3RhZMOtc3RpY29zLCBxdWUgc29sbyBlc3TDoSBqdXN0aWZpY2FkYSBzaSBzZSByZWR1Y2UgYWRlY3VhZGFtZW50ZSBlbCBlcnJvciBkZSBwcmVkaWNjacOzbi4KCkVuIGxvcyBlcMOtZ3JhZmVzIHByZXZpb3MgaGVtb3MgdmlzdG8gcXVlIGxhIHNlcmllIFBhc2FqZXJvcyB0aWVuZSB1bmEgY29tcG9uZW50ZSBkZSBpbnRlcnZlbmNpw7NuIG11eSBhY3VzYWRhLCBkZXN0YWNhbmRvIGVsIG7Dum1lcm8gZGUgZMOtYXMgZGVsIG1lcywgZWwgZGUgZMOtYXMgbGFib3JhYmxlcywgZWwgZmVjaGFkbyBkZSBsYSBTZW1hbmEgU2FudGEgeSBxdWUgZWwgZMOtYSBkZSBOYXZpZGFkIGNhaWdhIGVuIGx1bmVzLiBDYWJlIGVzcGVyYSwgcG9yIHRhbnRvLCBxdWUgbGEgaW5jb3Jwb3JhY2nDs24gZGUgZXN0b3MgZWZlY3RvcyBjYWxlbmRhcmlvIGVuIGVsIGFuw6FsaXNpcyBkZSBsYSBzZXJpZSBpbmNyZW1lbnRlIHNpZ25pZmljYXRpdmFtZW50ZSBsYSBjYWxpZGFkIGRlIGFqdXN0ZSB5IGxhIGNhcGFjaWRhZCBwcmVkaWN0aXZhLiBWZWFtb3Mgc2kgZXMgYXPDrS4KClwKCiMjIFRyYW5zZm9ybWFjacOzbiBkZSBsYSBzZXJpZSBQYXNhamVyb3MKClBvciB1biBsYWRvLCBlbCBhbsOhbGlzaXMgcG9yIEFsaXNhZG8gZXhwb25lbmNpYWwgaGEgcHVlc3RvIGRlIHJlbGlldmUgZWwgY2Fyw6FjdGVyIGxpbmVhbCBkZSBQYXNhamVyb3MgeSBsYSBwb2NhIGVmZWN0aXZpZGFkIHF1ZSB0aWVuZSB1c2FyIGxhIHRyYW5zZm9ybWFjacOzbiBsb2dhcsOtdG1pY2EgcGFyYSBtZWpvcmFyIGxhIGNhbGlkYWQgZGUgbGFzIHByZWRpY2Npb25lcy4KClBvciBvdHJvIGxhZG8sIHRyYXMgdW4gYW7DoWxpc2lzIHByZWxpbWluYXIgcG9yIG1vZGVsb3MgQXJpbWEgaGVtb3MgdmlzdG8gcXVlIGxhIHRyYW5zZm9ybWFjacOzbiBsb2dhcsOtdG1pY2EgbWVqb3JhYmEgbGEgaWRlbnRpZmljYWNpw7NuIGRlbCBtb2RlbG8geSBmYWNpbGl0YWJhIHN1IGludGVycHJldGFjacOzbi4KCkFudGUgZXN0YSBzaXR1YWNpw7NuLCBoZW1vcyBvcHRhZG8gcG9yIGlkZW50aWZpY2FyIGxhIHRyYW5zZm9ybWFjacOzbiBsb2dhcsOtdG1pY2EgZGUgUGFzYWplcm9zLgoKTGFzIEZBQyBkZWwgbG9nYXJpdG1vIGRlIGxhIHNlcmllIHkgYWxndW5hcyBkZSBzdXMgZGlmZXJlbmNpYWNpb25lcyAoZmlndXJhIDUuMSkgaW5kaWNhbiBxdWUgZXMgbmVjZXNhcmlhIGxhIGRvYmxlIGRpZmVyZW5jaWFjacOzbiByZWd1bGFyIHkgZXN0YWNpb25hbCBwYXJhIGFsY2FuemFyIGxhcyBoaXDDs3Rlc2lzIGRlIGVzdGFjaW9uYXJpZWRhZCB5IGVyZ29kaWNpZGFkOiAkXGxvZyhQYXNhamVyb3MpIFxzaW0gSSgxKUlfezEyfSgxKSQuIExvcyByZXN1bHRhZG9zIG9mcmVjaWRvcyBwb3IgbGFzIGZ1bmNpb25lcyBgbmRpZmZzYCB5IGBuc2RpZmZzYCBhcG95YW4gZXN0YSBjb25jbHVzacOzbi4KCmBgYHtyLCBmaWcuaGVpZ2h0ID0gNX0KZ3JpZC5hcnJhbmdlKAogIGdnQWNmKGxvZyhQYXNhamVyb3MpLCBsYWcgPSA3MiwgbWFpbiA9ICJGaWd1cmEgNS4xLiBGQUMgcGFyYSBQYXNhamVyb3MgKGxvZykiLCAKICAgICAgICB4bGFiID0gIiIsIHlsYWIgPSBleHByZXNzaW9uKGxvZyh5W3RdKSkpLAogIGdnQWNmKGRpZmYobG9nKFBhc2FqZXJvcykpLCBsYWcgPSA3MiwgbWFpbiA9ICIiLCAKICAgICAgICB4bGFiID0gIiIsIHlsYWIgPSBleHByZXNzaW9uKG5hYmxhKmxvZyh5W3RdKSkpLAogIGdnQWNmKGRpZmYobG9nKFBhc2FqZXJvcyksIGxhZyA9IDEyKSxsYWcgPSA3MiwgbWFpbiA9ICIiLCAKICAgICAgICB4bGFiID0gIiIsIHlsYWIgPSBleHByZXNzaW9uKG5hYmxhWzEyXSpsb2coeVt0XSkpKSwKICBnZ0FjZihkaWZmKGRpZmYobG9nKFBhc2FqZXJvcyksIGxhZz0xMikpLCBsYWcgPSA3MiwgbWFpbiA9ICIiLCAKICAgICAgICB4bGFiID0gIiIsIHlsYWIgPSBleHByZXNzaW9uKG5hYmxhKm5hYmxhWzEyXSpsb2coeVt0XSkpKSwKICBucm93ID0gMgopCmBgYAoKYGBge3J9Cm5kaWZmcyhsb2coUGFzYWplcm9zKSkKbnNkaWZmcyhsb2coUGFzYWplcm9zKSkKYGBgCgpMYSBmaWd1cmEgNS4yIG11ZXN0cmEgbGEgc2VyaWUgb3JpZ2luYWwgJHlfdCQgeSBsYSBzZXJpZSB0cmFuc2Zvcm1hZGEgJFxuYWJsYSBcbmFibGFfezEyfSBcbG9nKHlfdCkkLiBFbiBsYSBzZXJpZSB0cmFuc2Zvcm1hZGEgZGVzdGFjYW4gbGFzIGNvbXBlbnNhY2lvbmVzIGFzb2NpYWRhcyBhIGxhIGludGVydmVuY2nDs24gZGUgU2VtYW5hIFNhbnRhLgoKYGBge3J9CnNlcmllcyA8LSBjYmluZCgiT3JpZ2luYWwiID0gUGFzYWplcm9zLAogICAgICAgICAgICAgICAgIkRpZiByZWcuIHkgZXN0LiBkZSBsb2ciID0gZGlmZihkaWZmKGxvZyhQYXNhamVyb3MpLCBsYWcgPSAxMikpKQphdXRvcGxvdChzZXJpZXMsIGZhY2V0cyA9IFRSVUUsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICIiLAogICAgICAgICBtYWluID0gIkZpZ3VyYSA1LjIuIFBhc2FqZXJvcyAiKQpgYGAKClwKCiMjIElkZW50aWZpY2FjacOzbiBkZSBsYSBzZXJpZSBQYXNhamVyb3MKClZhbW9zIGEgaWRlbnRpZmljYXIgbG9zIHZhbG9yZXMgZGUgJHAkLCAkcSQsICRQJCB5ICRRJCBkZWwgcHJvY2VzbyBBcmltYS4gUGFyYSBlbGxvLCBzb2xpY2l0YXJlbW9zIGNvbiBgYXV0by5hcmltYWAgeSBgc2Vhc2AgdW5hIGlkZW50aWZpY2FjacOzbiBhdXRvbcOhdGljYSwgZW4gZWwgcHJpbWVyIGNhc28gaW5jbHV5ZW5kbyB0b2RvcyBsb3MgZWZlY3RvcyBjYWxlbmRhcmlvIHlhIGlkZW50aWZpY2Fkb3MuCgoKXAoKIyMjIElkZW50aWZpY2FjacOzbiBhdXRvbcOhdGljYSBjb24gYGF1dG8uYXJpbWFgIHstfQoKUGFyYSBfYXl1ZGFyXyBhIGxhIGZ1bmNpw7NuIGBhdXRvLmFyaW1hYCBlbiBlbCBwcm9jZXNvIGRlIGlkZW50aWZpY2FjacOzbiB2YW1vcyBhIGRlZmluaXIgcHJldmlhbWVudGUgdG9kYXMgbGFzIHZhcmlhYmxlcyBkZSBpbnRlcnZlbmNpw7NuIHF1ZSBlbiBlbCBkZXNhcnJvbGxvIGRlbCBhbsOhbGlzaXMgZGUgbGEgc2VyaWUgaGVtb3MgaWRvIGlkZW50aWZpY2FuZG86IGTDrWFzIGRlbCBtZXMsIGTDrWFzIGxhYm9yYWJsZXMgZGVsIG1lcywgbWVzZXMgZGUgZGljaWVtYnJlIGNvbiBlbCBkw61hIGRlIE5hdmlkYWQgZW4gbHVuZXMgeSBTZW1hbmEgU2FudGE6CgoqIExhIHZhcmlhYmxlcyBfZMOtYXMgbGFib3JhYmxlcyBkZWwgbWVzXyB5YSBoYSBzaWRvIGRlZmluaWRhIHByZXZpYW1lbnRlIGNvbW8gRGlhc0xhYm9yYWJsZXMuCiogTGEgdmFyaWFibGUgX0TDrWFzIGRlbCBtZXNfIHNlIHB1ZWRlIGRlZmluaXIgZGlyZWN0YW1lbnRlIGNvbiBsYSBmdW5jacOzbiBgbW9udGhkYXlzYCBkZSBsYSBsaWJyZXLDrWEgYGZvcmVjYXN0YC4gRW4gbHVnYXIgZGUgZMOtYXMgZGVsIG1lcywgY29uc2lkZXJhcmVtb3MgbGEgdmFyaWFibGUgX2TDrWFzIG5vIGxhYm9yYWJsZXMgZGVsIG1lc18sIHJlc3VsdGFudGUgZGUgcmVzdGFyIGEgbG9zIGTDrWFzIGRlbCBtZXMgbG9zIGTDrWFzIGxhYm9yYWJsZXMuCiogTG9zIG1lc2VzIGRlIGRpY2llbWJyZSBlbiBxdWUgZWwgZMOtYSBkZSBOYXZpZGFkIGNhZSBlbiBsdW5lcyByZXF1aWVyZSB1biBwb2NvIG3DoXMgZGUgdHJhYmFqby4gTGEgaWRlYSBnZW5lcmFsIGVzIGdlbmVyYXIgdW4gcmFuZ28gZGUgZmVjaGFzIGRpYXJpYXMgcXVlIGN1YnJhIHRvZG8gZWwgcGVyaW9kbyBkZSBhbsOhbGlzaXMgKHZhcmlhYmxlIF9mZWNoYXNfKSwgaWRlbnRpZmljYXIgbG9zIGx1bmVzIGRlIE5hdmlkYWQgKHZhcmlhYmxlIGRpY290w7NtaWNhIF9sdW5lc05hdmlkYWRfKSwgZWxpbWluYXIgZWwgaWRlbnRpZmljYWRvciBkZWwgZMOtYSBkZWwgcmFuZ28gZGUgZmVjaGFzIGNvbiBsYSBmdW5jacOzbiBgZm9ybWF0YCB5LCBwb3Igw7psdGltbywgY29uIGB0YXBwbHlgIHN1bWFyIHBhcmEgY2FkYSBtZXMtYcOxbyBsb3MgbHVuZXMgZGUgTmF2aWRhZCwgcXVlIGzDs2dpY2FtZW50ZSBzb2xvIHRlbmRyw6FuIGx1Z2FyIGFsZ3Vub3MgbWVzZXMgZGUgZGljaWVtYnJlIHkgdW5hIHNvbGEgdmV6LiBFbiBsb3Mgb2JqZXRvcyBkZWZpbmlkb3MgY29uIGxhIGZ1bmNpw7NuIGBhcy5QT1NJWGx0YCBsb3MgbWVzZXMgdmFuIGRlIDAgYSAxMSAoZW5lcm8gYSBkaWNpZW1icmUpIHkgbG9zIGTDrWFzIGRlIGxhIHNlbWFuYSBkZSAwIGEgNiAoZG9taW5nbyBhIHPDoWJhZG8pLgoqIExhIGNyZWFjacOzbiBkZSBsYXMgdmFyaWFibGVzIGRlIGludGVydmVuY2nDs24gcXVlIGVzdGltYW4gZWwgZWZlY3RvIGRlIGxhIFNlbWFuYSBTYW50YSBlcyBhw7puIG3DoXMgY29tcGxlam8uIEVsIGVmZWN0byBkZWwgdmllcm5lcyBkZSBTZW1hbmEgU2FudGEgeWEgcXVlZGEgcmVjb2dpZG8gZW4gbGEgdmFyaWFibGUgRGlhc05vTGFib3JhYmxlcy4gTG8gcXVlIHZhbW9zIGEgaGFjZXIgYWhvcmEgZXMgY3JlYXIgdW5hIHZhcmlhYmxlIHF1ZSBwZXJtaXRhIGVzdGltYXIgZWwgZWZlY3RvIGRlIGxhcyB2YWNhY2lvbmVzIGVzY29sYXJlcyAoeSBkZSBtdWNob3MgcGFkcmVzIHkgbWFkcmVzKSBkZSBsdW5lcyBhIEp1ZXZlcyBTYW50byBlbiBhcXVlbGxhcyBjb211bmlkYWRlcyBkb25kZSBhc8OtIGVzOyB5IG90cmEgdmFyaWFibGUgcGFyYSBlc3RpbWFyIGVsIGVmZWN0byBkZSBsYXMgdmFjYWNpb25lcyBlc2NvbGFyZXMgcXVlIHRpZW5lbiBsdWdhciBsYSBzZW1hbmEgcG9zdGVyaW9yIGFsIERvbWluZ28gZGUgUmVzdXJyZWNjacOzbiwgZGUgbHVuZXMgYSB2aWVybmVzIHRyYXMgU2VtYW5hIFNhbnRhLiBFc3RhcyBudWV2YXMgdmFyaWFibGVzIChfRGlhc1ByZVNhbnRhXyB5IF9EaWFzUGFzY3VhXykgdmFsZHLDoW4gY2VybyBwYXJhIGxvcyBtZXNlcyBkaXN0aW50b3MgZGUgbWFyem8geSBhYnJpbCwgcGVybyBwYXJhIG1hcnpvIHZhbGRyw6FuIGxhIHByb3BvcmNpw7NuIGRlIGTDrWFzIHZhY2FjaW9uYWxlcyBxdWUgcmVjYWVuIGVuIG1hcnpvIHkgcGFyYSBhYnJpbCBlbCBvcHVlc3RvIChsYSBwcm9wb3JjacOzbiBkZSBkw61hcyB2YWNhY2lvbmFsZXMgcXVlIG5vIGNhZW4gZWwgYWJyaWwpLiBFcyBkZWNpciwgc2UgZ2VuZXJhIHVuIGVmZWN0byBjb21wZW5zYWNpw7NuIHNpZW1wcmUgcXVlIHVuIHBlcmlvZG8gdmFjYWNpb25hbCBubyByZWNhZSDDrW50ZWdyYW1lbnRlIGVuIGFicmlsIHkgbGEgbWFnbml0dWQgZGUgZXN0YSBjb21wZW5zYWNpw7NuIGVzIHByb3BvcmNpb25hbCBhIGxhIHByb3BvcmNpw7NuIGRlIGTDrWFzIHZhY2FjaW9uYWxlcyBmdWVyYSBkZSBhYnJpbC4KCgpgYGB7cn0KRGlhc05vTGFib3JhYmxlcyA8LSBtb250aGRheXMoUGFzYWplcm9zKSAtIERpYXNMYWJvcmFibGVzCnBEaWFzTm9MYWJvcmFibGVzIDwtIG1vbnRoZGF5cyhQYXNhamVyb3NFdHNQcmUkbWVhbikgLSBwRGlhc0xhYm9yYWJsZXMKCmZlY2hhcyA8LSBhcy5QT1NJWGx0KHNlcShmcm9tID0gYXMuRGF0ZSgiMTk5Ni0xLTEiKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICB0byA9IGFzLkRhdGUoIjIwMjQtMTItMzEiKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICBieSA9IDEpKQpMdW5lc05hdmlkYWQgPC0gMSooZmVjaGFzJHdkYXkgPT0gMSAmIGZlY2hhcyRtb24gPT0gMTEgJiBmZWNoYXMkbWRheSA9PSAyNSkKZmVjaGFzIDwtIGZvcm1hdChmZWNoYXMsIGZvcm1hdCA9ICIlWS0lbSIpCkx1bmVzTmF2aWRhZCA8LSB0YXBwbHkoTHVuZXNOYXZpZGFkLCBmZWNoYXMsIHN1bSkKTHVuZXNOYXZpZGFkIDwtIHRzKEx1bmVzTmF2aWRhZCwgc3RhcnQgPSAxOTk2LCBmcmVxdWVuY3kgPSAxMikKcEx1bmVzTmF2aWRhZCA8LSBzdWJzZXQoTHVuZXNOYXZpZGFkLCBzdGFydCA9IGxlbmd0aChMdW5lc05hdmlkYWQpIC0gNTkpCkx1bmVzTmF2aWRhZCA8LSBzdWJzZXQoTHVuZXNOYXZpZGFkLCBlbmQgPSBsZW5ndGgoTHVuZXNOYXZpZGFkKSAtIDYwKQpMdW5lc05hdmlkYWRbTHVuZXNOYXZpZGFkID09IDFdCgpMdW5TYW50byA8LSBFYXN0ZXIoMTk5NjoyMDI0LCBzaGlmdCA9IC02KQpNYXJTYW50byA8LSBFYXN0ZXIoMTk5NjoyMDI0LCBzaGlmdCA9IC01KQpNaWVTYW50byA8LSBFYXN0ZXIoMTk5NjoyMDI0LCBzaGlmdCA9IC00KQpKdWVTYW50byA8LSBFYXN0ZXIoMTk5NjoyMDI0LCBzaGlmdCA9IC0zKQoKUHJlU2FudGEgPC0gYyhMdW5TYW50bywgTWFyU2FudG8sIE1pZVNhbnRvLCBKdWVTYW50bykKYml6IDwtIGZlY2hhRGlhcmlhW2lzQml6ZGF5KGZlY2hhRGlhcmlhLCBob2xpZGF5cyA9IFByZVNhbnRhLCB3ZGF5ID0gMDo2KV0KYml6ZGF5cyA8LSBmb3JtYXQoYml6LCBmb3JtYXQgPSAiJVktJW0iKQoKRGlhc1ByZVNhbnRhIDwtIHRhYmxlKGJpemRheXMpCkRpYXNQcmVTYW50YSA8LSB0cyhEaWFzUHJlU2FudGEsIHN0YXJ0ID0gMTk5NiwgZnJlcXVlbmN5ID0gMTIpCkRpYXNQcmVTYW50YSA8LSAobW9udGhkYXlzKERpYXNQcmVTYW50YSkgLSBEaWFzUHJlU2FudGEpLzQKRGlhc1ByZVNhbnRhW2N5Y2xlKERpYXNQcmVTYW50YSkgPT0gNF0gPC0gLURpYXNQcmVTYW50YVtjeWNsZShEaWFzUHJlU2FudGEpID09IDNdICAKCnBEaWFzUHJlU2FudGEgPC0gc3Vic2V0KERpYXNQcmVTYW50YSwgc3RhcnQgPSBsZW5ndGgoRGlhc1ByZVNhbnRhKSAtIDU5KQpEaWFzUHJlU2FudGEgPC0gc3Vic2V0KERpYXNQcmVTYW50YSwgZW5kID0gbGVuZ3RoKERpYXNQcmVTYW50YSkgLSA2MCkKCkx1blBhc2N1YSA8LSBFYXN0ZXIoMTk5NjoyMDI0LCBzaGlmdCA9IDEpCk1hclBhc2N1YSA8LSBFYXN0ZXIoMTk5NjoyMDI0LCBzaGlmdCA9IDIpCk1pZVBhc2N1YSA8LSBFYXN0ZXIoMTk5NjoyMDI0LCBzaGlmdCA9IDMpCkp1ZVBhc2N1YSA8LSBFYXN0ZXIoMTk5NjoyMDI0LCBzaGlmdCA9IDQpClZpZVBhc2N1YSA8LSBFYXN0ZXIoMTk5NjoyMDI0LCBzaGlmdCA9IDUpCgpQYXNjdWEgPC0gYyhMdW5QYXNjdWEsIE1hclBhc2N1YSwgTWllUGFzY3VhLCBKdWVQYXNjdWEsIFZpZVBhc2N1YSkKYml6IDwtIGZlY2hhRGlhcmlhW2lzQml6ZGF5KGZlY2hhRGlhcmlhLCBob2xpZGF5cyA9IFBhc2N1YSwgd2RheSA9IDA6NildCmJpemRheXMgPC0gZm9ybWF0KGJpeiwgZm9ybWF0ID0gIiVZLSVtIikKCkRpYXNQYXNjdWEgPC0gdGFibGUoYml6ZGF5cykKRGlhc1Bhc2N1YSA8LSB0cyhEaWFzUGFzY3VhLCBzdGFydCA9IDE5OTYsIGZyZXF1ZW5jeSA9IDEyKQpEaWFzUGFzY3VhIDwtIChtb250aGRheXMoRGlhc1Bhc2N1YSkgLSBEaWFzUGFzY3VhKS81CkRpYXNQYXNjdWFbY3ljbGUoRGlhc1Bhc2N1YSkgPT0gNF0gPC0gLURpYXNQYXNjdWFbY3ljbGUoRGlhc1Bhc2N1YSkgPT0gM10gIAoKcERpYXNQYXNjdWEgPC0gc3Vic2V0KERpYXNQYXNjdWEsIHN0YXJ0ID0gbGVuZ3RoKERpYXNQYXNjdWEpIC0gNTkpCkRpYXNQYXNjdWEgPC0gc3Vic2V0KERpYXNQYXNjdWEsIGVuZCA9IGxlbmd0aChEaWFzUGFzY3VhKSAtIDYwKQoKYXV0b3Bsb3QoRGlhc1ByZVNhbnRhLCBzZXJpZXM9IlByZSBTZW1hbmEgU2FudGEiLAogICAgICAgICB4bGFiID0gIiIsCiAgICAgICAgIHlsYWIgPSAiUHJvcG9yY2nDs24gZGUgZMOtYXMgZW4gbWFyem8iLAogICAgICAgICBtYWluID0gIkZpZ3VyYSA1LjMuIEludGVydmVuY2nDs24gcGFyYSBwZXJpb2RvcyB2YWNhY2lvbmFsZXMgZGUgU2VtYW5hIFNhbnRhIikgKwogIGF1dG9sYXllcihEaWFzUGFzY3VhLCBzZXJpZXM9IlBvc3QgU2VtYW5hIFNhbnRhIikgKwogIHNjYWxlX2NvbG91cl9tYW51YWwodmFsdWVzPWMoIlByZSBTZW1hbmEgU2FudGEiPSJibGFjayIsIlBvc3QgU2VtYW5hIFNhbnRhIj0icmVkIiksCiAgICAgICAgICAgICAgICAgICAgICBicmVha3M9YygiUHJlIFNlbWFuYSBTYW50YSIsIlBvc3QgU2VtYW5hIFNhbnRhIikpCmBgYAoKTGEgZmlndXJhIDUuMyBtdWVzdHJhIGxhcyBkb3MgdmFyaWFibGVzIGRlIGludGVydmVuY2nDs24gZGUgU2VtYW5hIFNhbnRhLCBxdWUgcGFyYSBhbGd1bm9zIGHDsW9zIHNlIHN1cGVycG9uZW4uCgpBaG9yYSB0ZW5lbW9zIHRvZG9zIGxvcyBlbGVtZW50b3MgcGFyYSBwZWRpciBsYSBpZGVudGlmaWNhY2nDs24gYXV0b23DoXRpY2EgY29uIGBhdXRvLmFyaW1hYC4KCmBgYHtyfQphdXRvLmFyaW1hKFBhc2FqZXJvcywgCiAgICAgICAgICAgbGFtYmRhID0gMCwKICAgICAgICAgICBkID0gMSwgCiAgICAgICAgICAgRCA9IDEsCiAgICAgICAgICAgeHJlZyA9IGNiaW5kKERpYXNMYWJvcmFibGVzLCBEaWFzTm9MYWJvcmFibGVzLCAKICAgICAgICAgICAgICAgICAgICAgICAgTHVuZXNOYXZpZGFkLCBEaWFzUHJlU2FudGEsIERpYXNQYXNjdWEpKQpgYGAKCkxhIGlkZW50aWZpY2FjacOzbiBhdXRvbcOhdGljYSBtdWVzdHJhIGVsIHByb2Nlc28gZGUgbGFzIGFlcm9sw61uZWFzLiBBZGVtw6FzLCBwYXJlY2UgcXVlIHRvZGFzIGxhcyB2YXJpYWJsZXMgZGUgaW50ZXJ2ZW5jacOzbiBjb24gc2lnbmlmaWNhdGl2YXMuCgpcCgojIyMgSWRlbnRpZmljYWNpw7NuIGF1dG9tw6F0aWNhIGNvbiBgc2Vhc2Agey19CgpMYSBmdW5jacOzbiBgc2Vhc2AgZGUgYHNlYXNvbmFsYCBpbmNsdXllIGF1dG9tw6F0aWNhbWVudGUgZHVyYW50ZSBsYSBpZGVudGlmaWNhY2nDs24gbGFzIHZhcmlhYmxlcyBkZSBpbnRlcnZlbmNpw7NuIG5lY2VzYXJpYXMuCgpgYGB7cn0Kc3VtbWFyeShzZWFzKGxvZyhQYXNhamVyb3MpKSkKYGBgCgpFbiBlc3RlIGNhc28gZWwgcHJvY2VzbyBpZGVudGlmaWNhZG8gZW4gbGEgcGFydGUgcmVndWxhciBlcyBtw6FzIGNvbXBsZWpvIHF1ZSBlbCBvYnRlbmlkbyBjb24gYGF1dG8uYXJpbWFgLCBBUklNQSgzLDEsMSkuIEFkZW3DoXMsIHNlIGhhbiBpbmNsdWlkbyB2YXJpYWJsZXMgZGUgaW50ZXJ2ZW5jacOzbiBhc29jaWFkYXMgYSBsb3MgYcOxb3MgYmlzaWVzdG9zLCBsYSBTZW1hbmEgU2FudGEgeSBkw61hcyBsYWJvcmFibGVzLiBDb25qdW50YW1lbnRlIGVzdGFzIHZhcmlhYmxlcyBkZSBpbnRlcnZlbmNpw7NuIHJlY29nZW4gbG9zIG1pc21vcyBlZmVjdG9zIGNvbnNpZGVyYWRvcyBwb3Igbm9zb3Ryb3MuCgoKQ29uY2x1aW1vcyBxdWUgZWwgbW9kZWxvIGRlIHBhcnRpZGEgcGFyYSBQYXNhamVyb3Mgc2Vyw6EgJFxsb2coUGFzYWplcm9zKSBcc2ltIEFSSU1BX3sxMn0oMCwgMSwgMSkoMCwgMSwgMSkgKyBBSSQuCgpcCgojIyBFc3RpbWFjacOzbiBkZWwgbW9kZWxvIGUgaWRlbnRpZmljYWNpw7NuIGRlIG90cmFzIGNvbXBvbmVudGVzIGRlIGludGVydmVuY2nDs24KClZhbW9zIGEgZXN0aW1hciBlbCBtb2RlbG8gaWRlbnRpZmljYWRvIHkgYSBhbmFsaXphciBsYSBwcmVzZW5jaWEgZGUgb3Ryb3MgdmFsb3JlcyBhdMOtcGljb3MgZW4gZWwgcmVzaWR1by4KCmBgYHtyfQpQYXNhamVyb3NBcmkgPC0gQXJpbWEoUGFzYWplcm9zLCAKICAgICAgICAgICAgICAgICAgICAgIGxhbWJkYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICBvcmRlciA9IGMoMCwgMSwgMSksICAKICAgICAgICAgICAgICAgICAgICAgIHNlYXNvbmFsID0gbGlzdChvcmRlciA9IGMoMCwgMSwgMSksIHBlcmlvZCA9IDEyKSwKICAgICAgICAgICAgICAgICAgICAgIHhyZWcgPSBjYmluZChEaWFzTGFib3JhYmxlcywgRGlhc05vTGFib3JhYmxlcywgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTHVuZXNOYXZpZGFkLCBEaWFzUHJlU2FudGEsIERpYXNQYXNjdWEpKQpQYXNhamVyb3NBcmkKCmVycm9yIDwtIHJlc2lkdWFscyhQYXNhamVyb3NBcmkpCnNkZXJyb3IgPC0gc2QoZXJyb3IpCgphdXRvcGxvdChlcnJvciwgc2VyaWVzPSJFcnJvciIsCiAgICAgICAgIGNvbG91ciA9ICJibGFjayIsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICJFcnJvciIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDUuNC4gRXJyb3IgKyBJbnRlcnZlbmNpw7NuLiBNb2RlbG8gQVJJTUEiKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gYygtMywgLTIsIDAsIDIsIDMpKnNkZXJyb3IsIAogICAgICAgICAgICAgY29sb3VyID0gYygicmVkIiwgImJsdWUiLCAiYmxhY2siLCAiYmx1ZSIsICJyZWQiKSwgCiAgICAgICAgICAgICBsdHkgPSAyKSArIAogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgxOTk2LCAyMDE5LCAyKSkKYGBgCgpJZGVudGlmaWNhbW9zIHRyZXMgbWVzZXMgZW4gbG9zIHF1ZSBlbCBlcnJvciBzdXBlcmEgbyBjYXNpIGFsY2FuemEgbGFzIHRyZXMgZGVzdmlhY2lvbmVzIHTDrXBpY2FzIHkgc29uIGNhbmRpZGF0b3MgYSB2YWxvcmVzIGF0w61waWNvczogYWJyaWwgZGUgMjAwMiwgYWdvc3RvIGRlIDIwMDUgeSBtYXJ6byBkZSAyMDEwLiBObyBlcyBmw6FjaWwgY29ub2NlciBsYXMgY2F1c2FzIHBhcmEgZXN0b3MgdmFsb3JlcyBhdMOtcGljb3MuCgpUcmFzIGluY2x1aXIgbGFzIGNvcnJlc3BvbmRpZW50ZXMgdmFyaWFibGVzIGFydGlmaWNpYWxlcyBlbiBlbCBtb2RlbG8geSBlc3RpbWFybG8sIGlkZW50aWZpY2Ftb3Mgb3RybyB2YWxvciBleHRyZW1vIGVuIGFnb3N0byBkZSAyMDA2IHkgcHJlY2VkaW1vcyBhIGluY2x1aXJsbyBlbiBlbCBtb2RlbG8geSByZXBldGlyIGVsIGFuw6FsaXNpcy4gRW4gZXN0YSBvY2FzacOzbiB5YSBubyBpZGVudGlmaWNhbW9zIG3DoXMgdmFsb3JlcyBhdMOtcGljb3MuCgpgYGB7cn0KZDA0MDIgPC0gMSoodHJ1bmModGltZShQYXNhamVyb3MpKSA9PSAyMDAyICYgY3ljbGUoUGFzYWplcm9zKSA9PSA0KQpkMDgwNSA8LSAxKih0cnVuYyh0aW1lKFBhc2FqZXJvcykpID09IDIwMDUgJiBjeWNsZShQYXNhamVyb3MpID09IDgpCmQwODA2IDwtIDEqKHRydW5jKHRpbWUoUGFzYWplcm9zKSkgPT0gMjAwNiAmIGN5Y2xlKFBhc2FqZXJvcykgPT0gOCkKZDAzMTAgPC0gMSoodHJ1bmModGltZShQYXNhamVyb3MpKSA9PSAyMDEwICYgY3ljbGUoUGFzYWplcm9zKSA9PSAzKQoKUGFzYWplcm9zQXJpIDwtIEFyaW1hKFBhc2FqZXJvcywKICAgICAgICAgICAgICAgICAgICAgIGxhbWJkYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICBvcmRlciA9IGMoMCwgMSwgMSksICAKICAgICAgICAgICAgICAgICAgICAgIHNlYXNvbmFsID0gbGlzdChvcmRlciA9IGMoMCwgMSwgMSksIHBlcmlvZCA9IDEyKSwKICAgICAgICAgICAgICAgICAgICAgIHhyZWcgPSBjYmluZChEaWFzTGFib3JhYmxlcywgRGlhc05vTGFib3JhYmxlcywgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTHVuZXNOYXZpZGFkLCBEaWFzUHJlU2FudGEsIERpYXNQYXNjdWEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZDA0MDIsIGQwODA1LCBkMDgwNiwgZDAzMTApKQpQYXNhamVyb3NBcmkKCmVycm9yIDwtIHJlc2lkdWFscyhQYXNhamVyb3NBcmkpCnNkZXJyb3IgPC0gc2QoZXJyb3IpCgphdXRvcGxvdChlcnJvciwgc2VyaWVzPSJFcnJvciIsCiAgICAgICAgIGNvbG91ciA9ICJibGFjayIsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICJFcnJvciIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDUuNS4gRXJyb3IgKyBJbnRlcnZlbmNpw7NuLiBNb2RlbG8gQVJJTUEiKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gYygtMywgLTIsIDAsIDIsIDMpKnNkZXJyb3IsIAogICAgICAgICAgICAgY29sb3VyID0gYygicmVkIiwgImJsdWUiLCAiYmxhY2siLCAiYmx1ZSIsICJyZWQiKSwgCiAgICAgICAgICAgICBsdHkgPSAyKSArIAogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgxOTk2LCAyMDE5LCAyKSkKYGBgCgpBbnRlcyBkZSBmaW5hbGl6YXIgZWwgcHJvY2VzbyBkZSBpZGVudGlmaWNhY2nDs24gdmFtb3MgYSBjb25maXJtYXIgbGEgc2lnbmlmaWNhdGl2aWRhZCBkZSB0b2RvcyBsb3MgcGFyw6FtZXRyb3MgZXN0aW1hZG9zIGhhY2llbmRvIHVzbyBkZWwgZXN0YWTDrXN0aWNvIGRlIFdhbGQuCgpgYGB7cn0KZGF0b3MgPC0gTlVMTApmb3IoaSBpbiAxOmxlbmd0aChjb2VmKFBhc2FqZXJvc0FyaSkpKSB7CiAgZGF0b3MgPC0gcmJpbmQoZGF0b3MsCiAgICAgICAgICAgICAgICAgZGF0YS5mcmFtZSgKICAgICAgICAgICAgICAgICAgICJDb2VmaWNpZW50ZSIgPSBuYW1lcyhjb2VmKFBhc2FqZXJvc0FyaSkpW2ldLAogICAgICAgICAgICAgICAgICAgIlZhbG9yIGRlIHAiID0gd2FsZC50ZXN0KGIgPSBjb2VmKFBhc2FqZXJvc0FyaSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNpZ21hID0gdmNvdihQYXNhamVyb3NBcmkpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXJtcyA9IGkpJHJlc3VsdCRjaGkyWzNdKQogICAgICAgICAgICAgICAgICkKfQprYWJsZShkYXRvcywgZGlnaXRzID0gNCwgcm93Lm5hbWVzID0gRkFMU0UsIGNhcHRpb24gPSAiQ29udHJhc3RlcyBkZSBzaWduaWZpY2F0aXZpZGFkIikKYGBgCgpcCgojIyBWYWxpZGFjacOzbiBkZWwgbW9kZWxvCgpFbiBlbCBwcm9jZXNvIGRlIHZhbGlkYWNpw7NuIGFuYWxpemFyZW1vcyBsYSBjYWxpZGFkIGRlIGFqdXN0ZSB5IHByZWRpY2Npw7NuIGRlbCBtb2RlbG8gZXN0aW1hZG8uCgpcCgojIyMgQ2FsaWRhZCBkZWwgYWp1c3RlIHstfQoKQW5hbGl6YW5kbyBsb3MgY3JpdGVyaW9zIGRlIGJvbmRhZCBkZSBhanVzdGUgKHNvYnJlIGVsIGVycm9yIGRlIHByZWRpY2Npw7NuIGludHJhLW11ZXN0cmFsIGEgdW4gcGVyaW9kbyB2aXN0YSkgc2UgdGllbmUgdW4gZXJyb3IgbWVkaW8gKE1FKSBkZSBgciByb3VuZChhY2N1cmFjeShQYXNhamVyb3NBcmkpWzFdLDIpYCBxdWUgZXMgcHLDoWN0aWNhbWVudGUgY2VybyBwb3IgbG8gcXVlIG5vIHBhcmVjZSBxdWUgaGF5YSBzZXNnbyBlbiBsYXMgcHJlZGljY2lvbmVzOyBlbiBtZWRpYSBub3MgZXF1aXZvY2Ftb3MgYHIgcm91bmQoYWNjdXJhY3koUGFzYWplcm9zQXJpKVsyXSwxKWAgbWlsbG9uZXMgZGUgcGFzYWplcm9zIChSTVNFKSB5IGVsIGVycm9yIHBvcmNlbnR1YWwgbWVkaW8gKE1BUEUpIGVzIGByIHJvdW5kKGFjY3VyYWN5KFBhc2FqZXJvc0FyaSlbNV0sMSlgJSwgbXV5IGJham8uIFBhcmEgYW1ib3MgaW5kaWNhZG9yZXMgZGUgYm9uZGFkIGRlIGFqdXN0ZSBlbCBlcnJvciBvYnRlbmlkbyBlcyBsYSBtaXRhZCBxdWUgZWwgdmlzdG8gY29uIGFsaXNhZG8uCgpgYGB7cixlY2hvPUZBTFNFfQpyb3VuZChhY2N1cmFjeShQYXNhamVyb3NBcmkpLDIpCmBgYAoKXAoKIyMjIENhbGlkYWQgZGUgbGFzIHByZWRpY2Npb25lcyB7LX0KClNlIGNvbXBsZXRhcsOhIGVsIHByb2Nlc28gZGUgdmFsaWRhY2nDs24gZXN0aW1hZG8gZWwgZXJyb3IgZGUgcHJlZGljY2nDs24gZXh0cmEgbXVlc3RyYWwgc2Vnw7puIGVsIGhvcml6b250ZSB0ZW1wb3JhbC4gU2UgY29uc2lkZXJhcsOhbiAxMCBhw7FvcyBwYXJhIGVsIHBlcmlvZG8gZGUgZXN0aW1hY2nDs24geSB1biBhw7FvIHBhcmEgZWwgZGUgcHJlZGljY2nDs24uCgpgYGB7cn0gIAprIDwtIDEyMCAgICAgICAgICAgICAgICAgIApoIDwtIDEyICAgICAgICAgICAgICAgICAgIApUIDwtIGxlbmd0aChQYXNhamVyb3MpICAgIApzPC1UIC0gayAtIGggICAgICAgICAgICAKCm1hcGVBcmltYSA8LSBtYXRyaXgoTkEsIHMgKyAxLCBoKQoKWCA8LSBjYmluZChEaWFzTGFib3JhYmxlcywgRGlhc05vTGFib3JhYmxlcywgCiAgICAgICAgICAgTHVuZXNOYXZpZGFkLCBEaWFzUHJlU2FudGEsIERpYXNQYXNjdWEsCiAgICAgICAgICAgZDA0MDIsIGQwODA1LCBkMDgwNiwgZDAzMTApCgpmb3IgKGkgaW4gMDpzKSB7CiAgdHJhaW4uc2V0IDwtIHN1YnNldChQYXNhamVyb3MsIHN0YXJ0ID0gaSArIDEsIGVuZCA9IGkgKyBrKQogIHRlc3Quc2V0IDwtICBzdWJzZXQoUGFzYWplcm9zLCBzdGFydCA9IGkgKyBrICsgMSwgZW5kID0gaSArIGsgKyBoKSAKICAKICBYLnRyYWluIDwtIFhbKGkgKyAxKTooaSArIGspLF0KICBoYXkgPC0gY29sU3VtcyhYLnRyYWluKQogIFgudHJhaW4gPC0gWC50cmFpblssIGhheT4wXQogIAogIFgudGVzdCA8LSBYWyhpICsgayArIDEpOihpICsgayArIGgpLF0KICBYLnRlc3QgPC0gWC50ZXN0WywgaGF5PjBdCiAgCiAgaWYgKGxlbmd0aChYLnRyYWluKSA+IDApIHsKICAgIGZpdCA8LSB0cnkoQXJpbWEodHJhaW4uc2V0LCAKICAgICAgICAgICAgICAgICAgICAgbGFtYmRhID0gMCwKICAgICAgICAgICAgICAgICAgICAgb3JkZXIgPSBjKDAsIDEsIDEpLAogICAgICAgICAgICAgICAgICAgICBzZWFzb25hbCA9IGxpc3Qob3JkZXIgPSBjKDAsIDEsIDEpLCBwZXJpb2QgPSAxMiksCiAgICAgICAgICAgICAgICAgICAgIHhyZWc9WC50cmFpbiksIHNpbGVudCA9IFRSVUUpfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICBmaXQgPC0gdHJ5KEFyaW1hKHRyYWluLnNldCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbWJkYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlciA9IGMoMCwgMSwgMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFzb25hbCA9IGxpc3Qob3JkZXIgPSBjKDAsIDEsIDEpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJpb2QgPSAxMikpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbGVudCA9IFRSVUUpCiAgICAgICAgICAgICAgICAgICAgIH0KICAKICBpZiAoIWlzLmVsZW1lbnQoInRyeS1lcnJvciIsIGNsYXNzKGZpdCkpKSB7CiAgICBpZiAobGVuZ3RoKFgudHJhaW4pID4gMCkgZmNhc3QgPC0gZm9yZWNhc3QoZml0LCBoID0gaCwgeHJlZyA9IFgudGVzdCkgZWxzZQogICAgICBmY2FzdCA8LSBmb3JlY2FzdChmaXQsIGggPSBoKQogICAgbWFwZUFyaW1hW2kgKyAxLF0gPC0gMTAwKmFicyh0ZXN0LnNldCAtIGZjYXN0JG1lYW4pL3Rlc3Quc2V0CiAgfQp9CgplcnJvckFyaW1hIDwtIGNvbE1lYW5zKG1hcGVBcmltYSwgbmEucm0gPSBUUlVFKQpyb3VuZChlcnJvckFyaW1hLCAyKQpgYGAKCkVsIGVycm9yIGVzIGNyZWNpZW50ZSBlbiBlbCBob3Jpem9udGUgdGVtcG9yYWwgZGUgcHJlZGljY2nDs24uIFBhcmEgcHJlZGljY2lvbmVzIGV4dHJhLW11ZXN0cmFsZXMgYSB1biBwZXJpb2RvIHZpc3RhIHZhbGUgYHIgcm91bmQoZXJyb3JBcmltYVsxXSwgMSlgJSwgYWxnbyBzdXBlcmlvciBhbCBlcnJvciBkZSBlc3RpbWFjacOzbiwgcGVybyByZWFsbWVudGUgYmFqby4gSW5jbHVzbyBwYXJhIHByZWRpY2Npb25lcyBhIGRvY2UgbWVzZXMgdmlzdGEsIGVsIGVycm9yIHNpZ3VlIHNpZW5kbyByZWR1Y2lkbywgYHIgcm91bmQoZXJyb3JBcmltYVsxMl0sIDEpYCUuIFJlY29yZGVtb3MgcXVlIHBhcmEgYWxpc2FkbyBlcmEgZGUgMy42JSAoVGFibGEgMikuCgpcCgojIyBJbnRlcnByZXRhY2nDs24gZGVsIG1vZGVsbyBlc3RpbWFkbwoKRWwgbW9kZWxvIGVzdGltYWRvIHkgdmFsaWRhZG8gY29ycmVzcG9uZGUgYWwgbW9kZWxvIGRlIGxhcyBhZXJvbMOtbmVhcyBjb24gaW50ZXJ2ZW5jacOzbjogJEFSSU1BX3sxMn0oMCwxLDEpKDAsMSwxKSArIEFJJC4gTGEgZWN1YWNpw7NuIHRlw7NyaWNhIGNvbXBsZXRhIGRlbCBtb2RlbG8gZXM6CiQkKDEtTCkoMS1MXnsxMn0pXGxvZyhQYXNhamVyb3MpID0gKDErXHRoZXRhXzEgTCkoMSArIFx0aGV0YV97MTJ9IExeezEyfSlcdmFyZXBzaWxvbl90KyQkCiQkXGdhbW1hXzEgRGlhc0xhYm9yYWJsZXMgK1xnYW1tYV8yIERpYXNOb0xhYm9yYWJsZXMgK1xnYW1tYV8zIEx1bmVzTmF2aWRhZCskJAokJFxnYW1tYV80IERpYXNQcmVTYW50YSArIFxnYW1tYV81IERpYXNQYXNjdWEgKyQkCiQkXGdhbW1hXzYgZDA0MDIgK1xnYW1tYV83IGQwODA1ICtcZ2FtbWFfOCBkMDgwNiArXGdhbW1hXzkgZDAzMTAuJCQKClNpIHNlIGRlc2Fycm9sbGEgZWwgbW9kZWxvIHkgc2UgZGVqYSBlbiBmdW5jacOzbiBkZSBsYSB0YXNhIGRlIHZhcmlhY2nDs24gYW51YWwgZGVsIG7Dum1lcm8gZGUgcGFzYWplcm8sIHF1ZWRhIChsYSBwYXJ0ZSBkZSBpbnRlcnZlbmNpw7NuIG5vIGNhbWJpYSk6CgokJFRWQVBhc2FqZXJvc190ID0gVFZBUGFzYWplcm9zX3t0LTF9ICsgXHRoZXRhXzEgXHZhcmVwc2lsb25fe3QtMX0gKyBcdGhldGFfezEyfSBcdmFyZXBzaWxvbl97dC0xMn0rIFx0aGV0YV8xIFx0aGV0YV97MTJ9IFx2YXJlcHNpbG9uX3t0LTEzfStcdmFyZXBzaWxvbl90ICsgQUkuJCQKRmluYWxtZW50ZSwgZWwgbW9kZWxvIGVzdGltYWRvIGVzOgokJFx3aWRlaGF0e1RWQVBhc2FqZXJvc31fdCA9IFRWQVBhc2FqZXJvc197dC0xfSAtMC41MyBcdmFyZXBzaWxvbl97dC0xfSAtMC4zNyBcdmFyZXBzaWxvbl97dC0xMn0rIDAuMjAgXHZhcmVwc2lsb25fe3QtMTN9ICskJAokJDAuMDM0XGNkb3QgRGlhc0xhYm9yYWJsZXMgKzAuMDE2XGNkb3QgRGlhc05vTGFib3JhYmxlcysgMC4wMjZcY2RvdCBMdW5lc05hdmlkYWQkJAokJC0gMC4wNThcY2RvdCBEaWFzUHJlU2FudGEgLSAwLjAyNVxjZG90IERpYXNQYXNjdWEgKyQkCiQkMC4wMzNcY2RvdCBkMDQwMiArMC4wNjRcY2RvdCBkMDgwNSArMC4wMjhcY2RvdCBkMDgwNiArMC4wMzhcY2RvdCBkMDMxMC4kJApJbnRlcnByZXRhY2nDs246CgoqIExhIHRhc2EgZGUgdmFyaWFjacOzbiBhbnVhbCBkZWwgbsO6bWVybyBkZSBwYXNhamVyb3MgZW4gdHJhbnNwb3J0ZSB1cmJhbm8gcGFyYSB1biBtZXMgZGFkbyBlcyBsYSBtaXNtYSBxdWUgbGEgb2JzZXJ2YWRhIGVuIGVsIG1lcyBwcmV2aW8uCiogU2kgaGFjZSB1bm8sIGRvY2UgbyB0cmVjZSBtZXNlcyBzZSBvYnNlcnbDsyB1biBuw7ptZXJvIGF0w61waWNvIGRlIHBhc2FqZXJvcywgc2UgZGViZSB0ZW5lciBlbiBjdWVudGEgcGFyYSBjb3JyZWdpciBsYSBwcmVkaWNjacOzbi4KKiBDYWRhIGTDrWEgYWRpY2lvbmFsIGxhYm9yYWJsZSBlbiB1biBtZXMgc3Vwb25lIHVuIGluY3JlbWVudG8gZW4gZWwgbsO6bWVybyBkZSBwYXNhamVyb3MgZGVsIDMuNCUgeSBjYWRhIGTDrWEgYWRpY2lvbmFsIG5vIGxhYm9yYWJsZSBkZWwgMS42JS4KKiBTaSBsYSBOYXZpZGFkIGNhZSBlbiBsdW5lcyB5IHBvciB0YW50byBOb2NoZWJ1ZW5hIGVuIGRvbWluZ28sIGVzZSBtZXMgZGUgZGljaWVtYnJlIGVsIG7Dum1lcm8gZGUgcGFzYWplcm9zIHNlcsOhIHVuIDIuNiUgc3VwZXJpb3IgYSBsYSBkZSB1biBtZXMgZGUgZGljaWVtYnJlIGRvbmRlIGxhIE5hdmlkYWQgbm8gY2FlIGVuIGx1bmVzLgoqIFNpIGxvcyBkw61hcyBsYWJvcmFibGVzIChsdW5lcyBhIGp1ZXZlcykgZGUgbGEgU2VtYW5hIFNhbnRhIGNhZW4gZW4gbWFyem8sIGVzZSBtYXJ6byBlbCBuw7ptZXJvIGRlIHBhc2FqZXJvcyBjYWUgdW4gNS44JSwgbWllbnRyYXMgcXVlIGVuIGFicmlsIHNlIHByb2R1Y2lyw6EgdW4gaW5jcmVtZW50byBkZWwgbsO6bWVybyBkZSBwYXNhamVyb3MgZW4gdHJhbnNwb3J0ZSB1cmJhbm8gZGUgbGEgbWlzbWEgcHJvcG9yY2nDs24uCiogRGUgbGEgbWlzbWEgZm9ybWEsIHNpIGxvcyBkw61hcyBsYWJvcmFibGVzIChsdW5lcyBhIHZpZXJuZXMpIGRlIGxhIHNlbWFuYSBwb3N0ZXJpb3IgYSBEb21pbmdvIGRlIFJlc3VycmVjY2nDs24gY2FlbiBlbiBtYXJ6bywgZXNlIG1hcnpvIGVsIG7Dum1lcm8gZGUgcGFzYWplcm9zIGNhZSB1biAyLjUlLCBtaWVudHJhcyBxdWUgZW4gYWJyaWwgc2UgcHJvZHVjaXLDoSB1biBpbmNyZW1lbnRvIGRlbCBuw7ptZXJvIGRlIHBhc2FqZXJvcyBlbiB0cmFuc3BvcnRlIHVyYmFubyBkZSBsYSBtaXNtYSBwcm9wb3JjacOzbi4KKiBBZGVtYXMsIHBhcmEgY3VhdHJvIG1lc2VzIHNlIG9ic2VydsOzIHVuYSB0YXNhIGRlIHZhcmlhY2nDs24gYW51YWwgYXTDrXBpY2FtZW50ZSBzdXBlcmlvciBhIGxhIGVzcGVyYWRhLgoKXAoKIyMgUHJlZGljY2nDs24gZGVsIG7Dum1lcm8gZGUgcGFzYWplcm9zIGVuIHRyYW5zcG9ydGUgdXJiYW5vCgpVbmEgdmV6IGRhZG8gcG9yIHbDoWxpZG8gZWwgbW9kZWxvLCBwb2RlbW9zIHBhc2FyIGEgcmVhbGl6YXIgcHJlZGljY2lvbmVzIHBhcmEgbG9zIHByw7N4aW1vcyBhw7Fvcy4gUGFyYSBsYXMgdmFyaWFibGVzIGRlIGludGVydmVuY2nDs24gc3VqZXRhcyBhIGZlY2hhIGRlIGNhbGVuZGFyaW8geWEgaGVtb3MgaWRvIGNyZWFuZG8gc3VzIHZhbG9yZXMgcHJldmlzdG9zLCBwYXJhIGxhcyBkZW3DoXMgbG9zIGZpamFyZW1vcyBhIGNlcm8uCgpgYGB7cn0KcFBhc2FqZXJvc0FyaSA8LSBmb3JlY2FzdChQYXNhamVyb3NBcmksIAogICAgICAgICAgICAgICAgICAgICAgICAgIGggPSA2MCwKICAgICAgICAgICAgICAgICAgICAgICAgICB4cmVnID0gY2JpbmQocERpYXNMYWJvcmFibGVzLCBwRGlhc05vTGFib3JhYmxlcywgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBMdW5lc05hdmlkYWQsIHBEaWFzUHJlU2FudGEsIHBEaWFzUGFzY3VhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXAoMCwgNjApLCByZXAoMCwgNjApLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwKDAgLDYwKSwgcmVwKDAsIDYwKSksIAogICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsID0gOTUpCmF1dG9wbG90KHBQYXNhamVyb3NBcmksIAogICAgICAgICB4bGFiID0gIiIsCiAgICAgICAgIHlsYWIgPSAiIiwKICAgICAgICAgbWFpbiA9ICJGaWd1cmEgNS42LiBQYXNhamVyb3MgKDE5OTYtMjAxOSkgeSBwcmVkaWNjacOzbiAoMjAyMC0yMDI0KS4gTW9kZWxvIEFyaW1hLiIpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzPSBzZXEoMTk5NiwgMjAyNCwgNCkpCmBgYAoKQXPDrSwgZW4gMjAyMCBzZSBlc3BlcmFuIGByIHJvdW5kKHN1bShwUGFzYWplcm9zQXJpJG1lYW5bMToxMl0pLCAwKWAgbWlsbG9uZXMgZGUgcGFzYWplcm9zIHkgcGFyYSAyMDIxIHVuIHRvdGFsIGRlIGByIHJvdW5kKHN1bShwUGFzYWplcm9zQXJpJG1lYW5bMTM6MjRdKSwgMClgIG1pbGxvbmVzIGRlIHBhc2FqZXJvcy4KClwKXApcCgojIENvbXBhcmFjacOzbiBlbnRyZSBtb2RlbG9zCgpQYXJhIGZpbmFsaXphciBlc3RlIGFuw6FsaXNpcywgdmFtb3MgYSBjb21wYXJhciBsYSBjYWxpZGFkIGRlIGFqdXN0ZSB5IGRlIHByZWRpY2Npw7NuIGRlIGxvcyB0cmVzIG1vZGVsb3MgZXN0aW1hZG9zIGVuIGVzdGUgZWplbXBsbzogZWwgbcOpdG9kbyBpbmdlbnVvIGNvbiBlc3RhY2lvbmFsaWRhZCwgZWwgbcOpdG9kbyBkZSBBbGlzYWRvIGV4cG9uZW5jaWFsIHkgZWwgbW9kZWxvIEFyaW1hLgoKUmVjb3JkZW1vcyBxdWUgZWwgbcOpdG9kbyBpbmdlbnVvIGNvbiBlc3RhY2lvbmFsaWRhZCB0ZW7DrWEgdW4gZXJyb3IgZGUgYWp1c3RlIGRlbCBgciByb3VuZChhY2N1cmFjeShQYXNhamVyb3NTbmFpdmUpWzVdLCAxKWAlIG8gYHIgcm91bmQoYWNjdXJhY3koUGFzYWplcm9zU25haXZlKVsyXSwgMSlgIG1pbGxvbmVzIGRlIHBhc2FqZXJvcyAoUk1TRSkuIE1pZW50cmFzIHF1ZSBwYXJhIGVsIG1lam9yIG1vZGVsbyBkZSBhbGlzYWRvIG9idGVuaWRvIChFVFMoTSxBZCxBKSkgc2UgdGllbmUgdW4gZXJyb3IgYWJzb2x1dG8gcG9yY2VudHVhbCBkZWwgYHIgcm91bmQoYWNjdXJhY3koUGFzYWplcm9zRXRzKVs1XSwgMSlgJSBlcXVpdmFsZW50ZSBhIGByIHJvdW5kKGFjY3VyYWN5KFBhc2FqZXJvc0V0cylbMl0sIDEpYCBtaWxsb25lcyBkZSBwYXNhamVyb3MuIFBvciDDumx0aW1vLCBlbCBtb2RlbG8gQVJJTUEgcHJlc2VudGEgdW4gZXJyb3IgZGUgYHIgcm91bmQoYWNjdXJhY3koUGFzYWplcm9zQXJpKVs1XSwgMSlgJSBvIGByIHJvdW5kKGFjY3VyYWN5KFBhc2FqZXJvc0FyaSlbMl0sIDEpYCBtaWxsb25lcyBkZSBwYXNhamVyb3MuIAoKQ2xhcmFtZW50ZSwgZWwgbW9kZWxvIGRlIGFsaXNhZG8gc3Vwb25lIHVuYSBtZWpvcmEgc3VzdGFuY2lhbCBzb2JyZSBlbCBtw6l0b2RvIGluZ2VudW8geSBlbCBtb2RlbG8gQVJJTUEgc29icmUgZWwgZGUgYWxpc2FkbyBjb24gdW5hIHJlZHVjY2nDs24sIGVuIGVzdGUgw7psdGltbyBjYXNvLCBkZWwgNTAlIGVuIGxvcyBkb3MgaW5kaWNhZG9yZXMgZGUgY2FsaWRhZCBjb250ZW1wbGFkb3MuCgpSZXNwZWN0byBkZSBsYSBjYWxpZGFkIGRlIGxhcyBwcmVkaWNjaW9uZXMgZXh0cmEtbXVlc3RyYWxlcywgbGEgZmlndXJhIDYuMSBtdWVzdHJhIGxvcyB2YWxvcmVzIHBhcmEgZWwgbW9kZWxvIGRlIEFsaXNhZG8geSBBUklNQS4KCmBgYHtyfQpkYXRvcyA8LSBkYXRhLmZyYW1lKAogIGZhY3RvciA9IGMocmVwKCJBbGlzYWRvIiwgMTIpLCAKICAgICAgICAgICAgIHJlcCgiQXJpbWEiLCAxMikpLAogIHggPSBjKDE6MTIsIDE6MTIpLAogIHkgPSBjKGVycm9yQWxpc2Fkb1BhcywgZXJyb3JBcmltYSkKKQoKZ2dwbG90KGRhdG9zLCBhZXMoeCA9IHgsIHkgPSB5LCAgY29sb3VyPSBmYWN0b3IpKSArIAogIGdlb21fbGluZSgpICsKICBnZ3RpdGxlKCJGaWd1cmEgNi4xLiBFcnJvciBkZSBwcmVkaWNjacOzbiAoTUFQRSkgc2Vnw7puIGhvcml6b250ZSB0ZW1wb3JhbCB5IGVuZm9xdWUiKSArCiAgeGxhYigiSG9yaXpvbnRlIHRlbXBvcmFsIGRlIHByZWRpY2Npw7NuIikgKwogIHlsYWIoIiUiKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcz0gMToxMikgKwogIHNjYWxlX3lfY29udGludW91cyhicmVha3M9IHNlcSgxLjUsIDQsIC41KSkgKwogIGd1aWRlcyhjb2xvdXIgPSBndWlkZV9sZWdlbmQodGl0bGUgPSAiTcOpdG9kb3MiKSkgKyAKICB0aGVtZShsZWdlbmQucG9zaXRpb249YygwLjAyLDAuOTgpLCBsZWdlbmQuanVzdGlmaWNhdGlvbj1jKDAsMSkpCmBgYAoKQ29uIGluZGVwZW5kZW5jaWEgZGVsIGhvcml6b250ZSB0ZW1wb3JhbCwgZWwgZXJyb3IgZGUgcHJldmlzacOzbiBleHRyYS1tdWVzdHJhbCBkZWwgbW9kZWxvIEFSSU1BIGVzIG1lbm9yIHF1ZSBlbCBlcnJvciBkZWwgbW9kZWxvIGRlIGFsaXNhZG8sIGF1bnF1ZSBsYSBkaWZlcmVuY2lhIHNlIHJlZHVjZSBjb25mb3JtZSBhdW1lbnRhIGVsIGhvcml6b250ZSB0ZW1wb3JhbCBkZSBwcmV2aXNpw7NuLiBFbiBjb25jcmV0bywgcGFyYSBwcmV2aXNpb25lcyBhIHVuIG1lcyB2aXN0YSwgQVJJTUEgY29tZXRlIHVuIGVycm9yIDAuOCBwdW50b3MgcG9yY2VudHVhbGVzIG1lbm9yIHF1ZSBlbCBhbGlzYWRvLCBtaWVudHJhcyBxdWUgcGFyYSBwcmVkaWNjaW9uZXMgYSBzZWlzIG1lc2VzIHZpc3RhIGxhIGRpZmVyZW5jaWEgZXMgc29sbyBkZSBtZWRpbyBwdW50byB5IHBhcmEgdW4gaG9yaXpvbnRlIGRlIGRvY2UgbWVzZXMgZGUgMC40IHB1bnRvcy4KCkVsIG3DqXRvZG8gQVJJTUEgbm9zIHBlcm1pdGUgb2J0ZW5lciBsYSBwcmVkaWNjaW9uZXMgbcOhcyBwcmVjaXNhcyB5IGFkZW3DoXMgZW50ZW5kZXIgdW4gcG9jbyBtZWpvciBjdWFsZXMgc29uIGxvcyBkZXRlcm1pbmFudGVzIGRlbCBuw7ptZXJvIGRlIHBhc2FqZXJvcyBlbiB0cmFuc3BvcnRlIHVyYmFubyB5IHN1IGVmZWN0byBzb2JyZSBsYSBzZXJpZS4gRWwgbcOpdG9kbyBkZSBBbGlzYWRvIGV4cG9uZW5jaWFsIHBlcm1pdGUgb2J0ZW5lciBwcmVkaWNjaW9uZXMgYmFzdGFudGUgYnVlbmFzIGNvbiB1bmEgc2ltcGxlIGzDrW5lYSBkZSBjw7NkaWdvLiBMYSBjb252ZW5pZW5jaWEgZGUgdW5vIG8gb3RybyBtw6l0b2RvIGRlcGVuZGVyw6EgZGUgbGEgaW1wb3J0YW5jaWEgcXVlIHNlIGTDqSBhIGxhIGNhbGlkYWQgZGUgbGFzIHByZWRpY2Npb25lcywgbGEgY29tcHJlbnNpw7NuIGRlIGxvcyBkZXRlcm1pbmFudGVzIGRlIGxhIHNlcmllIG8gbGEgY29tcGxlamlkYWQgZGUgbGEgbWV0b2RvbG9nw61hLCBlbnRyZSBvdHJvcyBhc3BlY3Rvcy4KClwKXAoKIyBMaXN0YSBkZSBmdW5jaW9uZXMgdXRpbGl6YWRhcwoKCnxQYXF1ZXRlICAgICAgICB8RnVuY2lvbmVzICAgICAgICAgIHxQYXF1ZXRlICAgICAgICB8RnVuY2lvbmVzIHwKfDotLS0tLS0tLS0tLS0tLXw6LS0tLS0tLS0tLS0tLS0tLS0tfDotLS0tLS0tLS0tLS0tLXw6LS0tLS0tLS0tLS0tLS0tLS0tfAp8IGFvZCAgICAgIHwgd2FsZC50ZXN0ICAgICAgICB8IGZvcmVjYXN0ICB8IGdnc3Vic2VyaWVzcGxvdCAgICAgICAgfAp8IGJhc2UgICAgIHwgYWJzICAgICAgICAgICAgICB8ICAgICAgICAgICB8IG1vbnRoZGF5cyAgICAgICAgfAp8ICAgICAgICAgIHwgYXMuRGF0ZSAgICAgICAgICB8ICAgICAgICAgICB8IG5kaWZmcyAgICAgICAgfAp8ICAgICAgICAgIHwgYXMubnVtZXJpYyAgICAgICB8ICAgICAgICAgICB8IG5zZGlmZnMgICAgICAgIHwKfCAgICAgICAgICB8IGFzLlBPU0lYbHQgICAgICAgfCAgICAgICAgICAgfCByZW1haW5kZXIgICAgICAgIHwKfCAgICAgICAgICB8IGMgICAgICAgICAgICAgICAgfCAgICAgICAgICAgfCBzbmFpdmUgICAgICAgIHwKfCAgICAgICAgICB8IGNiaW5kICAgICAgICAgICAgfCBnZ3Bsb3QyICAgfCBhZXMgICAgICAgIHwKfCAgICAgICAgICB8IGNsYXNzICAgICAgICAgICAgfCAgICAgICAgICAgfCBnZW9tX2hsaW5lICAgICAgICB8CnwgICAgICAgICAgfCBjb2xNZWFucyAgICAgICAgIHwgICAgICAgICAgIHwgZ2VvbV9saW5lICAgICAgICB8CnwgICAgICAgICAgfCBjb2xuYW1lcyAgICAgICAgIHwgICAgICAgICAgIHwgZ2VvbV9wb2ludCAgICAgICAgfAp8ICAgICAgICAgIHwgY29sU3VtcyAgICAgICAgICB8ICAgICAgICAgICB8IGdncGxvdCAgICAgICAgICAgICAgICB8CnwgICAgICAgICAgfCBkYXRhLmZyYW1lICAgICAgIHwgICAgICAgICAgIHwgZ2d0aXRsZSAgICAgICAgfAp8ICAgICAgICAgIHwgZGlmZiAgICAgICAgICAgICB8ICAgICAgICAgICB8IGd1aWRlX2xlZ2VuZCAgICAgICAgfAp8ICAgICAgICAgIHwgZXhwcmVzc2lvbiAgICAgICB8ICAgICAgICAgICB8IGd1aWRlcyAgICAgICAgfAp8ICAgICAgICAgIHwgaXMuZWxlbWVudCAgICAgICB8ICAgICAgICAgICB8IHNjYWxlX2NvbG91cl9tYW51YWwgICAgICAgIHwKfCAgICAgICAgICB8IGxlbmd0aCAgICAgICAgICAgfCAgICAgICAgICAgfCBzY2FsZV94X2NvbnRpbnVvdXMgICAgICAgIHwKfCAgICAgICAgICB8IGxpYnJhcnkgICAgICAgICAgfCAgICAgICAgICAgfCBzY2FsZV95X2NvbnRpbnVvdXMgICAgICAgIHwKfCAgICAgICAgICB8IGxpc3QgICAgICAgICAgICAgfCAgICAgICAgICAgfCB0aGVtZSAgICAgICAgfAp8ICAgICAgICAgIHwgbG9nICAgICAgICAgICAgICB8ICAgICAgICAgICB8IHRoZW1lX2J3ICAgICAgICB8CnwgICAgICAgICAgfCBtYXRyaXggICAgICAgICAgIHwgICAgICAgICAgIHwgdGhlbWVfc2V0ICAgICAgICB8CnwgICAgICAgICAgfCBtZWFuICAgICAgICAgICAgIHwgICAgICAgICAgIHwgeGxhYiAgICAgICAgfAp8ICAgICAgICAgIHwgbmFtZXMgICAgICAgICAgICB8ICAgICAgICAgICB8IHlsYWIgICAgICAgIHwKfCAgICAgICAgICB8IG5yb3cgICAgICAgICAgICAgfCBncmlkRXh0cmEgfCBncmlkLmFycmFuZ2UgICAgICAgICB8CnwgICAgICAgICAgfCByYmluZCAgICAgICAgICAgIHwga25pdHIgICAgIHwga2FibGUgICAgICAgICB8CnwgICAgICAgICAgfCByZXAgICAgICAgICAgICAgIHwgc2Vhc29uYWwgIHwgc2VhcyAgICAgICB8CnwgICAgICAgICAgfCByb3VuZCAgICAgICAgICAgIHwgc3RhdHMgICAgIHwgYWdncmVnYXRlICAgICAgICB8CnwgICAgICAgICAgfCByb3duYW1lcyAgICAgICAgIHwgICAgICAgICAgIHwgY29lZiAgICAgICAgfAp8ICAgICAgICAgIHwgc2VxICAgICAgICAgICAgICB8ICAgICAgICAgICB8IGN5Y2xlICAgICAgICB8CnwgICAgICAgICAgfCBzdWJzZXQgICAgICAgICAgIHwgICAgICAgICAgIHwgcmVzaWR1YWxzICAgICAgICB8CnwgICAgICAgICAgfCBzdW1tYXJ5ICAgICAgICAgIHwgICAgICAgICAgIHwgc2QgICAgICAgIHwKfCAgICAgICAgICB8IHRhYmxlICAgICAgICAgICAgfCAgICAgICAgICAgfCBzdGwgICAgICAgIHwKfCAgICAgICAgICB8IHRhcHBseSAgICAgICAgICAgfCAgICAgICAgICAgfCB0aW1lICAgICAgICAgfAp8ICAgICAgICAgIHwgdHJ1bmMgICAgICAgICAgICB8ICAgICAgICAgICB8IHRzICAgICAgICB8CnwgICAgICAgICAgfCB0cnkgICAgICAgICAgICAgIHwgICAgICAgICAgIHwgdmNvdiAgICAgICAgfAp8IGZvcmVjYXN0IHwgYWNjdXJhY3kgICAgICAgICB8IHRpbWVEYXRlICB8IGRheU9mV2VlayAgICAgICAgfAp8ICAgICAgICAgIHwgQXJpbWEgICAgICAgICAgICB8ICAgICAgICAgICB8IEVhc3RlciAgICAgICAgfAp8ICAgICAgICAgIHwgYXV0by5hcmltYSAgICAgICB8ICAgICAgICAgICB8IGZvcm1hdCAgICAgICAgfAp8ICAgICAgICAgIHwgYXV0b3Bsb3QgICAgICAgICB8ICAgICAgICAgICB8IGlzQml6ZGF5ICAgICAgICB8CnwgICAgICAgICAgfCBhdXRvbGF5ZXIgICAgICAgIHwgICAgICAgICAgIHwgdGltZUNhbGVuZGFyICAgICAgICB8CnwgICAgICAgICAgfCBlYXN0ZXIgICAgICAgICAgIHwgICAgICAgICAgIHwgdGltZVNlcXVlbmNlICAgICAgICB8CnwgICAgICAgICAgfCBldHMgICAgICAgICAgICAgIHwgdXRpbHMgICAgIHwgcmVhZC5jc3YyICAgICAgICB8CnwgICAgICAgICAgfCBmb3JlY2FzdCAgICAgICAgIHwgICAgICAgICAgIHwgICAgIHwKfCAgICAgICAgICB8IGdnQWNmICAgICAgICAgICAgfCAgICAgICAgICAgfCAgICAgfAoKXApcClwKXAoK</div>
<footer class="footer">
  
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
<br>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.  <div class="text-muted">Website created by Iv&aacute;n Arribas. &copy;  2020. If you find any bugs please report them to <a href="mailto:ivan.arribas@uv.es"> ivan.arribas@uv.es</a>.</div>
  
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("03-14-Ejemplo-Pasajeros.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
