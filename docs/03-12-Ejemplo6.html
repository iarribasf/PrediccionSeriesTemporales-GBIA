<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Iván Arribas (Depto. Análisis Económico. Universitat de València)" />


<title>Pernoctaciones en alojamientos turísticos de turistas extranjeros</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Predicción con Datos Temporales</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="01-Guia-curso.html">
    <span class="fa fa-graduation-cap"></span>
     
    Guía del curso
  </a>
</li>
<li>
  <a href="02-Logistica.html">
    <span class="fa fa-laptop"></span>
     
    Logística
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Diapos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Teoría</li>
    <li>
      <a href="03-01-Tema1.html">Tema 1: Introducción</a>
    </li>
    <li>
      <a href="03-02-Tema2.html">Tema 2: Definición</a>
    </li>
    <li>
      <a href="03-03-Tema3.html">Tema 3: Métodos sencillos</a>
    </li>
    <li>
      <a href="03-04-Tema4.html">Tema 4: Media móvil</a>
    </li>
    <li>
      <a href="03-05-Tema5.html">Tema 5: Alisado</a>
    </li>
    <li>
      <a href="03-06-Tema6.html">Tema 6: ARIMA</a>
    </li>
    <li>
      <a href="03-07-Tema7.html">Tema 7: SARIMA</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Ejemplo de aplicación</li>
    <li>
      <a href="03-08-Ejemplo2.html">Ejemplo Tema 2</a>
    </li>
    <li>
      <a href="03-09-Ejemplo3.html">Ejemplo Tema 3</a>
    </li>
    <li>
      <a href="03-10-Ejemplo4.html">Ejemplo Tema 4</a>
    </li>
    <li>
      <a href="03-11-Ejemplo5.html">Ejemplo Tema 5</a>
    </li>
    <li>
      <a href="03-12-Ejemplo6.html">Ejemplo Tema 6</a>
    </li>
    <li>
      <a href="03-13-Ejemplo7.html">Ejemplo Tema 7</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otro ejemplo</li>
    <li>
      <a href="03-14-Ejemplo-Pasajeros.html">Ejemplo de Pasajeros</a>
    </li>
  </ul>
</li>
<li>
  <a href="04-Recursos-R.html">
    <span class="fa fa-code"></span>
     
    Recursos de R
  </a>
</li>
<li>
  <a href="05-Evaluacion_Continua.html">
    <span class="fa fa-edit"></span>
     
    Evaluacion Continua
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-download"></span>
     
    Más
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">R</li>
    <li>
      <a href="https://cran.r-project.org">Dónde está R</a>
    </li>
    <li>
      <a href="https://rstudio.com">Donde está RStudio</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Markdown</li>
    <li>
      <a href="https://bookdown.org/yihui/rmarkdown/">Markdown</a>
    </li>
    <li>
      <a href="https://rmarkdown.rstudio.com/lesson-1.html">R Markdown</a>
    </li>
    <li>
      <a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf">R Markdown (pdf)</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otros</li>
    <li>
      <a href="https://www.r-bloggers.com">Blog sobre R</a>
    </li>
    <li>
      <a href="https://bookdown.org">Libros online que debes conocer</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Pernoctaciones en alojamientos turísticos de turistas extranjeros</h1>
<h3 class="subtitle">Procesos ARIMA (sin estacionalidad)</h3>
<h4 class="author">Iván Arribas (Depto. Análisis Económico. Universitat de València)</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introducción"><span class="toc-section-number">1</span> Introducción</a></li>
<li><a href="#transformación-de-la-serie"><span class="toc-section-number">2</span> Transformación de la serie</a></li>
<li><a href="#análisis-de-la-serie-pernoctaciones-sim-i0"><span class="toc-section-number">3</span> Análisis de la serie Pernoctaciones <span class="math inline">\(\sim I(0)\)</span></a>
<ul>
<li><a href="#identificación"><span class="toc-section-number">3.1</span> Identificación</a></li>
<li><a href="#validación"><span class="toc-section-number">3.2</span> Validación</a></li>
</ul></li>
<li><a href="#análisis-de-la-serie-pernoctaciones-sim-i1"><span class="toc-section-number">4</span> Análisis de la serie Pernoctaciones <span class="math inline">\(\sim I(1)\)</span></a>
<ul>
<li><a href="#identificación-1"><span class="toc-section-number">4.1</span> Identificación</a></li>
<li><a href="#validación-1"><span class="toc-section-number">4.2</span> Validación</a></li>
</ul></li>
<li><a href="#comparativa-entre-modelos"><span class="toc-section-number">5</span> Comparativa entre modelos</a></li>
<li><a href="#interpretación-del-modelo"><span class="toc-section-number">6</span> Interpretación del modelo</a></li>
<li><a href="#predicción"><span class="toc-section-number">7</span> Predicción</a></li>
</ul>
</div>

<p><br />
<br />
</p>
<div id="introducción" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introducción</h1>
<p>Consideremos de nuevo la serie temporal correspondiente al número de pernoctaciones que los turistas extranjeros realizan en España en alojamientos turísticos autorizados (que llamaremos Pernoctaciones en adelante). Esta serie está disponible en Eurostat desde enero de 2000 hasta diciembre de 2019, un total de 20 años y 240 observaciones.</p>
<p>Para su análisis por modelos ARIMA sin estacionalidad vamos a anualizarla (20 años) y a dividirla por un millón para cambiar las unidades.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Pernoctaciones <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;./series/Pernoctaciones.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Pernoctaciones <span class="ot">&lt;-</span> <span class="fu">ts</span>(Pernoctaciones[,<span class="dv">2</span>], <span class="at">start =</span> <span class="dv">2000</span>, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Pernoctaciones <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Pernoctaciones<span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="at">FUN =</span> sum)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(Pernoctaciones,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Noches (millones)&quot;</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 1. Pernoctaciones&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">2000</span>, <span class="dv">2020</span>, <span class="dv">2</span>))  </span></code></pre></div>
<p><img src="03-12-Ejemplo6_files/figure-html/unnamed-chunk-1-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
<br />
</p>
</div>
<div id="transformación-de-la-serie" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Transformación de la serie</h1>
<p>La figura 2 muestra usa serie con tendencia. Sin embargo, vimos que el modelo de alisado que mejor ajustaba a los datos era un modelo sin tendencia y, además, la función <code>ndiffs</code> (que realiza un contraste formal de estacionariedad) también indica que la serie es estacionaria.</p>
<p>Ante esta situación se opta por explorar ambas opciones. Es decir, analizaremos la serie <span class="math inline">\(Pernoctaciones \sim I(0)\)</span> así como la serie <span class="math inline">\(Pernoctaciones \sim I(1)\)</span> y veremos cual de las dos nos ofrece mejores predicciones.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(Pernoctaciones, <span class="at">xlab =</span> <span class="st">&quot;Serie original&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">diff</span>(Pernoctaciones), <span class="at">xlab =</span> <span class="st">&quot;Serie diferenciada&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(Pernoctaciones, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;FAC&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(<span class="fu">diff</span>(Pernoctaciones), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;FAC&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="03-12-Ejemplo6_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ndiffs</span>(Pernoctaciones)</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<p><br />
<br />
</p>
</div>
<div id="análisis-de-la-serie-pernoctaciones-sim-i0" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Análisis de la serie Pernoctaciones <span class="math inline">\(\sim I(0)\)</span></h1>
<p>En este epígrafe asumiremos que la serie Pernoctaciones es estacionaria.</p>
<p><br />
</p>
<div id="identificación" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Identificación</h2>
<p>Vamos a identificar los valores de <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> a partir de <code>auto.arima</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(Pernoctaciones, <span class="at">d =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>Series: Pernoctaciones 
ARIMA(2,0,0) with non-zero mean 

Coefficients:
         ar1      ar2     mean
      1.3559  -0.4894  75.6030
s.e.  0.1874   0.2004   5.1908

sigma^2 estimated as 12.45:  log likelihood=-53.13
AIC=114.25   AICc=116.92   BIC=118.24</code></pre>
<p>Se identifica un proceso ARIMA(2, 0, 0) con constante. La estimación de este modelo muestra que los dos coeficientes estimados son aparentemente significativos y el análisis del error revela un valor que supera las 2.5 desviaciones típicas en el año 2009 (figura 3).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>arima200 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(Pernoctaciones, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.constant =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">residuals</span>(arima200)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>sderror <span class="ot">&lt;-</span> <span class="fu">sd</span>(error)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(error, <span class="at">series=</span><span class="st">&quot;Error&quot;</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Error&quot;</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 3. Error + Intervención&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="sc">*</span>sderror, </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">2000</span>, <span class="dv">2020</span>, <span class="dv">2</span>)) </span></code></pre></div>
<p><img src="03-12-Ejemplo6_files/figure-html/unnamed-chunk-6-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Creamos una variable ficticia para el año 2009 y la incluimos en el modelo. Ahora ya no se identifican más valores atípicos (figura 4).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>d2009 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(<span class="fu">time</span>(Pernoctaciones) <span class="sc">==</span> <span class="dv">2009</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>arima200 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(Pernoctaciones, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xreg =</span> d2009)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>arima200</span></code></pre></div>
<pre><code>Series: Pernoctaciones 
Regression with ARIMA(2,0,0) errors 

Coefficients:
         ar1      ar2  intercept     xreg
      1.4486  -0.5742    75.5041  -3.9615
s.e.  0.1749   0.1885     4.8489   1.5168

sigma^2 estimated as 9.794:  log likelihood=-50.3
AIC=110.61   AICc=114.89   BIC=115.58</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">residuals</span>(arima200)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sderror <span class="ot">&lt;-</span> <span class="fu">sd</span>(error)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(error, <span class="at">series=</span><span class="st">&quot;Error&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Error&quot;</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 4. Error + Intervención&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="sc">*</span>sderror, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">2000</span>, <span class="dv">2020</span>, <span class="dv">2</span>)) </span></code></pre></div>
<p><img src="03-12-Ejemplo6_files/figure-html/unnamed-chunk-7-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
<div id="validación" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Validación</h2>
<div id="variables-son-significativas" class="section level3 unnumbered">
<h3 class="unnumbered">Variables son significativas</h3>
<p>Todos dos coeficientes estimados (<span class="math inline">\(\phi_1\)</span>, <span class="math inline">\(\phi_2\)</span>, <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\gamma_{d2009}\)</span>) son significativos.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: phi1 = 0</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima200), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima200), <span class="at">Terms =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 68.6, df = 1, P(&gt; X2) = 0.00000000000000011</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: phi2 = 0</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima200), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima200), <span class="at">Terms =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 9.3, df = 1, P(&gt; X2) = 0.0023</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: constante = 0</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima200), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima200), <span class="at">Terms =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 242.5, df = 1, P(&gt; X2) = 0.0</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: d2009 =  0</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima200), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima200), <span class="at">Terms =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 6.8, df = 1, P(&gt; X2) = 0.009</code></pre>
<p><br />
</p>
</div>
<div id="medidas-de-error" class="section level3 unnumbered">
<h3 class="unnumbered">Medidas de error</h3>
<p>El error medio es 3 millones de pernoctaciones (RMSE) y el error porcentual medio es 3% (MAPE).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(arima200)</span></code></pre></div>
<pre><code>                ME RMSE  MAE   MPE MAPE MASE ACF1
Training set -0.38  2.8 2.12 -0.66 2.96 0.66 -0.1</code></pre>
</div>
<div id="error-de-previsión-extra-muestral-según-horizonte-temporal" class="section level3 unnumbered">
<h3 class="unnumbered">Error de previsión extra-muestral según horizonte temporal</h3>
<p>Asumimos que se precisan diez años para hacer una buena estimación, <span class="math inline">\(k=10\)</span>, y que el horizonte temporal es tres años vista, <span class="math inline">\(h = 3\)</span>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span>                  </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">3</span>                    </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">length</span>(Pernoctaciones)     </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> T <span class="sc">-</span> k <span class="sc">-</span> h    </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>mapeArima200 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, s <span class="sc">+</span> <span class="dv">1</span>, h)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(d2009)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>s) {</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  train.set <span class="ot">&lt;-</span> <span class="fu">subset</span>(Pernoctaciones, <span class="at">start =</span> i <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  test.set <span class="ot">&lt;-</span>  <span class="fu">subset</span>(Pernoctaciones, <span class="at">start =</span> i <span class="sc">+</span> k <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k <span class="sc">+</span> h) </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[(i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> k),])</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  hay <span class="ot">&lt;-</span> <span class="fu">colSums</span>(X.train)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> X.train[, hay<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[(i <span class="sc">+</span> k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> k <span class="sc">+</span> h),])</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> X.test[, hay<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(X.train) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(train.set, </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">include.constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xreg=</span><span class="fu">as.matrix</span>(X.train))</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(train.set, </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">include.constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(X.train) <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> h, <span class="at">xreg =</span> <span class="fu">as.matrix</span>(X.test)) <span class="cf">else</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>      fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> h)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  mapeArima200[i <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">abs</span>(test.set <span class="sc">-</span> fcast<span class="sc">$</span>mean)<span class="sc">/</span>test.set</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>mapeArima200 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(mapeArima200, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>mapeArima200</span></code></pre></div>
<pre><code>[1]  5.872216  7.925378 10.221521</code></pre>
<p>Si bien el error de previsión a uno o dos periodos vista se mantiene razonablemente bajo, para previsiones a 3 años vista alcanza el 10%. Además, que el error de previsión extra-muestral a un periodo vista es tres puntos porcentuales superior al error intra-muestral.</p>
<p><br />
<br />
</p>
</div>
</div>
</div>
<div id="análisis-de-la-serie-pernoctaciones-sim-i1" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Análisis de la serie Pernoctaciones <span class="math inline">\(\sim I(1)\)</span></h1>
<p>En este epígrafe asumiremos que la serie Pernoctaciones no es estacionaria, pero su primera diferencia sí es estacionaria.</p>
<p><br />
</p>
<div id="identificación-1" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Identificación</h2>
<p>Identificaremos los valores de <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> a partir de <code>auto.arima</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(Pernoctaciones, <span class="at">d =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>Series: Pernoctaciones 
ARIMA(0,1,0) 

sigma^2 estimated as 14.66:  log likelihood=-52.47
AIC=106.94   AICc=107.18   BIC=107.89</code></pre>
<p>Se identifica un proceso ARIMA(0, 1, 0) sin deriva, es decir un paseo aleatorio o método Ingenuo I. Tras estimar el modelo, el análisis del error revela de nuevo el año 2009 como atípico (figura 5) y significativo</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>arima010 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(Pernoctaciones, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.constant =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">residuals</span>(arima010)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>sderror <span class="ot">&lt;-</span> <span class="fu">sd</span>(error)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(error, <span class="at">series=</span><span class="st">&quot;Error&quot;</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Error&quot;</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 5. Error + Intervención&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="sc">*</span>sderror, </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">2000</span>, <span class="dv">2020</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="03-12-Ejemplo6_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>arima010 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(Pernoctaciones, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.constant =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xreg =</span> d2009)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>arima010</span></code></pre></div>
<pre><code>Series: Pernoctaciones 
Regression with ARIMA(0,1,0) errors 

Coefficients:
         xreg
      -4.8894
s.e.   2.4644

sigma^2 estimated as 12.82:  log likelihood=-50.68
AIC=105.36   AICc=106.11   BIC=107.25</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima010), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima010), <span class="at">Terms =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 3.9, df = 1, P(&gt; X2) = 0.047</code></pre>
<p><br />
</p>
</div>
<div id="validación-1" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Validación</h2>
<div id="medidas-de-error-1" class="section level3 unnumbered">
<h3 class="unnumbered">Medidas de error</h3>
<p>El error medio es 3.4 pernoctaciones (RMSE) y el error porcentual medio es 4.11% (MAPE). El modelo muestra algo de sesgo en las predicciones (mayores que el dato real) y los intervalos de confianza de las predicciones no son válidos.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(arima010)</span></code></pre></div>
<pre><code>                ME RMSE  MAE MPE MAPE MASE ACF1
Training set -0.72  3.4 2.96  -1 4.11 0.93 0.48</code></pre>
</div>
<div id="error-de-previsión-extra-muestral-según-horizonte-temporal-1" class="section level3 unnumbered">
<h3 class="unnumbered">Error de previsión extra-muestral según horizonte temporal</h3>
<p>Asumimos que se precisan diez años para hacer una buena estimación, <span class="math inline">\(k=10\)</span>, y que el horizonte temporal es tres años vista, <span class="math inline">\(h = 3\)</span>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span>                  </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">3</span>                    </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">length</span>(Pernoctaciones)     </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> T <span class="sc">-</span> k <span class="sc">-</span> h    </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>mapeArima010 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, s <span class="sc">+</span> <span class="dv">1</span>, h)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(d2009)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>s) {</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  train.set <span class="ot">&lt;-</span> <span class="fu">subset</span>(Pernoctaciones, <span class="at">start =</span> i <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  test.set <span class="ot">&lt;-</span>  <span class="fu">subset</span>(Pernoctaciones, <span class="at">start =</span> i <span class="sc">+</span> k <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k <span class="sc">+</span> h) </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[(i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> k),])</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  hay <span class="ot">&lt;-</span> <span class="fu">colSums</span>(X.train)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> X.train[, hay<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[(i <span class="sc">+</span> k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> k <span class="sc">+</span> h),])</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> X.test[, hay<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(X.train) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(train.set, </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xreg=</span><span class="fu">as.matrix</span>(X.train))</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(train.set,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(X.train) <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> h, <span class="at">xreg =</span> <span class="fu">as.matrix</span>(X.test)) <span class="cf">else</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>      fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> h)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>  mapeArima010[i <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">abs</span>(test.set <span class="sc">-</span> fcast<span class="sc">$</span>mean)<span class="sc">/</span>test.set</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>mapeArima010 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(mapeArima010, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>mapeArima010</span></code></pre></div>
<pre><code>[1] 5.418211 6.812948 8.956785</code></pre>
<p>El error de previsión varia entre el 5.4% a un periodo vista y el 9% a tres periodos vista.</p>
<p><br />
<br />
</p>
</div>
</div>
</div>
<div id="comparativa-entre-modelos" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Comparativa entre modelos</h1>
<p>Si atendemos a los indicadores de calidad de ajuste de ambos modelos, todos apuntan al proceso ARIMA(2, 0, 0) como el que mejor ajusta a los datos. El error medio (RMSE) para ARIMA(2, 0, 0) es seiscientas mil pernoctaciones menor que para ARIMA(0, 1, 0) y el error relativo es más de un punto porcentual menor. Además, el modelo ARIMA(2, 0, 0) tiene menos sesgo en las predicciones y mejores intervalos de confianza que el modelo ARIMA(0, 1, 0).</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(arima200)</span></code></pre></div>
<pre><code>                ME RMSE  MAE   MPE MAPE MASE ACF1
Training set -0.38  2.8 2.12 -0.66 2.96 0.66 -0.1</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(arima010)</span></code></pre></div>
<pre><code>                ME RMSE  MAE MPE MAPE MASE ACF1
Training set -0.72  3.4 2.96  -1 4.11 0.93 0.48</code></pre>
<p>Por el contrario, si atendemos a los errores de previsión extra-muestrales, el mejor proceso es ARIMA(0,1,0).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mapeArima200</span></code></pre></div>
<pre><code>[1]  5.87  7.93 10.22</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>mapeArima010</span></code></pre></div>
<pre><code>[1] 5.42 6.81 8.96</code></pre>
<p>Otro ejemplo más en el que mejor ajuste no implica mejor predicción. En este caso el modelo AR(2) sobreajusta (<em>overfitting</em>) los datos y genera peores predicciones a corto y medio plazo.</p>
<p>Concluimos que el mejor modelo con propósitos predictivos es <span class="math inline">\(Pernoctaciones \sim ARIMA(0, 1, 0) + AI\)</span>.</p>
<p><strong>Nota:</strong> Es la tercera vez que el método Ingenuo I (paseo aleatorio) aparece como el más adecuado para predecir la serie anual de pernoctaciones. Era el mejor de entre los métodos simples. Al elegir dentro de la familia de Alisado Exponencial, también fue el mejor. Ahora, es el proceso ARIMA más adecuado. Para esta serie, que es corta y aparentemente sencilla, ninguna aproximación compleja mejora el método Ingenuo I, más fácil de obtener e interpretar.</p>
<p><br />
<br />
</p>
</div>
<div id="interpretación-del-modelo" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Interpretación del modelo</h1>
<p>El proceso es un paseo aleatorio (ingenuo I) <span class="math inline">\(Pernoctaciones \sim ARIMA(0, 1, 0) + AI\)</span>: <span class="math display">\[(1 - L) Pernoctaciones_t = \gamma \cdot d2009 + \varepsilon_t\]</span> o <span class="math display">\[Pernoctaciones_t = Pernoctaciones_{t-1} + \gamma \cdot d2009 +  \varepsilon_t.\]</span> El modelo estimado queda: <span class="math display">\[\widehat{Pernoctaciones}_t = Pernoctaciones_{t-1} - 4.89 \cdot d2009.\]</span> Cada año el número de pernoctaciones previsto es el mismo que el del año previo. En 2009 hubo una caída en las pernoctaciones de 4.5 millones, debido a la Gran Recesión.</p>
<p><br />
<br />
</p>
</div>
<div id="predicción" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Predicción</h1>
<p>Podemos usar el modelo estimado para predecir las pernoctaciones para los próximos 5 años.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>parima010 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(arima010, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">h =</span> <span class="dv">5</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">level =</span> <span class="dv">95</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xreg =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>parima010</span></code></pre></div>
<pre><code>     Point Forecast    Lo 95    Hi 95
2020       75.70578 68.68752 82.72404
2021       75.70578 65.78046 85.63110
2022       75.70578 63.54979 87.86176
2023       75.70578 61.66926 89.74230
2024       75.70578 60.01247 91.39908</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(parima010, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Noches (millones)&quot;</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Figura 6. Pernoctaciones&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">2000</span>, <span class="dv">2022</span>, <span class="dv">2</span>)) </span></code></pre></div>
<p><img src="03-12-Ejemplo6_files/figure-html/unnamed-chunk-27-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
<br />
<br />
<br />
</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiUGVybm9jdGFjaW9uZXMgZW4gYWxvamFtaWVudG9zIHR1csOtc3RpY29zIGRlIHR1cmlzdGFzIGV4dHJhbmplcm9zIgpzdWJ0aXRsZTogIlByb2Nlc29zIEFSSU1BIChzaW4gZXN0YWNpb25hbGlkYWQpIgphdXRob3I6ICJJdsOhbiBBcnJpYmFzIChEZXB0by4gQW7DoWxpc2lzIEVjb27Ds21pY28uIFVuaXZlcnNpdGF0IGRlIFZhbMOobmNpYSkiCm91dHB1dDogCiAgaHRtbF9kb2N1bWVudDoKICAgIHRoZW1lOiBjZXJ1bGVhbgogICAgaGlnaGxpZ2h0OiBweWdtZW50cyAKICAgIGZpZ19jYXB0aW9uOiBmYWxzZQogICAgZGZfcHJpbnQ6IGthYmxlCiAgICB0b2M6IHRydWUKICAgIHRvY19kZXB0aDogMgogICAgbnVtYmVyX3NlY3Rpb25zOiB0cnVlCiAgICBzZWxmX2NvbnRhaW5lZDogdHJ1ZQogICAgY29kZV9kb3dubG9hZDogdHJ1ZQotLS0KCmBgYHtyIGNodW5rX3NldHVwLCBlY2hvID0gRkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldCh3YXJuaW5nID0gRkFMU0UsIAogICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IEZBTFNFLCAKICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQgPSAiIiwKICAgICAgICAgICAgICAgICAgICAgIGZpZy5hbGlnbiA9ICJjZW50ZXIiLCAKICAgICAgICAgICAgICAgICAgICAgIGZpZy5zaG93ID0gImhvbGQiLAogICAgICAgICAgICAgICAgICAgICAgZmlnLmhlaWdodCA9IDQsCiAgICAgICAgICAgICAgICAgICAgICBmaWcud2lkdGggPSA4LAogICAgICAgICAgICAgICAgICAgICAgb3V0LndpZHRoID0gIjgwJSIpIApgYGAKCmBgYHtyIGxpYnJlcmlhcywgZWNobyA9IEZBTFNFfQpsaWJyYXJ5KGZvcmVjYXN0KQpsaWJyYXJ5KGdncGxvdDIpOyB0aGVtZV9zZXQodGhlbWVfYncoKSkKbGlicmFyeShncmlkRXh0cmEpCmxpYnJhcnkoZ3JpZCkKbGlicmFyeShhb2QpCmBgYAoKXApcCgojIEludHJvZHVjY2nDs24KCkNvbnNpZGVyZW1vcyBkZSBudWV2byBsYSBzZXJpZSB0ZW1wb3JhbCBjb3JyZXNwb25kaWVudGUgYWwgbsO6bWVybyBkZSBwZXJub2N0YWNpb25lcyBxdWUgbG9zIHR1cmlzdGFzIGV4dHJhbmplcm9zIHJlYWxpemFuIGVuIEVzcGHDsWEgZW4gYWxvamFtaWVudG9zIHR1csOtc3RpY29zIGF1dG9yaXphZG9zIChxdWUgbGxhbWFyZW1vcyBQZXJub2N0YWNpb25lcyBlbiBhZGVsYW50ZSkuIEVzdGEgc2VyaWUgZXN0w6EgZGlzcG9uaWJsZSBlbiBFdXJvc3RhdCBkZXNkZSBlbmVybyBkZSAyMDAwIGhhc3RhIGRpY2llbWJyZSBkZSAyMDE5LCB1biB0b3RhbCBkZSAyMCBhw7FvcyB5IDI0MCBvYnNlcnZhY2lvbmVzLgoKUGFyYSBzdSBhbsOhbGlzaXMgcG9yIG1vZGVsb3MgQVJJTUEgc2luIGVzdGFjaW9uYWxpZGFkIHZhbW9zIGEgYW51YWxpemFybGEgKDIwIGHDsW9zKSB5IGEgZGl2aWRpcmxhIHBvciB1biBtaWxsw7NuIHBhcmEgY2FtYmlhciBsYXMgdW5pZGFkZXMuCgpgYGB7cn0KUGVybm9jdGFjaW9uZXMgPC0gcmVhZC5jc3YyKCIuL3Nlcmllcy9QZXJub2N0YWNpb25lcy5jc3YiLCBoZWFkZXIgPSBUUlVFKQpQZXJub2N0YWNpb25lcyA8LSB0cyhQZXJub2N0YWNpb25lc1ssMl0sIHN0YXJ0ID0gMjAwMCwgZnJlcXVlbmN5ID0gMTIpClBlcm5vY3RhY2lvbmVzIDwtIGFnZ3JlZ2F0ZShQZXJub2N0YWNpb25lcy8xMF42LCBGVU4gPSBzdW0pCgphdXRvcGxvdChQZXJub2N0YWNpb25lcywKICAgICAgICAgeGxhYiA9ICIiLAogICAgICAgICB5bGFiID0gIk5vY2hlcyAobWlsbG9uZXMpIiwKICAgICAgICAgbWFpbiA9ICJGaWd1cmEgMS4gUGVybm9jdGFjaW9uZXMiKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcz0gc2VxKDIwMDAsIDIwMjAsIDIpKSAgCmBgYAoKXApcCgojIFRyYW5zZm9ybWFjacOzbiBkZSBsYSBzZXJpZQoKTGEgZmlndXJhIDIgbXVlc3RyYSB1c2Egc2VyaWUgY29uIHRlbmRlbmNpYS4gU2luIGVtYmFyZ28sIHZpbW9zIHF1ZSBlbCBtb2RlbG8gZGUgYWxpc2FkbyBxdWUgbWVqb3IgYWp1c3RhYmEgYSBsb3MgZGF0b3MgZXJhIHVuIG1vZGVsbyBzaW4gdGVuZGVuY2lhIHksIGFkZW3DoXMsIGxhIGZ1bmNpw7NuIGBuZGlmZnNgIChxdWUgcmVhbGl6YSB1biBjb250cmFzdGUgZm9ybWFsIGRlIGVzdGFjaW9uYXJpZWRhZCkgdGFtYmnDqW4gaW5kaWNhIHF1ZSBsYSBzZXJpZSBlcyBlc3RhY2lvbmFyaWEuCgpBbnRlIGVzdGEgc2l0dWFjacOzbiBzZSBvcHRhIHBvciBleHBsb3JhciBhbWJhcyBvcGNpb25lcy4gRXMgZGVjaXIsIGFuYWxpemFyZW1vcyBsYSBzZXJpZSAkUGVybm9jdGFjaW9uZXMgXHNpbSBJKDApJCBhc8OtIGNvbW8gbGEgc2VyaWUgJFBlcm5vY3RhY2lvbmVzIFxzaW0gSSgxKSQgeSB2ZXJlbW9zIGN1YWwgZGUgbGFzIGRvcyBub3Mgb2ZyZWNlIG1lam9yZXMgcHJlZGljY2lvbmVzLgoKCmBgYHtyLCBldmFsID0gRkFMU0V9CmF1dG9wbG90KFBlcm5vY3RhY2lvbmVzLCB4bGFiID0gIlNlcmllIG9yaWdpbmFsIiwgeWxhYiA9ICIiLCBtYWluID0gIiIpCmF1dG9wbG90KGRpZmYoUGVybm9jdGFjaW9uZXMpLCB4bGFiID0gIlNlcmllIGRpZmVyZW5jaWFkYSIsIHlsYWIgPSAiIiwgbWFpbiA9ICIiKQpnZ0FjZihQZXJub2N0YWNpb25lcywgeGxhYiA9ICIiLCB5bGFiID0gIkZBQyIsIG1haW4gPSAiIikKZ2dBY2YoZGlmZihQZXJub2N0YWNpb25lcyksIHhsYWIgPSAiIiwgeWxhYiA9ICJGQUMiLCBtYWluID0gIiIpCmBgYAoKYGBge3IsIGVjaG8gPSBGQUxTRX0KZ3JpZC5hcnJhbmdlKAogIGF1dG9wbG90KFBlcm5vY3RhY2lvbmVzLCB4bGFiID0gIlNlcmllIG9yaWdpbmFsIiwgeWxhYiA9ICIiLCBtYWluID0gIkZpZ3VyYSAyLiBQZXJub2N0YWNpb25lcyIpLAogIGF1dG9wbG90KGRpZmYoUGVybm9jdGFjaW9uZXMpLCB4bGFiID0gIlNlcmllIGRpZmVyZW5jaWFkYSIsIHlsYWIgPSAiIiwgbWFpbiA9ICIiKSwKICBnZ0FjZihQZXJub2N0YWNpb25lcywgeGxhYiA9ICIiLCB5bGFiID0gIkZBQyIsIG1haW4gPSAiIiksCiAgZ2dBY2YoZGlmZihQZXJub2N0YWNpb25lcyksIHhsYWIgPSAiIiwgeWxhYiA9ICJGQUMiLCBtYWluID0gIiIpLAogIG5yb3cgPSAyCikKYGBgCgpgYGB7cn0KbmRpZmZzKFBlcm5vY3RhY2lvbmVzKQpgYGAKClwKXAoKIyBBbsOhbGlzaXMgZGUgbGEgc2VyaWUgUGVybm9jdGFjaW9uZXMgJFxzaW0gSSgwKSQKCkVuIGVzdGUgZXDDrWdyYWZlIGFzdW1pcmVtb3MgcXVlIGxhIHNlcmllIFBlcm5vY3RhY2lvbmVzIGVzIGVzdGFjaW9uYXJpYS4KClwKCiMjIElkZW50aWZpY2FjacOzbgoKVmFtb3MgYSBpZGVudGlmaWNhciBsb3MgdmFsb3JlcyBkZSAkcCQgeSAkcSQgYSBwYXJ0aXIgZGUgYGF1dG8uYXJpbWFgLgoKYGBge3J9IAphdXRvLmFyaW1hKFBlcm5vY3RhY2lvbmVzLCBkID0gMCkKYGBgCgpTZSBpZGVudGlmaWNhIHVuIHByb2Nlc28gQVJJTUEoMiwgMCwgMCkgY29uIGNvbnN0YW50ZS4gTGEgZXN0aW1hY2nDs24gZGUgZXN0ZSBtb2RlbG8gbXVlc3RyYSBxdWUgbG9zIGRvcyBjb2VmaWNpZW50ZXMgZXN0aW1hZG9zIHNvbiBhcGFyZW50ZW1lbnRlIHNpZ25pZmljYXRpdm9zIHkgZWwgYW7DoWxpc2lzIGRlbCBlcnJvciByZXZlbGEgdW4gdmFsb3IgcXVlIHN1cGVyYSBsYXMgMi41IGRlc3ZpYWNpb25lcyB0w61waWNhcyBlbiBlbCBhw7FvIDIwMDkgKGZpZ3VyYSAzKS4KCmBgYHtyfQphcmltYTIwMCA8LSBBcmltYShQZXJub2N0YWNpb25lcywgCiAgICAgICAgICAgICAgICAgIG9yZGVyID0gYygyLCAwLCAwKSwKICAgICAgICAgICAgICAgICAgaW5jbHVkZS5jb25zdGFudCA9IFRSVUUpCgplcnJvciA8LSByZXNpZHVhbHMoYXJpbWEyMDApCnNkZXJyb3IgPC0gc2QoZXJyb3IpCgphdXRvcGxvdChlcnJvciwgc2VyaWVzPSJFcnJvciIsCiAgICAgICAgIGNvbG91ciA9ICJibGFjayIsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICJFcnJvciIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDMuIEVycm9yICsgSW50ZXJ2ZW5jacOzbiIpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSBjKC0zLCAtMiwgMiwgMykqc2RlcnJvciwgCiAgICAgICAgICAgICBjb2xvdXIgPSBjKCJyZWQiLCAiZ3JlZW4iLCAiZ3JlZW4iLCAicmVkIiksIAogICAgICAgICAgICAgbHR5ID0gMikgKyAKICBnZW9tX3BvaW50KCkgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgyMDAwLCAyMDIwLCAyKSkgCmBgYAoKQ3JlYW1vcyB1bmEgdmFyaWFibGUgZmljdGljaWEgcGFyYSBlbCBhw7FvIDIwMDkgeSBsYSBpbmNsdWltb3MgZW4gZWwgbW9kZWxvLiBBaG9yYSB5YSBubyBzZSBpZGVudGlmaWNhbiBtw6FzIHZhbG9yZXMgYXTDrXBpY29zIChmaWd1cmEgNCkuCgpgYGB7cn0KZDIwMDkgPC0gMSoodGltZShQZXJub2N0YWNpb25lcykgPT0gMjAwOSkKYXJpbWEyMDAgPC0gQXJpbWEoUGVybm9jdGFjaW9uZXMsIAogICAgICAgICAgICAgICAgICBvcmRlciA9IGMoMiwgMCwgMCksCiAgICAgICAgICAgICAgICAgIGluY2x1ZGUuY29uc3RhbnQgPSBUUlVFLAogICAgICAgICAgICAgICAgICB4cmVnID0gZDIwMDkpCmFyaW1hMjAwCgplcnJvciA8LSByZXNpZHVhbHMoYXJpbWEyMDApCnNkZXJyb3IgPC0gc2QoZXJyb3IpCgphdXRvcGxvdChlcnJvciwgc2VyaWVzPSJFcnJvciIsCiAgICAgICAgIGNvbG91ciA9ICJibGFjayIsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICJFcnJvciIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDQuIEVycm9yICsgSW50ZXJ2ZW5jacOzbiIpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSBjKC0zLCAtMiwgMiwgMykqc2RlcnJvciwgCiAgICAgICAgICAgICBjb2xvdXIgPSBjKCJyZWQiLCAiZ3JlZW4iLCAiZ3JlZW4iLCAicmVkIiksIAogICAgICAgICAgICAgbHR5ID0gMikgKyAKICBnZW9tX3BvaW50KCkgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgyMDAwLCAyMDIwLCAyKSkgCmBgYAoKXAoKIyMgVmFsaWRhY2nDs24KCiMjIyBWYXJpYWJsZXMgc29uIHNpZ25pZmljYXRpdmFzIHstfQoKVG9kb3MgZG9zIGNvZWZpY2llbnRlcyBlc3RpbWFkb3MgKCRccGhpXzEkLCAkXHBoaV8yJCwgJFxtdSQgeSAkXGdhbW1hX3tkMjAwOX0kKSBzb24gc2lnbmlmaWNhdGl2b3MuCgpgYGB7cn0KIyBIMDogcGhpMSA9IDAKd2FsZC50ZXN0KGIgPSBjb2VmKGFyaW1hMjAwKSwgU2lnbWEgPSB2Y292KGFyaW1hMjAwKSwgVGVybXMgPSAxKQojIEgwOiBwaGkyID0gMAp3YWxkLnRlc3QoYiA9IGNvZWYoYXJpbWEyMDApLCBTaWdtYSA9IHZjb3YoYXJpbWEyMDApLCBUZXJtcyA9IDIpCiMgSDA6IGNvbnN0YW50ZSA9IDAKd2FsZC50ZXN0KGIgPSBjb2VmKGFyaW1hMjAwKSwgU2lnbWEgPSB2Y292KGFyaW1hMjAwKSwgVGVybXMgPSAzKQojIEgwOiBkMjAwOSA9ICAwCndhbGQudGVzdChiID0gY29lZihhcmltYTIwMCksIFNpZ21hID0gdmNvdihhcmltYTIwMCksIFRlcm1zID0gNCkKCmBgYAoKXAoKIyMjIE1lZGlkYXMgZGUgZXJyb3Igey19CgpFbCBlcnJvciBtZWRpbyBlcyBgciByb3VuZChhY2N1cmFjeShhcmltYTIwMClbMl0sMClgIG1pbGxvbmVzIGRlIHBlcm5vY3RhY2lvbmVzIChSTVNFKSB5IGVsIGVycm9yIHBvcmNlbnR1YWwgbWVkaW8gZXMgYHIgcm91bmQoYWNjdXJhY3koYXJpbWEyMDApWzVdLDEpYCUgKE1BUEUpLgoKYGBge3IsIGV2YWw9RkFMU0V9CmFjY3VyYWN5KGFyaW1hMjAwKQpgYGAKCmBgYHtyLGVjaG89RkFMU0V9CnJvdW5kKGFjY3VyYWN5KGFyaW1hMjAwKSwyKQpgYGAKCiMjIyBFcnJvciBkZSBwcmV2aXNpw7NuIGV4dHJhLW11ZXN0cmFsIHNlZ8O6biBob3Jpem9udGUgdGVtcG9yYWwgey19CgpBc3VtaW1vcyBxdWUgc2UgcHJlY2lzYW4gZGlleiBhw7FvcyBwYXJhIGhhY2VyIHVuYSBidWVuYSBlc3RpbWFjacOzbiwgJGs9MTAkLCB5IHF1ZSBlbCBob3Jpem9udGUgdGVtcG9yYWwgZXMgdHJlcyBhw7FvcyB2aXN0YSwgJGggPSAzJC4gCiAgCmBgYHtyfSAgCmsgPC0gMTAgICAgICAgICAgICAgICAgICAKaCA8LSAzICAgICAgICAgICAgICAgICAgICAKVCA8LSBsZW5ndGgoUGVybm9jdGFjaW9uZXMpICAgICAKcyA8LSBUIC0gayAtIGggICAgCgptYXBlQXJpbWEyMDAgPC0gbWF0cml4KE5BLCBzICsgMSwgaCkKClggPC0gZGF0YS5mcmFtZShkMjAwOSkKCmZvciAoaSBpbiAwOnMpIHsKICB0cmFpbi5zZXQgPC0gc3Vic2V0KFBlcm5vY3RhY2lvbmVzLCBzdGFydCA9IGkgKyAxLCBlbmQgPSBpICsgaykKICB0ZXN0LnNldCA8LSAgc3Vic2V0KFBlcm5vY3RhY2lvbmVzLCBzdGFydCA9IGkgKyBrICsgMSwgZW5kID0gaSArIGsgKyBoKSAKICAKICBYLnRyYWluIDwtIGRhdGEuZnJhbWUoWFsoaSArIDEpOihpICsgayksXSkKICBoYXkgPC0gY29sU3VtcyhYLnRyYWluKQogIFgudHJhaW4gPC0gWC50cmFpblssIGhheT4wXQogIAogIFgudGVzdCA8LSBkYXRhLmZyYW1lKFhbKGkgKyBrICsgMSk6KGkgKyBrICsgaCksXSkKICBYLnRlc3QgPC0gWC50ZXN0WywgaGF5PjBdCiAgCiAgaWYgKGxlbmd0aChYLnRyYWluKSA+IDApIHsKICAgIGZpdCA8LSBBcmltYSh0cmFpbi5zZXQsIAogICAgICAgICAgICAgICAgIG9yZGVyID0gYygyLCAwLCAwKSwKICAgICAgICAgICAgICAgICBpbmNsdWRlLmNvbnN0YW50ID0gVFJVRSwKICAgICAgICAgICAgICAgICB4cmVnPWFzLm1hdHJpeChYLnRyYWluKSkKICB9IGVsc2UgewogICAgZml0IDwtIEFyaW1hKHRyYWluLnNldCwgCiAgICAgICAgICAgICAgICAgaW5jbHVkZS5jb25zdGFudCA9IFRSVUUsCiAgICAgICAgICAgICAgICAgb3JkZXIgPSBjKDIsIDAsIDApKQogIH0KICAKICAKICBpZiAobGVuZ3RoKFgudHJhaW4pID4gMCkgCiAgICBmY2FzdCA8LSBmb3JlY2FzdChmaXQsIGggPSBoLCB4cmVnID0gYXMubWF0cml4KFgudGVzdCkpIGVsc2UKICAgICAgZmNhc3QgPC0gZm9yZWNhc3QoZml0LCBoID0gaCkKICAKICBtYXBlQXJpbWEyMDBbaSArIDEsXSA8LSAxMDAqYWJzKHRlc3Quc2V0IC0gZmNhc3QkbWVhbikvdGVzdC5zZXQKICAKfQoKbWFwZUFyaW1hMjAwIDwtIGNvbE1lYW5zKG1hcGVBcmltYTIwMCwgbmEucm0gPSBUUlVFKQptYXBlQXJpbWEyMDAKYGBgCgpTaSBiaWVuIGVsIGVycm9yIGRlIHByZXZpc2nDs24gYSB1bm8gbyBkb3MgcGVyaW9kb3MgdmlzdGEgc2UgbWFudGllbmUgcmF6b25hYmxlbWVudGUgYmFqbywgcGFyYSBwcmV2aXNpb25lcyBhIDMgYcOxb3MgdmlzdGEgYWxjYW56YSBlbCAxMCUuIEFkZW3DoXMsIHF1ZSBlbCBlcnJvciBkZSBwcmV2aXNpw7NuIGV4dHJhLW11ZXN0cmFsIGEgdW4gcGVyaW9kbyB2aXN0YSBlcyB0cmVzIHB1bnRvcyBwb3JjZW50dWFsZXMgc3VwZXJpb3IgYWwgZXJyb3IgaW50cmEtbXVlc3RyYWwuCgpcClwKCiMgQW7DoWxpc2lzIGRlIGxhIHNlcmllIFBlcm5vY3RhY2lvbmVzICRcc2ltIEkoMSkkCgpFbiBlc3RlIGVww61ncmFmZSBhc3VtaXJlbW9zIHF1ZSBsYSBzZXJpZSBQZXJub2N0YWNpb25lcyBubyBlcyBlc3RhY2lvbmFyaWEsIHBlcm8gc3UgcHJpbWVyYSBkaWZlcmVuY2lhIHPDrSBlcyBlc3RhY2lvbmFyaWEuCgpcCgojIyBJZGVudGlmaWNhY2nDs24KCklkZW50aWZpY2FyZW1vcyBsb3MgdmFsb3JlcyBkZSAkcCQgeSAkcSQgYSBwYXJ0aXIgZGUgYGF1dG8uYXJpbWFgLgoKYGBge3J9IAphdXRvLmFyaW1hKFBlcm5vY3RhY2lvbmVzLCBkID0gMSkKYGBgCgpTZSBpZGVudGlmaWNhIHVuIHByb2Nlc28gQVJJTUEoMCwgMSwgMCkgc2luIGRlcml2YSwgZXMgZGVjaXIgdW4gcGFzZW8gYWxlYXRvcmlvIG8gbcOpdG9kbyBJbmdlbnVvIEkuIFRyYXMgZXN0aW1hciBlbCBtb2RlbG8sIGVsIGFuw6FsaXNpcyBkZWwgZXJyb3IgcmV2ZWxhIGRlIG51ZXZvIGVsIGHDsW8gMjAwOSBjb21vIGF0w61waWNvIChmaWd1cmEgNSkgeSBzaWduaWZpY2F0aXZvCgpgYGB7cn0KYXJpbWEwMTAgPC0gQXJpbWEoUGVybm9jdGFjaW9uZXMsIAogICAgICAgICAgICAgICAgICBvcmRlciA9IGMoMCwgMSwgMCksCiAgICAgICAgICAgICAgICAgIGluY2x1ZGUuY29uc3RhbnQgPSBGQUxTRSkKCmVycm9yIDwtIHJlc2lkdWFscyhhcmltYTAxMCkKc2RlcnJvciA8LSBzZChlcnJvcikKCmF1dG9wbG90KGVycm9yLCBzZXJpZXM9IkVycm9yIiwKICAgICAgICAgY29sb3VyID0gImJsYWNrIiwKICAgICAgICAgeGxhYiA9ICIiLAogICAgICAgICB5bGFiID0gIkVycm9yIiwKICAgICAgICAgbWFpbiA9ICJGaWd1cmEgNS4gRXJyb3IgKyBJbnRlcnZlbmNpw7NuIikgKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IGMoLTMsIC0yLCAyLCAzKSpzZGVycm9yLCAKICAgICAgICAgICAgIGNvbG91ciA9IGMoInJlZCIsICJncmVlbiIsICJncmVlbiIsICJyZWQiKSwgCiAgICAgICAgICAgICBsdHkgPSAyKSArIAogIGdlb21fcG9pbnQoKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcz0gc2VxKDIwMDAsIDIwMjAsIDIpKQpgYGAKCgpgYGB7cn0KYXJpbWEwMTAgPC0gQXJpbWEoUGVybm9jdGFjaW9uZXMsIAogICAgICAgICAgICAgICAgICBvcmRlciA9IGMoMCwgMSwgMCksCiAgICAgICAgICAgICAgICAgIGluY2x1ZGUuY29uc3RhbnQgPSBGQUxTRSwKICAgICAgICAgICAgICAgICAgeHJlZyA9IGQyMDA5KQphcmltYTAxMAoKd2FsZC50ZXN0KGIgPSBjb2VmKGFyaW1hMDEwKSwgU2lnbWEgPSB2Y292KGFyaW1hMDEwKSwgVGVybXMgPSAxKQpgYGAKClwKCiMjIFZhbGlkYWNpw7NuCgojIyMgTWVkaWRhcyBkZSBlcnJvciB7LX0KCkVsIGVycm9yIG1lZGlvIGVzIGByIHJvdW5kKGFjY3VyYWN5KGFyaW1hMDEwKVsyXSwxKWAgcGVybm9jdGFjaW9uZXMgKFJNU0UpIHkgZWwgZXJyb3IgcG9yY2VudHVhbCBtZWRpbyBlcyBgciByb3VuZChhY2N1cmFjeShhcmltYTAxMClbNV0sMilgJSAoTUFQRSkuIEVsIG1vZGVsbyBtdWVzdHJhIGFsZ28gZGUgc2VzZ28gZW4gbGFzIHByZWRpY2Npb25lcyAobWF5b3JlcyBxdWUgZWwgZGF0byByZWFsKSB5IGxvcyBpbnRlcnZhbG9zIGRlIGNvbmZpYW56YSBkZSBsYXMgcHJlZGljY2lvbmVzIG5vIHNvbiB2w6FsaWRvcy4KCmBgYHtyLCBldmFsPUZBTFNFfQphY2N1cmFjeShhcmltYTAxMCkKYGBgCgpgYGB7cixlY2hvPUZBTFNFfQpyb3VuZChhY2N1cmFjeShhcmltYTAxMCksMikKYGBgCgojIyMgRXJyb3IgZGUgcHJldmlzacOzbiBleHRyYS1tdWVzdHJhbCBzZWfDum4gaG9yaXpvbnRlIHRlbXBvcmFsIHstfQoKQXN1bWltb3MgcXVlIHNlIHByZWNpc2FuIGRpZXogYcOxb3MgcGFyYSBoYWNlciB1bmEgYnVlbmEgZXN0aW1hY2nDs24sICRrPTEwJCwgeSBxdWUgZWwgaG9yaXpvbnRlIHRlbXBvcmFsIGVzIHRyZXMgYcOxb3MgdmlzdGEsICRoID0gMyQuCiAgCmBgYHtyfSAgCmsgPC0gMTAgICAgICAgICAgICAgICAgICAKaCA8LSAzICAgICAgICAgICAgICAgICAgICAKVCA8LSBsZW5ndGgoUGVybm9jdGFjaW9uZXMpICAgICAKcyA8LSBUIC0gayAtIGggICAgCgptYXBlQXJpbWEwMTAgPC0gbWF0cml4KE5BLCBzICsgMSwgaCkKClggPC0gZGF0YS5mcmFtZShkMjAwOSkKCmZvciAoaSBpbiAwOnMpIHsKICB0cmFpbi5zZXQgPC0gc3Vic2V0KFBlcm5vY3RhY2lvbmVzLCBzdGFydCA9IGkgKyAxLCBlbmQgPSBpICsgaykKICB0ZXN0LnNldCA8LSAgc3Vic2V0KFBlcm5vY3RhY2lvbmVzLCBzdGFydCA9IGkgKyBrICsgMSwgZW5kID0gaSArIGsgKyBoKSAKICAKICBYLnRyYWluIDwtIGRhdGEuZnJhbWUoWFsoaSArIDEpOihpICsgayksXSkKICBoYXkgPC0gY29sU3VtcyhYLnRyYWluKQogIFgudHJhaW4gPC0gWC50cmFpblssIGhheT4wXQogIAogIFgudGVzdCA8LSBkYXRhLmZyYW1lKFhbKGkgKyBrICsgMSk6KGkgKyBrICsgaCksXSkKICBYLnRlc3QgPC0gWC50ZXN0WywgaGF5PjBdCiAgCiAgaWYgKGxlbmd0aChYLnRyYWluKSA+IDApIHsKICAgIGZpdCA8LSBBcmltYSh0cmFpbi5zZXQsIAogICAgICAgICAgICAgICAgIG9yZGVyID0gYygwLCAxLCAwKSwKICAgICAgICAgICAgICAgICB4cmVnPWFzLm1hdHJpeChYLnRyYWluKSkKICB9IGVsc2UgewogICAgZml0IDwtIEFyaW1hKHRyYWluLnNldCwKICAgICAgICAgICAgICAgICBvcmRlciA9IGMoMCwgMSwgMCkpCiAgfQogIAogIAogIGlmIChsZW5ndGgoWC50cmFpbikgPiAwKSAKICAgIGZjYXN0IDwtIGZvcmVjYXN0KGZpdCwgaCA9IGgsIHhyZWcgPSBhcy5tYXRyaXgoWC50ZXN0KSkgZWxzZQogICAgICBmY2FzdCA8LSBmb3JlY2FzdChmaXQsIGggPSBoKQogIAogIG1hcGVBcmltYTAxMFtpICsgMSxdIDwtIDEwMCphYnModGVzdC5zZXQgLSBmY2FzdCRtZWFuKS90ZXN0LnNldAogIAp9CgptYXBlQXJpbWEwMTAgPC0gY29sTWVhbnMobWFwZUFyaW1hMDEwLCBuYS5ybSA9IFRSVUUpCm1hcGVBcmltYTAxMApgYGAKCkVsIGVycm9yIGRlIHByZXZpc2nDs24gdmFyaWEgZW50cmUgZWwgNS40JSBhIHVuIHBlcmlvZG8gdmlzdGEgeSBlbCA5JSBhIHRyZXMgcGVyaW9kb3MgdmlzdGEuCgpcClwKCiMgQ29tcGFyYXRpdmEgZW50cmUgbW9kZWxvcwoKU2kgYXRlbmRlbW9zIGEgbG9zIGluZGljYWRvcmVzIGRlIGNhbGlkYWQgZGUgYWp1c3RlIGRlIGFtYm9zIG1vZGVsb3MsIHRvZG9zIGFwdW50YW4gYWwgcHJvY2VzbyBBUklNQSgyLCAwLCAwKSBjb21vIGVsIHF1ZSBtZWpvciBhanVzdGEgYSBsb3MgZGF0b3MuIEVsIGVycm9yIG1lZGlvIChSTVNFKSBwYXJhIEFSSU1BKDIsIDAsIDApIGVzIHNlaXNjaWVudGFzIG1pbCBwZXJub2N0YWNpb25lcyBtZW5vciBxdWUgcGFyYSBBUklNQSgwLCAxLCAwKSB5IGVsIGVycm9yIHJlbGF0aXZvIGVzIG3DoXMgZGUgdW4gcHVudG8gcG9yY2VudHVhbCBtZW5vci4gQWRlbcOhcywgZWwgbW9kZWxvIEFSSU1BKDIsIDAsIDApIHRpZW5lIG1lbm9zIHNlc2dvIGVuIGxhcyBwcmVkaWNjaW9uZXMgeSBtZWpvcmVzIGludGVydmFsb3MgZGUgY29uZmlhbnphIHF1ZSBlbCBtb2RlbG8gQVJJTUEoMCwgMSwgMCkuCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQphY2N1cmFjeShhcmltYTIwMCkKYGBgCgpgYGB7ciwgZWNobyA9IEZBTFNFfQpyb3VuZChhY2N1cmFjeShhcmltYTIwMCksIDIpCmBgYAoKYGBge3IsIGV2YWwgPSBGQUxTRX0KYWNjdXJhY3koYXJpbWEwMTApCmBgYAoKYGBge3IsIGVjaG8gPSBGQUxTRX0Kcm91bmQoYWNjdXJhY3koYXJpbWEwMTApLCAyKQpgYGAKClBvciBlbCBjb250cmFyaW8sIHNpIGF0ZW5kZW1vcyBhIGxvcyBlcnJvcmVzIGRlIHByZXZpc2nDs24gZXh0cmEtbXVlc3RyYWxlcywgZWwgbWVqb3IgcHJvY2VzbyBlcyBBUklNQSgwLDEsMCkuCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQptYXBlQXJpbWEyMDAKYGBgCgpgYGB7ciwgZWNobyA9IEZBTFNFfQpyb3VuZChtYXBlQXJpbWEyMDAsIDIpCmBgYAoKYGBge3IsIGV2YWwgPSBGQUxTRX0KbWFwZUFyaW1hMDEwCmBgYAoKYGBge3IsIGVjaG8gPSBGQUxTRX0Kcm91bmQobWFwZUFyaW1hMDEwLCAyKQpgYGAKCk90cm8gZWplbXBsbyBtw6FzIGVuIGVsIHF1ZSBtZWpvciBhanVzdGUgbm8gaW1wbGljYSBtZWpvciBwcmVkaWNjacOzbi4gRW4gZXN0ZSBjYXNvIGVsIG1vZGVsbyBBUigyKSBzb2JyZWFqdXN0YSAoX292ZXJmaXR0aW5nXykgbG9zIGRhdG9zIHkgZ2VuZXJhIHBlb3JlcyBwcmVkaWNjaW9uZXMgYSBjb3J0byB5IG1lZGlvIHBsYXpvLgoKQ29uY2x1aW1vcyBxdWUgZWwgbWVqb3IgbW9kZWxvIGNvbiBwcm9ww7NzaXRvcyBwcmVkaWN0aXZvcyBlcyAkUGVybm9jdGFjaW9uZXMgXHNpbSBBUklNQSgwLCAxLCAwKSArIEFJJC4KCioqTm90YToqKiBFcyBsYSB0ZXJjZXJhIHZleiBxdWUgZWwgbcOpdG9kbyBJbmdlbnVvIEkgKHBhc2VvIGFsZWF0b3JpbykgYXBhcmVjZSBjb21vIGVsIG3DoXMgYWRlY3VhZG8gcGFyYSBwcmVkZWNpciBsYSBzZXJpZSBhbnVhbCBkZSBwZXJub2N0YWNpb25lcy4gRXJhIGVsIG1lam9yIGRlIGVudHJlIGxvcyBtw6l0b2RvcyBzaW1wbGVzLiBBbCBlbGVnaXIgZGVudHJvIGRlIGxhIGZhbWlsaWEgZGUgQWxpc2FkbyBFeHBvbmVuY2lhbCwgdGFtYmnDqW4gZnVlIGVsIG1lam9yLiBBaG9yYSwgZXMgZWwgcHJvY2VzbyBBUklNQSBtw6FzIGFkZWN1YWRvLiBQYXJhIGVzdGEgc2VyaWUsIHF1ZSBlcyBjb3J0YSB5IGFwYXJlbnRlbWVudGUgc2VuY2lsbGEsIG5pbmd1bmEgYXByb3hpbWFjacOzbiBjb21wbGVqYSBtZWpvcmEgZWwgbcOpdG9kbyBJbmdlbnVvIEksIG3DoXMgZsOhY2lsIGRlIG9idGVuZXIgZSBpbnRlcnByZXRhci4KIApcClwKCiMgSW50ZXJwcmV0YWNpw7NuIGRlbCBtb2RlbG8KCkVsIHByb2Nlc28gZXMgdW4gcGFzZW8gYWxlYXRvcmlvIChpbmdlbnVvIEkpICRQZXJub2N0YWNpb25lcyBcc2ltIEFSSU1BKDAsIDEsIDApICsgQUkkOgokJCgxIC0gTCkgUGVybm9jdGFjaW9uZXNfdCA9IFxnYW1tYSBcY2RvdCBkMjAwOSArIFx2YXJlcHNpbG9uX3QkJApvCiQkUGVybm9jdGFjaW9uZXNfdCA9IFBlcm5vY3RhY2lvbmVzX3t0LTF9ICsgXGdhbW1hIFxjZG90IGQyMDA5ICsgIFx2YXJlcHNpbG9uX3QuJCQKRWwgbW9kZWxvIGVzdGltYWRvIHF1ZWRhOgokJFx3aWRlaGF0e1Blcm5vY3RhY2lvbmVzfV90ID0gUGVybm9jdGFjaW9uZXNfe3QtMX0gLSA0Ljg5IFxjZG90IGQyMDA5LiQkCkNhZGEgYcOxbyBlbCBuw7ptZXJvIGRlIHBlcm5vY3RhY2lvbmVzIHByZXZpc3RvIGVzIGVsIG1pc21vIHF1ZSBlbCBkZWwgYcOxbyBwcmV2aW8uIEVuIDIwMDkgaHVibyB1bmEgY2HDrWRhIGVuIGxhcyBwZXJub2N0YWNpb25lcyBkZSA0LjUgbWlsbG9uZXMsIGRlYmlkbyBhIGxhIEdyYW4gUmVjZXNpw7NuLgoKCgpcClwKCiMgUHJlZGljY2nDs24KClBvZGVtb3MgdXNhciBlbCBtb2RlbG8gZXN0aW1hZG8gcGFyYSBwcmVkZWNpciBsYXMgcGVybm9jdGFjaW9uZXMgcGFyYSBsb3MgcHLDs3hpbW9zIDUgYcOxb3MuCgpgYGB7cn0KcGFyaW1hMDEwIDwtIGZvcmVjYXN0KGFyaW1hMDEwLCAKICAgICAgICAgICAgICAgICAgICAgIGggPSA1LCAKICAgICAgICAgICAgICAgICAgICAgIGxldmVsID0gOTUsCiAgICAgICAgICAgICAgICAgICAgICB4cmVnID0gcmVwKDAsIDUpKQpwYXJpbWEwMTAKYGBgCgpgYGB7cn0KYXV0b3Bsb3QocGFyaW1hMDEwLCAKICAgICB5bGFiID0gIk5vY2hlcyAobWlsbG9uZXMpIiwKICAgICBtYWluID0gIkZpZ3VyYSA2LiBQZXJub2N0YWNpb25lcyIpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzPSBzZXEoMjAwMCwgMjAyMiwgMikpIApgYGAKClwKXApcClwKCgoKCgoK</div>
<footer class="footer">
  
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
<br>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.  <div class="text-muted">Website created by Iv&aacute;n Arribas. &copy;  2020. If you find any bugs please report them to <a href="mailto:ivan.arribas@uv.es"> ivan.arribas@uv.es</a>.</div>
  
</footer>





</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("03-12-Ejemplo6.Rmd");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
