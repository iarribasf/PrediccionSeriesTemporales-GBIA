<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Iván Arribas (Depto. Análisis Económico. Universitat de València)" />


<title>Métodos sencillos de predicción. Evaluación de predicciones</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Predicción con Datos Temporales</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="01-Guia-curso.html">
    <span class="fa fa-graduation-cap"></span>
     
    Guía del curso
  </a>
</li>
<li>
  <a href="02-Logistica.html">
    <span class="fa fa-laptop"></span>
     
    Logística
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Diapos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Teoría</li>
    <li>
      <a href="03-01-Tema1.html">Tema 1: Introducción</a>
    </li>
    <li>
      <a href="03-02-Tema2.html">Tema 2: Definición</a>
    </li>
    <li>
      <a href="03-03-Tema3.html">Tema 3: Métodos sencillos</a>
    </li>
    <li>
      <a href="03-04-Tema4.html">Tema 4: Media móvil</a>
    </li>
    <li>
      <a href="03-05-Tema5.html">Tema 5: Alisado</a>
    </li>
    <li>
      <a href="03-06-Tema6.html">Tema 6: ARIMA</a>
    </li>
    <li>
      <a href="03-07-Tema7.html">Tema 7: SARIMA</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Ejemplo de aplicación</li>
    <li>
      <a href="03-08-Ejemplo2.html">Ejemplo Tema 2</a>
    </li>
    <li>
      <a href="03-09-Ejemplo3.html">Ejemplo Tema 3</a>
    </li>
    <li>
      <a href="03-10-Ejemplo4.html">Ejemplo Tema 4</a>
    </li>
    <li>
      <a href="03-11-Ejemplo5.html">Ejemplo Tema 5</a>
    </li>
    <li>
      <a href="03-12-Ejemplo6.html">Ejemplo Tema 6</a>
    </li>
    <li>
      <a href="03-13-Ejemplo7.html">Ejemplo Tema 7</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otro ejemplo</li>
    <li>
      <a href="03-14-Ejemplo-Pasajeros.html">Ejemplo de Pasajeros</a>
    </li>
  </ul>
</li>
<li>
  <a href="04-Recursos-R.html">
    <span class="fa fa-code"></span>
     
    Recursos de R
  </a>
</li>
<li>
  <a href="05-Evaluacion_Continua.html">
    <span class="fa fa-edit"></span>
     
    Evaluacion Continua
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-download"></span>
     
    Más
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">R</li>
    <li>
      <a href="https://cran.r-project.org">Dónde está R</a>
    </li>
    <li>
      <a href="https://rstudio.com">Donde está RStudio</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Markdown</li>
    <li>
      <a href="https://bookdown.org/yihui/rmarkdown/">Markdown</a>
    </li>
    <li>
      <a href="https://rmarkdown.rstudio.com/lesson-1.html">R Markdown</a>
    </li>
    <li>
      <a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf">R Markdown (pdf)</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otros</li>
    <li>
      <a href="https://www.r-bloggers.com">Blog sobre R</a>
    </li>
    <li>
      <a href="https://bookdown.org">Libros online que debes conocer</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Métodos sencillos de predicción. Evaluación de predicciones</h1>
<h3 class="subtitle">Previsión con Datos Temporales (GBIA)</h3>
<h4 class="author">Iván Arribas (Depto. Análisis Económico. Universitat de València)</h4>

</div>


<p><br />
<br />
</p>
<div id="introducción" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introducción</h1>
<p>En muchos casos es preciso aplicar un método de predicción rápido y sencillo:</p>
<ul>
<li>A causa del elevado número de series que tienen que ser analizadas.</li>
<li>Debido a la rapidez con que las predicciones se han de dar.</li>
</ul>
<p>Actualmente existen muchos métodos sencillos de predicción, entre lo que cabe destacar dos:</p>
<ul>
<li><strong>Métodos de media móvil</strong> (Tema 4).</li>
<li><strong>Métodos de alisado exponencial</strong> (Tema 5).</li>
</ul>
<p>Estas técnicas, a pesar de su sencillez, son bastante adecuadas cuando la previsión es a corto plazo:</p>
<blockquote>
<p>“Statistically sophisticated or complex methods do not necessarily produce more accurate forecasts than simpler ones.” Makridakis y Hibon (2000).</p>
</blockquote>
<p>Pero hay métodos aún más sencillos que quedan englobados bajo el paraguas de <strong>métodos sencillos</strong> que veremos en este tema.</p>
<p><br />
<br />
</p>
</div>
<div id="criterios-de-calidad" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Criterios de calidad</h1>
<p>En este tema y en los siguientes se verán diferentes métodos para predecir una serie temporal. Así, es preciso definir criterios de bondad de ajuste que permitan estimar tanto la calidad del ajuste como de las predicciones de un método.</p>
<blockquote>
<p>“The rankings of the performance of the various methods vary according to the accuracy measure being used.” Makridakis y Hibon (2000).</p>
</blockquote>
<p><br />
</p>
<div id="notación-y-definiciones" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Notación y definiciones</h2>
<p>Dada una serie temporal <span class="math inline">\(\{y_t\}_{t=1}^T\)</span>, se define:</p>
<ul>
<li><strong>Previsión <span class="math inline">\(h\)</span> periodos adelante</strong>, como la previsión de la serie para el periodo <span class="math inline">\(t+h\)</span> disponiendo de información hasta el periodo <span class="math inline">\(t\)</span>, y se denota por <span class="math inline">\(\hat{y}_{t+h|t}\)</span>. Por simplicidad lo escribiremos también como <span class="math inline">\(\hat{y}_{t+h}\)</span>.</li>
</ul>
<ul>
<li>Así, <span class="math inline">\(\hat{y}_{t+1|t}\)</span> es la <strong>previsión un periodo adelante</strong> o a un periodo vista. Es decir, la previsión de la serie en <span class="math inline">\(t+1\)</span> desde el periodo <span class="math inline">\(t\)</span>.</li>
</ul>
<ul>
<li>De nuevo, por simplicidad denotaremos a <span class="math inline">\(\hat{y}_{t+1|t}\)</span> como <span class="math inline">\(\hat{y}_{t+1}\)</span>; y como <span class="math inline">\(\hat{y}_{t}\)</span> a la previsión en <span class="math inline">\(t\)</span>, con datos hasta el periodo <span class="math inline">\(t-1\)</span> (<span class="math inline">\(\hat{y}_{t} = \hat{y}_{t|t-1}\)</span>).</li>
</ul>
<p>Se define como <strong>error de previsión</strong> a un periodo vista a <span class="math display">\[\hat{e}_t=y_t-\hat{y}_t,\]</span> de forma que la serie <span class="math inline">\(\{\hat{e}_t\}_{t=1}^T\)</span> nos permitirá definir varios criterios de calidad de ajuste.</p>
<p><br />
</p>
</div>
<div id="medidas-de-precisión-de-la-predicción" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Medidas de precisión de la predicción</h2>
<p>Dada una serie <span class="math inline">\(\{y_t\}_{t=1}^T\)</span>, un método de predicción y su vector de errores asociado <span class="math inline">\(\{\hat{e}_t\}_{t=1}^T\)</span>, podemos definir múltiples medidas de calidad del método de predicción que hacen referencia a la presencia de sesgo en las predicciones, la magnitud del error cometido y la calidad del intervalo de confianza de las predicciones. Las más habituales son (siglas en inglés):</p>
<ul>
<li>Error medio (ME): <span class="math inline">\(\frac{1}{T}\sum_{t=1}^T \hat{e}_t\)</span></li>
</ul>
<ul>
<li><strong>Raíz del error cuadrático medio (RMSE)</strong>: <span class="math inline">\(\sqrt{\frac{1}{T}\sum_{t=1}^T \hat{e}^2_t}\)</span></li>
</ul>
<ul>
<li>Error absoluto medio (MAE): <span class="math inline">\(\frac{1}{T}\sum_{t=1}^T |\hat{e}_t|\)</span></li>
</ul>
<ul>
<li>Error porcentual medio (MPE): <span class="math inline">\(\frac{100}{T}\sum_{t=1}^T \frac{\hat{e}_t}{y_t}\)</span></li>
</ul>
<ul>
<li><strong>Error porcentual absoluto medio (MAPE)</strong>: <span class="math inline">\(\frac{100}{T}\sum_{t=1}^T \big|\frac{\hat{e}_t}{y_t}\big|\)</span></li>
</ul>
<ul>
<li>Error porcentual absoluto medio simétrico (sMAPE): <span class="math inline">\(\frac{200}{T}\sum_{t=1}^T \Big|\frac{\hat{e}_t}{y_t + \hat{y}_t}\Big|\)</span></li>
</ul>
<ul>
<li>Error escalado absoluto medio (MASE): <span class="math inline">\(\big(\frac{1}{T}\sum_{t=1}^T |\hat{e}_t|\big)/q\)</span>, donde <span class="math inline">\(q\)</span> es el error absoluto medio para un método ingenuo de predicción:
<ul>
<li><span class="math inline">\(q=\frac{1}{T-1}\sum_{t=2}^T |y_t-y_{t-1}|\)</span> para series <em>sin</em> estacionalidad</li>
<li><span class="math inline">\(q=\frac{1}{T-m}\sum_{t=m+1}^T |y_t-y_{t-m}|\)</span> para series <em>con</em> estacionalidad</li>
</ul></li>
</ul>
<ul>
<li>Correlación entre <span class="math inline">\(\hat{e}_t\)</span> y <span class="math inline">\(\hat{e}_{t-1}\)</span> (ACF1).</li>
</ul>
<p><br />
</p>
<p>ME y MPE permiten valorar el sesgo de las predicciones (que estas estén sistemáticamente por encima o por debajo de los valores reales).</p>
<ul>
<li>Lo esperado es un valor cercano a cero (con relación al valor medio de la serie). Valores muy alejados de cero son indicadores de sesgo de predicción.</li>
</ul>
<p>RMSE y MAE indican el error medio cometido, medido en las mismas unidades que la serie temporal.</p>
<ul>
<li>Están acotadas inferiormente por el valor óptimo de 0, pero no hay cota superior.</li>
</ul>
<p>MAPE y sMAPE indican el error porcentual medio cometido.</p>
<ul>
<li>Están acotadas inferiormente por el valor óptimo de 0%, y la cota superior natural es 100%, aunque podría sobrepasarse.</li>
<li>Si <span class="math inline">\(y_t\)</span> puede valer 0, entonces MAPE no se puede calcular. Además, MAPE penaliza más los errores negativos frente a los errores positivos. La medida de precisión sMAPE se define a fin de corregir estos problemas.</li>
</ul>
<p>MASE es la ratio entre el error del método usado y el error de un método ingenuo de predicción. Permite saber cuánto ganamos en capacidad predictiva al pasar de un método ingenuo a otro más complicado.</p>
<ul>
<li>Un valor cercano a 1 indica que el método usado no es mejor que el método ingenuo</li>
<li>Cuanto más cercano a 0, mejor es el método usado respecto del método ingenuo</li>
<li>Su complementario a 1 se puede interpretar como la tasa de mejora</li>
</ul>
<p>ACF1 evalúa la capacidad de mejora que hay en la estimación del intervalo de confianza de las predicciones. Lo veremos con más detalle en el tema de modelos ARIMA. Por ahora basta saber que:</p>
<ul>
<li>Un valor muy cercano a 0 indica que hay poca capacidad de mejora.</li>
<li>Un valor cercano a 1 o -1 indica que hay mucha capacidad de mejora.</li>
</ul>
<p>Las <em>medias</em> se pueden sustituir por <em>medianas</em>. Esto es especialmente útil cuando para algunas observaciones hay errores atípicamente altos.</p>
<p><br />
</p>
<p>Si para realizar la predicción del periodo <span class="math inline">\(t\)</span> se usa una metodología que utiliza datos hasta dicho periodo, se hablará de <strong>predicción y error intra-muestral</strong>. En caso contrario, la predicción del periodo <span class="math inline">\(t\)</span> usa una metodología que solo necesita de datos hasta el periodo <span class="math inline">\(t-1\)</span>, se hablará de <strong>predicción y error extra-muestral</strong>.</p>
<p>Si los indicadores de calidad se basan en predicciones intra-muestrales a un periodo vista, presentan dos problemas. Primero, evalúan el error de predicción a un periodo vista, cuando en muchas situaciones reales las predicciones se realizan sobre un horizonte temporal más amplio. Segundo, son errores intra-muestrales, resultantes de predecir los mismos datos que sha usado el método para calcular la predicción y, por tanto, sobre-estiman la capacidad predictiva del modelo.</p>
<p>Veremos durante en este tema métodos de evaluación de la calidad de las predicciones que superan estas limitaciones.</p>
<p><br />
<br />
</p>
</div>
</div>
<div id="métodos-sencillos-de-predicción" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Métodos sencillos de predicción</h1>
<p>Algunos métodos de predicción son extremadamente sencillos y sorprendentemente eficaces. A veces son denominados métodos ingenuos. Estos métodos:</p>
<ul>
<li>posibilitan realizar predicciones prácticamente sin realizar ningún cálculo.</li>
<li>como son muy sencillos, dan las previsiones con mayor error (menos precisas). El error de un método sencillo sirve de punto de referencia (<em>benchmark</em>) para valorar la necesidad de aplicar otros métodos más complicados con el objetivo de mejorar la calidad de las predicciones.</li>
</ul>
<p>Veamos algunos métodos sencillos y sus funciones en el paquete <code>forecast</code>.</p>
<p><br />
</p>
<div id="métodos-sencillos-de-predicción-1" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Métodos sencillos de predicción</h2>
<div id="series-sin-tendencia-y-sin-estacionalidad" class="section level3 unnumbered">
<h3 class="unnumbered">Series <em>sin</em> tendencia y <em>sin</em> estacionalidad</h3>
<p><strong>Método de la Media</strong>: <span class="math inline">\(\hat{y}_{T+h}=(y_1+\ldots,y_T)/T\)</span>.</p>
<ul>
<li>La predicción para cualquier periodo futuro es la <strong>media</strong> de las observaciones disponibles previas.</li>
<li>Función de <code>R</code>: <code>meanf(y, h)</code></li>
</ul>
<p><strong>Método ingenuo I</strong>: <span class="math inline">\(\hat{y}_{T+h}=y_T\)</span>.</p>
<ul>
<li>La predicción para cualquier periodo futuro es la <strong>última</strong> observación disponible.</li>
<li>Función de <code>R</code>: <code>naive(y, h)</code> o <code>rwf(y, h)</code> (<em>rw</em> de random walk)</li>
<li>Para series sin estacionalidad este es el método ingenuo de comparación del MASE.</li>
</ul>
</div>
<div id="series-con-tendencia-y-sin-estacionalidad" class="section level3 unnumbered">
<h3 class="unnumbered">Series <em>con</em> tendencia y <em>sin</em> estacionalidad</h3>
<p><strong>Método ingenuo II</strong>: <span class="math inline">\(\hat{y}_{T+h}=y_T + h(y_T-y_{T-1})\)</span>.</p>
<ul>
<li>La predicción <span class="math inline">\(h\)</span> periodos adelante es la <strong>última observación</strong> disponible más <span class="math inline">\(h\)</span> veces el <strong>último incremento</strong> observado.</li>
<li>No tiene función en <code>R</code>, pero se podría emular mediante la función <code>holt</code> (véase epígrafe de 5.5 Alisado exponencial de Holt).</li>
</ul>
<p><strong>Método de la deriva</strong>: <span class="math inline">\(\hat{y}_{T+h}=y_T+h\frac{y_T - y_1}{T-1}\)</span>.</p>
<ul>
<li>La predicción <span class="math inline">\(h\)</span> periodos adelante es la <strong>última observación</strong> disponible más <span class="math inline">\(h\)</span> veces el <strong>incremento medio</strong> observado.</li>
<li>Función de <code>R</code>: <code>rwf(y, h, drift = TRUE)</code></li>
</ul>
</div>
<div id="series-sin-tendencia-y-con-estacionalidad" class="section level3 unnumbered">
<h3 class="unnumbered">Series <em>sin</em> tendencia y <em>con</em> estacionalidad</h3>
<p><strong>Método ingenuo con estacionalidad</strong>: <span class="math inline">\(\hat{y}_{T+h}=y_{T-m(k+1)}\)</span>.</p>
<ul>
<li><span class="math inline">\(k\)</span> es la parte entera de <span class="math inline">\((h-1)/m\)</span>, es decir, el número de años completos en el periodo de predicción previo al periodo <span class="math inline">\(T+h\)</span>.</li>
<li>La predicción para un periodo es la <strong>última observación disponible de la misma estación que la fecha que se desea predecir</strong>.</li>
<li>Función de <code>R</code>: <code>snaive(y, h)</code></li>
<li>Para series con estacionalidad este es el método ingenuo de comparación del MASE</li>
</ul>
<p><strong>No hay métodos sencillos cuando la serie tiene tendencia y estacionalidad</strong>, aunque la aplicación del método ingenuo con estacionalidad suele ser muy efectiva.</p>
<p><br />
</p>
</div>
</div>
<div id="ejemplo-de-aplicación" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Ejemplo de aplicación</h2>
<div id="serie-libros" class="section level3 unnumbered">
<h3 class="unnumbered">Serie Libros</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>libros <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;./series/libros.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>libros <span class="ot">&lt;-</span> <span class="fu">ts</span>(libros[ ,<span class="dv">2</span>], <span class="at">start =</span> <span class="dv">1993</span>, <span class="at">frequency  =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>En la figura 1 se muestra el resultado gráfico de la aplicación de algunos de estos métodos sencillos a la serie Libros (número de títulos publicados anualmente en España desde 1993 hasta 2018), con independencia de su adecuación dadas las componentes de esta serie. Se ha fijado un horizonte de previsión de cinco años (<code>h = 5</code>). El argumento <code>PI = FALSE</code> hace que no se impriman los intervalos de confianza de las predicciones.</p>
<p>Los métodos de la Media e Ingenuo I realizan una predicción constante, el primero la media de títulos en el periodo de análisis (61786) y el segundo el último dato observado (62180). El método de deriva ofrece una predicción creciente porque la serie Libros tiene una pendiente media positiva en el periodo de análisis.</p>
<p>Recuerda que debes cargar las librerías <code>forecast</code> y <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(mediaLibros <span class="ot">&lt;-</span> <span class="fu">meanf</span>(libros, <span class="at">h =</span> <span class="dv">5</span>))</span></code></pre></div>
<pre><code>     Point Forecast   Lo 80    Hi 80    Lo 95    Hi 95
2019       61786.23 47291.7 76280.76 39108.25 84464.21
2020       61786.23 47291.7 76280.76 39108.25 84464.21
2021       61786.23 47291.7 76280.76 39108.25 84464.21
2022       61786.23 47291.7 76280.76 39108.25 84464.21
2023       61786.23 47291.7 76280.76 39108.25 84464.21</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(naiveLibros <span class="ot">&lt;-</span> <span class="fu">naive</span>(libros, <span class="at">h =</span> <span class="dv">5</span>))</span></code></pre></div>
<pre><code>     Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
2019          62180 54474.50 69885.50 50395.46 73964.54
2020          62180 51282.78 73077.22 45514.14 78845.86
2021          62180 48833.68 75526.32 41768.57 82591.43
2022          62180 46769.00 77591.00 38610.91 85749.09
2023          62180 44949.98 79410.02 35828.96 88531.04</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(derivaLibros <span class="ot">&lt;-</span> <span class="fu">rwf</span>(libros,  <span class="at">h =</span> <span class="dv">5</span>, <span class="at">drift =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>     Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
2019       63036.88 55252.76 70821.00 51132.10 74941.66
2020       63893.76 52667.34 75120.18 46724.44 81063.08
2021       64750.64 50739.23 78762.05 43322.03 86179.25
2022       65607.52 49131.65 82083.39 40409.84 90805.20
2023       66464.40 47717.76 85211.04 37793.89 95134.91</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(libros, <span class="at">series =</span> <span class="st">&quot;Libros&quot;</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> <span class="st">&quot;Títulos&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">main =</span> <span class="st">&quot;Figura 1. Libros y predicción por métodos sencillos&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(mediaLibros, <span class="at">series=</span><span class="st">&quot;Media&quot;</span>, <span class="at">PI =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(naiveLibros, <span class="at">series=</span><span class="st">&quot;Ingenuo&quot;</span>, <span class="at">PI =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(derivaLibros, <span class="at">series=</span><span class="st">&quot;Deriva&quot;</span>, <span class="at">PI =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;Libros&quot;</span>, <span class="st">&quot;Media&quot;</span>, <span class="st">&quot;Ingenuo&quot;</span>, <span class="st">&quot;Deriva&quot;</span>)) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Métodos&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="fu">c</span>(<span class="fl">0.02</span>,<span class="fl">0.98</span>), <span class="at">legend.justification=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="03-03-Tema3_files/figure-html/unnamed-chunk-2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Con la función <code>accuracy</code> se puede obtener el error de predicción intra-muestral a un periodo vista de cada método:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(mediaLibros)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(naiveLibros)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(derivaLibros)</span></code></pre></div>
<pre><code>              ME     RMSE     MAE   MPE  MAPE MASE  ACF1
Media       0.00 10595.53 8155.92 -3.17 14.03 1.76  0.77
Ingenuo I 856.88  6012.63 4626.40  1.27  7.30 1.00 -0.04
Deriva      0.00  5951.26 4364.46 -0.13  6.87 0.94 -0.04</code></pre>
<p>Podemos destacar que:</p>
<ul>
<li>El método de <em>Media</em> presenta una baja calidad de ajuste debido a que la serie Libros tiene tendencia (MAPE = 14%). Además, el intervalo de confianza de las predicciones no es fiable (ACF1 = 0.77).</li>
<li>El método de <em>Deriva</em> tiene la mejor calidad de ajuste, con un error porcentual del 6.9% (MAPE), y un error medio aproximado de 6,000 títulos (RMSE). No presenta sesgo (ME = 0) y el intervalo de confianza de las predicciones es fiable (ACF1 = -0.04).</li>
<li>El método <em>Ingenuo I</em> tiene buena calidad de ajuste, pero las previsiones están ligeramente sesgadas (ME = 857).</li>
<li>Para series sin estacionalidad el método sencillo de comparación usado en el cálculo del MASE es el <em>Ingenuo I</em>. Es por ello que este indicador vale 1 para este método.</li>
<li>El error medio (ME) siempre será nulo para el método de la <em>Media</em> y de la <em>Deriva</em>, lo que indica que nos equivocamos tanto por exceso como por defecto. Esta es una buena propiedad, que el método <em>Ingenuo I</em> no verifica.</li>
</ul>
</div>
<div id="serie-nacimientos" class="section level3 unnumbered">
<h3 class="unnumbered">Serie Nacimientos</h3>
<p>Podemos usar el método ingenuo con estacionalidad con la serie Nacimientos para obtener una previsión a dos años vista. El error absoluto porcentual medio es del 3.6%. Es decir, aplicando algo tan simple como predecir el número de nacimientos para un mes como los nacimientos del mismo mes del año previo, tenemos ya un error de predicción muy bajo. La figura 2 muestra la serie y la predicción que, debido al método usado, no incorpora la tendencia decreciente de los últimos años.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>nacimientos <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;./series/nacimientos.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>nacimientos <span class="ot">&lt;-</span> <span class="fu">ts</span>(nacimientos[, <span class="dv">2</span>],</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1975</span>, <span class="dv">1</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>(snaive.nacimientos <span class="ot">&lt;-</span> <span class="fu">snaive</span>(nacimientos, <span class="at">h =</span> <span class="dv">24</span>, <span class="at">level =</span> <span class="dv">95</span>))</span></code></pre></div>
<pre><code>         Point Forecast   Lo 95   Hi 95
Jan 2019          31772 28378.6 35165.4
Feb 2019          28211 24817.6 31604.4
Mar 2019          30340 26946.6 33733.4
Apr 2019          29436 26042.6 32829.4
May 2019          31061 27667.6 34454.4
Jun 2019          30546 27152.6 33939.4
Jul 2019          32521 29127.6 35914.4
Aug 2019          33059 29665.6 36452.4
Sep 2019          31406 28012.6 34799.4
Oct 2019          33059 29665.6 36452.4
Nov 2019          30696 27302.6 34089.4
Dec 2019          30670 27276.6 34063.4
Jan 2020          31772 26973.0 36571.0
Feb 2020          28211 23412.0 33010.0
Mar 2020          30340 25541.0 35139.0
Apr 2020          29436 24637.0 34235.0
May 2020          31061 26262.0 35860.0
Jun 2020          30546 25747.0 35345.0
Jul 2020          32521 27722.0 37320.0
Aug 2020          33059 28260.0 37858.0
Sep 2020          31406 26607.0 36205.0
Oct 2020          33059 28260.0 37858.0
Nov 2020          30696 25897.0 35495.0
Dec 2020          30670 25871.0 35469.0</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(snaive.nacimientos)</span></code></pre></div>
<pre><code>                    ME     RMSE      MAE       MPE     MAPE MASE      ACF1
Training set -574.8081 1731.361 1396.684 -1.456378 3.647108    1 0.7179587</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(snaive.nacimientos,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Nacimientos&quot;</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 2. Nacimientos y predicción por el método Ingenuo con estacionalidad&quot;</span>)</span></code></pre></div>
<p><img src="03-03-Tema3_files/figure-html/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
<br />
</p>
</div>
</div>
</div>
<div id="evaluación-de-las-predicciones" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Evaluación de las predicciones</h1>
<p>Las medidas que hemos usado hasta ahora para valorar la calidad de las predicciones son realmente medidas de bondad de ajuste, es decir, medidas de la calidad de <strong>previsiones intra-muestrales a un periodo vista</strong>. Valoran en que medida los datos se ajustan a un patrón o modelo, pero no evalúan la calidad de la previsiones ante nuevos datos.</p>
<p>En este epígrafe vamos a ver dos metodologías que podemos usar para valorar la calidad de las <strong>previsiones extra-muestrales</strong>, que es realmente los que nos interesa. Estas dos metodologías están relacionadas con los métodos de <em>Training set/Test set</em> y <em>Cross-validation</em> que viste en <em>Previsión con datos transversales</em>, pero adaptadas a datos temporales.</p>
<div id="validación-por-la-metodología-de-training-settest-set-para-series-temporales" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Validación por la metodología de <em>Training set/Test set</em> para Series Temporales</h2>
<p>Vamos a mejorar la estimación de la calidad de las predicciones obteniendo las medidas de error para <strong>previsiones extra-muestrales a varios periodos vista</strong> usando la filosofía del método <em>training set/test set</em>. Dividimos la serie temporal <span class="math inline">\(\{y_t\}_{t=1}^T\)</span> en dos subseries, los primeros datos <span class="math inline">\(\{y_t\}_{t=1}^{T_0}\)</span>, <span class="math inline">\(T_0 &lt; T\)</span> se usarán para estimar el modelo, y los últimos datos <span class="math inline">\(\{y_t\}_{t={T_0+1}}^{T}\)</span> para validar el modelo.</p>
<p>Esta metodología, muy efectiva para datos de corte transversal, genera dos problemas cuando se aplica a series temporales: <em>i</em>) el error obtenido es una mezcla de errores de predicción a corto, medio y largo plazo difícil de valorar; <em>ii</em>) los resultados dependen tremendamente del punto de corte temporal seleccionado.</p>
<div id="serie-libros-1" class="section level3 unnumbered">
<h3 class="unnumbered">Serie Libros</h3>
<p>Vamos a reservar, por ejemplo, las últimas 6 observaciones de la serie Libros y ajustar el modelo con las restantes. Después usaremos este modelo para calcular las predicciones a 6 periodos vista y compararlas con los valores reales de la serie.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos las observaciones intra- y extra-muestrales</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>librosIntra <span class="ot">&lt;-</span> <span class="fu">subset</span>(libros, <span class="at">end =</span> <span class="fu">length</span>(libros) <span class="sc">-</span> <span class="dv">6</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>librosExtra <span class="ot">&lt;-</span> <span class="fu">subset</span>(libros, <span class="at">start =</span> <span class="fu">length</span>(libros) <span class="sc">-</span> <span class="dv">5</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimamos el modelo con todos los datos menos los 6 ultimos y</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># predecimos los 6 años que hemos quitado de la serie </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>librosExtraPre <span class="ot">&lt;-</span> <span class="fu">rwf</span>(librosIntra,  <span class="at">h =</span> <span class="dv">6</span>, <span class="at">drift =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Vemos la calidad del ajuste. Primero la predicción y luego los datos reales</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(librosExtraPre, librosExtra)</span></code></pre></div>
<pre><code>                    ME     RMSE      MAE    MPE  MAPE MASE  ACF1 Theil&#39;s U
Training set      0.00  5863.85  4279.52  -0.05  6.53 0.87 -0.19        NA
Test set     -15759.36 15817.29 15759.36 -26.65 26.65 3.22 -0.24      6.19</code></pre>
<p>Atendiendo al MAPE se tiene que el error de <strong>previsión a un periodo vista</strong> en el <strong>periodo intra-muestral</strong> de <strong>1993 a 2012</strong> es del 6.5%; mientras que el error de <strong>previsión a largo plazo</strong> en el <strong>periodo extra-muestral</strong> de <strong>2013 a 2018</strong> es del 26.6%. Ademas, para el periodo extra-muestral el error medio (ME) es negativo y muy elevado, un indicativo de que las previsiones están segadas (sobre-estiman la realidad). En resumen, la calidad del modelo se deteriora muy rápidamente en cuanto nos salimos de las condiciones óptimas.</p>
<p>Un gráfico puede ayudar a entender este proceso de validación. En la figura 3:</p>
<ul>
<li>La línea de puntos vertical separa el periodo muestral (1993-2012) usado para estimar el modelo, del periodo extra-muestral (2013-2018) usado sólo para hacer las previsiones.</li>
<li>La serie Libros aparece como una línea sólida en negro, desde 1993 hasta 2018.</li>
<li>La previsión <em>intra</em>-muestral (a un periodo vista) de la serie Libros aparece como una línea azul.</li>
<li>La línea en rojo es la previsión <em>extra</em>-muestral a largo plazo. Observa que todas las previsiones están por encima del valor real de la serie.</li>
<li>Al lado de cada previsión (intra- y extra-muestral) se ha indicado el error estimado (MAPE).</li>
</ul>
<p>Claramente estos resultados dependen del punto de corte seleccionado.</p>
<p><img src="03-03-Tema3_files/figure-html/unnamed-chunk-8-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="serie-nacimientos-1" class="section level3 unnumbered">
<h3 class="unnumbered">Serie Nacimientos</h3>
<p>Calculamos de nuevo los diferentes criterios de bondad de ajuste para valorar la calidad de las previsiones extra-muestrales a largo plazo. En este caso vamos a reservar los últimos 36 meses como periodo extra-muestral.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>nacimientosIntra <span class="ot">&lt;-</span> <span class="fu">subset</span>(nacimientos, <span class="at">end =</span> <span class="fu">length</span>(nacimientos) <span class="sc">-</span> <span class="dv">36</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>nacimientosExtra <span class="ot">&lt;-</span> <span class="fu">subset</span>(nacimientos, <span class="at">start =</span> <span class="fu">length</span>(nacimientos) <span class="sc">-</span> <span class="dv">35</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>nacimientosExtraPre <span class="ot">&lt;-</span> <span class="fu">snaive</span>(nacimientosIntra, <span class="at">h =</span> <span class="dv">36</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(nacimientosExtraPre, nacimientosExtra)</span></code></pre></div>
<pre><code>                   ME    RMSE     MAE   MPE MAPE MASE ACF1 Theil&#39;s U
Training set  -518.93 1742.83 1394.96 -1.26 3.59 1.00 0.72        NA
Test set     -2342.47 2783.26 2440.75 -7.37 7.66 1.75 0.68      1.68</code></pre>
<p><img src="03-03-Tema3_files/figure-html/unnamed-chunk-11-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Las previsiones extra-muestrales muestran una menor pendiente que los casos reales de nacimientos. Así, conforme se avanza en el horizonte temporal las previsiones se van alejando de la realidad y el error extra-muestral es del 7.7%, reducido pero que duplica el error de estimación intra-muestral (3.6%).</p>
<p><br />
</p>
</div>
</div>
<div id="validación-cruzada-para-series-temporales" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Validación cruzada para Series Temporales</h2>
<p>Hemos visto dos alternativas para evaluar la calidad de un método de predicción de series temporales, uno basado en predicciones intra-muestrales a un periodo vista y otro basado en predicciones extra-muestrales a largo plazo, ambas con sus inconvenientes.</p>
<p>Veamos ahora una técnica, basada en el concepto de validación cruzada (<em>cross validation</em>) que permite obtener de forma individualizada los errores de previsión extra-muestral a un periodo vista, a dos periodos vista, etc.</p>
<p>Supongamos que para estimar el modelo se necesita un mínimo de <span class="math inline">\(k\)</span> observaciones y que se desea predecir hasta un horizonte temporal <span class="math inline">\(h\)</span>.</p>
<ul>
<li><p>Seleccionamos las observaciones <span class="math inline">\(1,2,...,k\)</span> para estimar el modelo y predecimos las observaciones desde <span class="math inline">\(k+1\)</span> hasta <span class="math inline">\(k+h\)</span>. Tenemos, por tanto, <span class="math inline">\(h\)</span> predicciones.</p></li>
<li><p>Calculamos el error de predicción para las predicciones desde <span class="math inline">\(k+1\)</span> hasta <span class="math inline">\(k+h\)</span>.</p></li>
<li><p>Repetimos este proceso desplazando el número de observaciones seleccionadas para la estimación un periodo adelante. Es decir, ahora usamos las observaciones <span class="math inline">\(2,3,...,k+1\)</span> para estimar el modelo, predecimos las observaciones desde <span class="math inline">\(k+2\)</span> hasta <span class="math inline">\(k+1+h\)</span> y calculamos el error de predicción.</p></li>
<li><p>Iteramos el proceso, desplazando cada vez las observaciones de la estimación un periodo adelante.</p></li>
<li><p>En general para <span class="math inline">\(i=0,1,...,T-k-h\)</span>, donde <span class="math inline">\(T\)</span> es el número total de observaciones:</p>
<ol style="list-style-type: decimal">
<li>Seleccionamos las observaciones <span class="math inline">\(i+1,i+2,...,i+k\)</span> para estimar el modelo.</li>
<li>Predecimos las observaciones desde <span class="math inline">\(i+k+1\)</span> hasta <span class="math inline">\(i+k+h\)</span>.</li>
<li>Calculamos el error de predicción para las observaciones desde <span class="math inline">\(i+k+1\)</span> hasta <span class="math inline">\(i+k+h\)</span>.</li>
<li>Para cada horizonte temporal de predicción se calcula la medida de error deseada.</li>
</ol></li>
</ul>
<p><br />
<br />
</p>
<p><img src="imagenes/RollingWindows.png" /></p>
<p>Este procedimiento se denomina <strong>origen de predicción móvil</strong> (<em>rolling forecast origin</em>) o <em>rolling windows</em>.</p>
<p>Cuando se aplica esta metodología hay que tener en cuenta que los resultados pueden depender del número <span class="math inline">\(k\)</span> de datos usados para la estimación del modelo.</p>
<div id="ejemplo-de-aplicación-con-nacimientos" class="section level3 unnumbered">
<h3 class="unnumbered">Ejemplo de aplicación con Nacimientos</h3>
<p>Vamos a aplicar la metodología previa a la serie anual de Nacimientos. Asumimos que se precisan veinte años para hacer una buena estimación, <span class="math inline">\(k=20\)</span>, y que el horizonte temporal es de cinco años, <span class="math inline">\(h = 5\)</span>. La siguiente rutina permite obtener el MAPE para previsiones con un horizonte temporal desde uno a cinco años.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>nacAnual <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(nacimientos, <span class="at">FUN =</span> sum)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">20</span>                   <span class="co">#Minimo numero de datos para estimar</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">5</span>                    <span class="co">#Horizonte de las prediciciones</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>TT <span class="ot">&lt;-</span> <span class="fu">length</span>(nacAnual)    <span class="co">#Longitud serie</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> TT <span class="sc">-</span> k <span class="sc">-</span> h           <span class="co">#Total de estimaciones</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>mapeRwf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, s <span class="sc">+</span> <span class="dv">1</span>, h)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>s) {</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  train.set <span class="ot">&lt;-</span> <span class="fu">subset</span>(nacAnual, <span class="at">start =</span> i <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  test.set <span class="ot">&lt;-</span>  <span class="fu">subset</span>(nacAnual, <span class="at">start =</span> i <span class="sc">+</span> k <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k <span class="sc">+</span> h)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">rwf</span>(train.set, <span class="at">h =</span> h, <span class="at">drift =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  mapeRwf[i <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">abs</span>(test.set <span class="sc">-</span> fcast<span class="sc">$</span>mean)<span class="sc">/</span>test.set</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>mapeRwf <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(mapeRwf)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(mapeRwf, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>[1]  4.21  8.16 12.15 16.20 20.42</code></pre>
<p>El error de previsión extra-muestral crece linealmente con el horizonte de previsión. Para el primer año el error de predicción se mantiene en un moderado 4.2%. Sin embargo, para el segundo año de predicción el MAPE salta al 8.2% y para los restantes años sigue creciendo rápidamente. Predecir usando la tendencia media solo es un buen método para predecir a un año vista.</p>
<p><br />
<br />
</p>
</div>
</div>
</div>
<div id="resumen-de-los-comandos-utilizados" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Resumen de los comandos utilizados</h1>
<table>
<thead>
<tr class="header">
<th align="left">Función</th>
<th align="left">Paquete</th>
<th align="left">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>meanf</code></td>
<td align="left">forecast</td>
<td align="left">Predicción por media</td>
</tr>
<tr class="even">
<td align="left"><code>naive</code></td>
<td align="left">forecast</td>
<td align="left">Predicción por método ingenuo I</td>
</tr>
<tr class="odd">
<td align="left"><code>rwf</code></td>
<td align="left">forecast</td>
<td align="left">Predicción con tendencia media</td>
</tr>
<tr class="even">
<td align="left"><code>snaive</code></td>
<td align="left">forecast</td>
<td align="left">Predicción por método ingenuo con estacionalidad</td>
</tr>
<tr class="odd">
<td align="left"><code>accuracy</code></td>
<td align="left">forecast</td>
<td align="left">Calculo de la precisión del modelo</td>
</tr>
<tr class="even">
<td align="left"><code>forecast</code></td>
<td align="left">forecast</td>
<td align="left">Predice valores extra-muestrales futuros de la serie</td>
</tr>
<tr class="odd">
<td align="left"><code>fitted</code></td>
<td align="left">stats</td>
<td align="left">Obtiene las predicciones a un periodo vista intra-muestrales</td>
</tr>
</tbody>
</table>
<p><br />
<br />
</p>
</div>
<div id="referencias" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Referencias</h1>
<ul>
<li>Makridakis, S. y Hibon, M. (2000). <em>The M3-Competition: results, conclusions and implications</em>. International Journal of Forecasting, 16(4), pp. 451–476. <a href="doi:10.1016/S0169-2070(00)00057-1" class="uri">doi:10.1016/S0169-2070(00)00057-1</a></li>
</ul>
<p><br />
<br />
<br />
<br />
</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTcOpdG9kb3Mgc2VuY2lsbG9zIGRlIHByZWRpY2Npw7NuLiBFdmFsdWFjacOzbiBkZSBwcmVkaWNjaW9uZXMiCnN1YnRpdGxlOiAiUHJldmlzacOzbiBjb24gRGF0b3MgVGVtcG9yYWxlcyAoR0JJQSkiCmF1dGhvcjogIkl2w6FuIEFycmliYXMgKERlcHRvLiBBbsOhbGlzaXMgRWNvbsOzbWljby4gVW5pdmVyc2l0YXQgZGUgVmFsw6huY2lhKSIKb3V0cHV0OiAKICBodG1sX2RvY3VtZW50OgogICAgY29kZV9kb3dubG9hZDogeWVzCiAgICBkZl9wcmludDoga2FibGUKICAgIGZpZ19jYXB0aW9uOiBubwogICAgaGlnaGxpZ2h0OiBweWdtZW50cwogICAgbnVtYmVyX3NlY3Rpb25zOiB5ZXMKICAgIHNlbGZfY29udGFpbmVkOiB5ZXMKICAgIHRoZW1lOiBjZXJ1bGVhbgogICAgdG9jOiB5ZXMKICAgIHRvY19kZXB0aDogMgogICAgdG9jX2Zsb2F0OgogICAgICBjb2xsYXBzZWQ6IHllcwotLS0KCmBgYHtyIGNodW5rX3NldHVwLCBlY2hvID0gRkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldCh3YXJuaW5nID0gRkFMU0UsIAogICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IEZBTFNFLCAKICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQgPSAiIiwKICAgICAgICAgICAgICAgICAgICAgIGZpZy5hbGlnbiA9ICJjZW50ZXIiLCAKICAgICAgICAgICAgICAgICAgICAgIGZpZy5zaG93ID0gImhvbGQiLAogICAgICAgICAgICAgICAgICAgICAgZmlnLmhlaWdodCA9IDQsCiAgICAgICAgICAgICAgICAgICAgICBmaWcud2lkdGggPSA4LAogICAgICAgICAgICAgICAgICAgICAgb3V0LndpZHRoID0gIjgwJSIpIApgYGAKCmBgYHtyIG9wdGlvbnNfc2V0dXAsIGVjaG8gPSBGQUxTRX0Kb3B0aW9ucyhzY2lwZW4gPSA5OTkpICMtIHBhcmEgcXVpdGFyIGxhIG5vdGFjaW9uIGNpZW50aWZpY2EKYGBgCgpgYGB7ciBsaWJyZXJpYXMsIGVjaG8gPSBGQUxTRX0KbGlicmFyeSgiUkNvbG9yQnJld2VyIikKbGlicmFyeShmb3JlY2FzdCkKbGlicmFyeShnZ3Bsb3QyKTsgdGhlbWVfc2V0KHRoZW1lX2J3KCkpCmxpYnJhcnkoZ3JpZEV4dHJhKQpsaWJyYXJ5KGdyaWQpCmBgYAoKXApcCgojIEludHJvZHVjY2nDs24KCkVuIG11Y2hvcyBjYXNvcyBlcyBwcmVjaXNvIGFwbGljYXIgdW4gbcOpdG9kbyBkZSBwcmVkaWNjacOzbiByw6FwaWRvIHkgc2VuY2lsbG86CgoqIEEgY2F1c2EgZGVsIGVsZXZhZG8gbsO6bWVybyBkZSBzZXJpZXMgcXVlIHRpZW5lbiBxdWUgc2VyIGFuYWxpemFkYXMuCiogRGViaWRvIGEgbGEgcmFwaWRleiBjb24gcXVlIGxhcyBwcmVkaWNjaW9uZXMgc2UgaGFuIGRlIGRhci4KICAgICAgCkFjdHVhbG1lbnRlIGV4aXN0ZW4gbXVjaG9zIG3DqXRvZG9zIHNlbmNpbGxvcyBkZSBwcmVkaWNjacOzbiwgZW50cmUgbG8gcXVlIGNhYmUgZGVzdGFjYXIgZG9zOgoKKiBfX03DqXRvZG9zIGRlIG1lZGlhIG3Ds3ZpbF9fIChUZW1hIDQpLgoqIF9fTcOpdG9kb3MgZGUgYWxpc2FkbyBleHBvbmVuY2lhbF9fIChUZW1hIDUpLgogICAgCkVzdGFzIHTDqWNuaWNhcywgYSBwZXNhciBkZSBzdSBzZW5jaWxsZXosIHNvbiBiYXN0YW50ZSBhZGVjdWFkYXMgY3VhbmRvIGxhIHByZXZpc2nDs24gZXMgYSBjb3J0byBwbGF6bzoKCj4iU3RhdGlzdGljYWxseSBzb3BoaXN0aWNhdGVkIG9yIGNvbXBsZXggbWV0aG9kcyBkbyBub3QgbmVjZXNzYXJpbHkgcHJvZHVjZSBtb3JlIGFjY3VyYXRlIGZvcmVjYXN0cyB0aGFuIHNpbXBsZXIgb25lcy4iIE1ha3JpZGFraXMgeSBIaWJvbiAoMjAwMCkuCiAgICAgIApQZXJvIGhheSBtw6l0b2RvcyBhw7puIG3DoXMgc2VuY2lsbG9zIHF1ZSBxdWVkYW4gZW5nbG9iYWRvcyBiYWpvIGVsIHBhcmFndWFzIGRlICoqbcOpdG9kb3Mgc2VuY2lsbG9zKiogcXVlIHZlcmVtb3MgZW4gZXN0ZSB0ZW1hLiAKClwKXAoKIyBDcml0ZXJpb3MgZGUgY2FsaWRhZAoKRW4gZXN0ZSB0ZW1hIHkgZW4gbG9zIHNpZ3VpZW50ZXMgc2UgdmVyw6FuIGRpZmVyZW50ZXMgbcOpdG9kb3MgcGFyYSBwcmVkZWNpciB1bmEgc2VyaWUgdGVtcG9yYWwuIEFzw60sIGVzIHByZWNpc28gZGVmaW5pciBjcml0ZXJpb3MgZGUgYm9uZGFkIGRlIGFqdXN0ZSBxdWUgcGVybWl0YW4gZXN0aW1hciB0YW50byBsYSBjYWxpZGFkIGRlbCBhanVzdGUgY29tbyBkZSBsYXMgcHJlZGljY2lvbmVzIGRlIHVuIG3DqXRvZG8uCgo+ICJUaGUgcmFua2luZ3Mgb2YgdGhlIHBlcmZvcm1hbmNlIG9mIHRoZSB2YXJpb3VzIG1ldGhvZHMgdmFyeSBhY2NvcmRpbmcgdG8gdGhlIGFjY3VyYWN5IG1lYXN1cmUgYmVpbmcgdXNlZC4iICBNYWtyaWRha2lzIHkgSGlib24gKDIwMDApLgogICAgIApcCgojIyBOb3RhY2nDs24geSBkZWZpbmljaW9uZXMKCgogCkRhZGEgdW5hIHNlcmllIHRlbXBvcmFsICRce3lfdFx9X3t0PTF9XlQkLCBzZSBkZWZpbmU6CgoqIF9fUHJldmlzacOzbiAkaCQgcGVyaW9kb3MgYWRlbGFudGVfXywgY29tbyBsYSBwcmV2aXNpw7NuIGRlIGxhIHNlcmllIHBhcmEgZWwgcGVyaW9kbyAkdCtoJCBkaXNwb25pZW5kbyBkZSBpbmZvcm1hY2nDs24gaGFzdGEgZWwgcGVyaW9kbyAkdCQsIHkgc2UgZGVub3RhIHBvciAkXGhhdHt5fV97dCtofHR9JC4gUG9yIHNpbXBsaWNpZGFkIGxvIGVzY3JpYmlyZW1vcyB0YW1iacOpbiBjb21vICRcaGF0e3l9X3t0K2h9JC4KClx2c3BhY2V7MC4zY219CgoqIEFzw60sICRcaGF0e3l9X3t0KzF8dH0kIGVzIGxhIF9fcHJldmlzacOzbiB1biBwZXJpb2RvIGFkZWxhbnRlX18gbyBhIHVuIHBlcmlvZG8gdmlzdGEuIEVzIGRlY2lyLCBsYSBwcmV2aXNpw7NuIGRlIGxhIHNlcmllIGVuICR0KzEkIGRlc2RlIGVsIHBlcmlvZG8gJHQkLgoKXHZzcGFjZXswLjNjbX0KCiogRGUgbnVldm8sIHBvciBzaW1wbGljaWRhZCBkZW5vdGFyZW1vcyBhICRcaGF0e3l9X3t0KzF8dH0kIGNvbW8gJFxoYXR7eX1fe3QrMX0kOyB5IGNvbW8gJFxoYXR7eX1fe3R9JCBhIGxhIHByZXZpc2nDs24gZW4gJHQkLCBjb24gZGF0b3MgaGFzdGEgZWwgcGVyaW9kbyAkdC0xJCAoJFxoYXR7eX1fe3R9ID0gXGhhdHt5fV97dHx0LTF9JCkuCgpTZSBkZWZpbmUgY29tbyBfX2Vycm9yIGRlIHByZXZpc2nDs25fXyBhIHVuIHBlcmlvZG8gdmlzdGEgYSAKJCRcaGF0e2V9X3Q9eV90LVxoYXR7eX1fdCwkJApkZSBmb3JtYSBxdWUgbGEgc2VyaWUgJFx7XGhhdHtlfV90XH1fe3Q9MX1eVCQgbm9zIHBlcm1pdGlyw6EgZGVmaW5pciB2YXJpb3MgY3JpdGVyaW9zIGRlIGNhbGlkYWQgZGUgYWp1c3RlLiAKICAKXAoKIyMgTWVkaWRhcyBkZSBwcmVjaXNpw7NuIGRlIGxhIHByZWRpY2Npw7NuCiAKRGFkYSB1bmEgc2VyaWUgJFx7eV90XH1fe3Q9MX1eVCQsIHVuIG3DqXRvZG8gZGUgcHJlZGljY2nDs24geSBzdSB2ZWN0b3IgZGUgZXJyb3JlcyBhc29jaWFkbyAkXHtcaGF0e2V9X3RcfV97dD0xfV5UJCwgcG9kZW1vcyBkZWZpbmlyIG3Dumx0aXBsZXMgbWVkaWRhcyBkZSBjYWxpZGFkIGRlbCBtw6l0b2RvIGRlIHByZWRpY2Npw7NuIHF1ZSBoYWNlbiByZWZlcmVuY2lhIGEgbGEgcHJlc2VuY2lhIGRlIHNlc2dvIGVuIGxhcyBwcmVkaWNjaW9uZXMsIGxhIG1hZ25pdHVkIGRlbCBlcnJvciBjb21ldGlkbyB5IGxhIGNhbGlkYWQgZGVsIGludGVydmFsbyBkZSBjb25maWFuemEgZGUgbGFzIHByZWRpY2Npb25lcy4gTGFzIG3DoXMgaGFiaXR1YWxlcyBzb24gKHNpZ2xhcyBlbiBpbmdsw6lzKToKCiogRXJyb3IgbWVkaW8gKE1FKTogJFxmcmFjezF9e1R9XHN1bV97dD0xfV5UIFxoYXR7ZX1fdCQKClx2c3BhY2V7MC4zY219CgoqIF9fUmHDrXogZGVsIGVycm9yIGN1YWRyw6F0aWNvIG1lZGlvIChSTVNFKV9fOiAkXHNxcnR7XGZyYWN7MX17VH1cc3VtX3t0PTF9XlQgXGhhdHtlfV4yX3R9JAoKXHZzcGFjZXswLjNjbX0KCiogRXJyb3IgYWJzb2x1dG8gbWVkaW8gKE1BRSk6ICRcZnJhY3sxfXtUfVxzdW1fe3Q9MX1eVCB8XGhhdHtlfV90fCQKClx2c3BhY2V7MC4zY219CgoqIEVycm9yIHBvcmNlbnR1YWwgbWVkaW8gKE1QRSk6ICRcZnJhY3sxMDB9e1R9XHN1bV97dD0xfV5UIFxmcmFje1xoYXR7ZX1fdH17eV90fSQKClx2c3BhY2V7MC4zY219CgoqIF9fRXJyb3IgcG9yY2VudHVhbCBhYnNvbHV0byBtZWRpbyAoTUFQRSlfXzogJFxmcmFjezEwMH17VH1cc3VtX3t0PTF9XlQgXGJpZ3xcZnJhY3tcaGF0e2V9X3R9e3lfdH1cYmlnfCQKClx2c3BhY2V7MC4zY219CgoqIEVycm9yIHBvcmNlbnR1YWwgYWJzb2x1dG8gbWVkaW8gc2ltw6l0cmljbyAoc01BUEUpOiAkXGZyYWN7MjAwfXtUfVxzdW1fe3Q9MX1eVCBcQmlnfFxmcmFje1xoYXR7ZX1fdH17eV90ICsgXGhhdHt5fV90fVxCaWd8JAoKXHZzcGFjZXswLjNjbX0KCiogRXJyb3IgZXNjYWxhZG8gYWJzb2x1dG8gbWVkaW8gKE1BU0UpOiAkXGJpZyhcZnJhY3sxfXtUfVxzdW1fe3Q9MX1eVCB8XGhhdHtlfV90fFxiaWcpL3EkLCBkb25kZSAkcSQgZXMgZWwgZXJyb3IgYWJzb2x1dG8gbWVkaW8gcGFyYSB1biBtw6l0b2RvIGluZ2VudW8gZGUgcHJlZGljY2nDs246CiAgKiAkcT1cZnJhY3sxfXtULTF9XHN1bV97dD0yfV5UIHx5X3QteV97dC0xfXwkIHBhcmEgc2VyaWVzIF9zaW5fIGVzdGFjaW9uYWxpZGFkCiAgKiAkcT1cZnJhY3sxfXtULW19XHN1bV97dD1tKzF9XlQgfHlfdC15X3t0LW19fCQgcGFyYSBzZXJpZXMgX2Nvbl8gZXN0YWNpb25hbGlkYWQKClx2c3BhY2V7MC4zY219CgoqIENvcnJlbGFjacOzbiBlbnRyZSAkXGhhdHtlfV90JCB5ICRcaGF0e2V9X3t0LTF9JCAoQUNGMSkuCgpcCgpNRSB5IE1QRSBwZXJtaXRlbiB2YWxvcmFyIGVsIHNlc2dvIGRlIGxhcyBwcmVkaWNjaW9uZXMgKHF1ZSBlc3RhcyBlc3TDqW4gc2lzdGVtw6F0aWNhbWVudGUgcG9yIGVuY2ltYSBvIHBvciBkZWJham8gZGUgbG9zIHZhbG9yZXMgcmVhbGVzKS4KCiogTG8gZXNwZXJhZG8gZXMgdW4gdmFsb3IgY2VyY2FubyBhIGNlcm8gKGNvbiByZWxhY2nDs24gYWwgdmFsb3IgbWVkaW8gZGUgbGEgc2VyaWUpLiBWYWxvcmVzIG11eSBhbGVqYWRvcyBkZSBjZXJvIHNvbiBpbmRpY2Fkb3JlcyBkZSBzZXNnbyBkZSBwcmVkaWNjacOzbi4KClJNU0UgeSBNQUUgaW5kaWNhbiBlbCBlcnJvciBtZWRpbyBjb21ldGlkbywgbWVkaWRvIGVuIGxhcyBtaXNtYXMgdW5pZGFkZXMgcXVlIGxhIHNlcmllIHRlbXBvcmFsLgoKKiBFc3TDoW4gYWNvdGFkYXMgaW5mZXJpb3JtZW50ZSBwb3IgZWwgdmFsb3Igw7NwdGltbyBkZSAwLCBwZXJvIG5vIGhheSBjb3RhIHN1cGVyaW9yLgoKTUFQRSB5IHNNQVBFIGluZGljYW4gZWwgZXJyb3IgcG9yY2VudHVhbCBtZWRpbyBjb21ldGlkby4KCiogRXN0w6FuIGFjb3RhZGFzIGluZmVyaW9ybWVudGUgcG9yIGVsIHZhbG9yIMOzcHRpbW8gZGUgMCUsIHkgbGEgY290YSBzdXBlcmlvciBuYXR1cmFsIGVzIDEwMCUsIGF1bnF1ZSBwb2Ryw61hIHNvYnJlcGFzYXJzZS4KKiBTaSAkeV90JCBwdWVkZSB2YWxlciAwLCBlbnRvbmNlcyBNQVBFIG5vIHNlIHB1ZWRlIGNhbGN1bGFyLiBBZGVtw6FzLCBNQVBFIHBlbmFsaXphIG3DoXMgbG9zIGVycm9yZXMgbmVnYXRpdm9zIGZyZW50ZSBhIGxvcyBlcnJvcmVzIHBvc2l0aXZvcy4gTGEgbWVkaWRhIGRlIHByZWNpc2nDs24gc01BUEUgc2UgZGVmaW5lIGEgZmluIGRlIGNvcnJlZ2lyIGVzdG9zIHByb2JsZW1hcy4KICAgICAgCk1BU0UgZXMgbGEgcmF0aW8gZW50cmUgZWwgZXJyb3IgZGVsIG3DqXRvZG8gdXNhZG8geSBlbCBlcnJvciBkZSB1biBtw6l0b2RvIGluZ2VudW8gZGUgcHJlZGljY2nDs24uIFBlcm1pdGUgc2FiZXIgY3XDoW50byBnYW5hbW9zIGVuIGNhcGFjaWRhZCBwcmVkaWN0aXZhIGFsIHBhc2FyIGRlIHVuIG3DqXRvZG8gaW5nZW51byBhIG90cm8gbcOhcyBjb21wbGljYWRvLgoKKiBVbiB2YWxvciBjZXJjYW5vIGEgMSBpbmRpY2EgcXVlIGVsIG3DqXRvZG8gdXNhZG8gbm8gZXMgbWVqb3IgcXVlIGVsIG3DqXRvZG8gaW5nZW51bwoqIEN1YW50byBtw6FzIGNlcmNhbm8gYSAwLCBtZWpvciBlcyBlbCBtw6l0b2RvIHVzYWRvIHJlc3BlY3RvIGRlbCBtw6l0b2RvIGluZ2VudW8KKiBTdSBjb21wbGVtZW50YXJpbyBhIDEgc2UgcHVlZGUgaW50ZXJwcmV0YXIgY29tbyBsYSB0YXNhIGRlIG1lam9yYQoKQUNGMSBldmFsw7phIGxhIGNhcGFjaWRhZCBkZSBtZWpvcmEgcXVlIGhheSBlbiBsYSBlc3RpbWFjacOzbiBkZWwgaW50ZXJ2YWxvIGRlIGNvbmZpYW56YSBkZSBsYXMgcHJlZGljY2lvbmVzLiBMbyB2ZXJlbW9zIGNvbiBtw6FzIGRldGFsbGUgZW4gZWwgdGVtYSBkZSBtb2RlbG9zIEFSSU1BLiBQb3IgYWhvcmEgYmFzdGEgc2FiZXIgcXVlOgoKKiBVbiB2YWxvciBtdXkgY2VyY2FubyBhIDAgaW5kaWNhIHF1ZSBoYXkgcG9jYSBjYXBhY2lkYWQgZGUgbWVqb3JhLgoqIFVuIHZhbG9yIGNlcmNhbm8gYSAxIG8gLTEgaW5kaWNhIHF1ZSBoYXkgbXVjaGEgY2FwYWNpZGFkIGRlIG1lam9yYS4KCkxhcyBfbWVkaWFzXyBzZSBwdWVkZW4gc3VzdGl0dWlyIHBvciBfbWVkaWFuYXNfLiBFc3RvIGVzIGVzcGVjaWFsbWVudGUgw7p0aWwgY3VhbmRvIHBhcmEgYWxndW5hcyBvYnNlcnZhY2lvbmVzIGhheSBlcnJvcmVzIGF0w61waWNhbWVudGUgYWx0b3MuCgpcCgpTaSBwYXJhIHJlYWxpemFyIGxhIHByZWRpY2Npw7NuIGRlbCBwZXJpb2RvICR0JCBzZSB1c2EgdW5hIG1ldG9kb2xvZ8OtYSBxdWUgdXRpbGl6YSBkYXRvcyBoYXN0YSBkaWNobyBwZXJpb2RvLCBzZSBoYWJsYXLDoSBkZSAqKnByZWRpY2Npw7NuIHkgZXJyb3IgaW50cmEtbXVlc3RyYWwqKi4gRW4gY2FzbyBjb250cmFyaW8sIGxhIHByZWRpY2Npw7NuIGRlbCBwZXJpb2RvICR0JCB1c2EgdW5hIG1ldG9kb2xvZ8OtYSBxdWUgc29sbyBuZWNlc2l0YSBkZSBkYXRvcyBoYXN0YSBlbCBwZXJpb2RvICR0LTEkLCBzZSBoYWJsYXLDoSBkZSAqKnByZWRpY2Npw7NuIHkgZXJyb3IgZXh0cmEtbXVlc3RyYWwqKi4KClNpIGxvcyBpbmRpY2Fkb3JlcyBkZSBjYWxpZGFkIHNlIGJhc2FuIGVuIHByZWRpY2Npb25lcyBpbnRyYS1tdWVzdHJhbGVzIGEgdW4gcGVyaW9kbyB2aXN0YSwgcHJlc2VudGFuIGRvcyBwcm9ibGVtYXMuIFByaW1lcm8sIGV2YWzDumFuIGVsIGVycm9yIGRlIHByZWRpY2Npw7NuIGEgdW4gcGVyaW9kbyB2aXN0YSwgY3VhbmRvIGVuIG11Y2hhcyBzaXR1YWNpb25lcyByZWFsZXMgbGFzIHByZWRpY2Npb25lcyBzZSByZWFsaXphbiBzb2JyZSB1biBob3Jpem9udGUgdGVtcG9yYWwgbcOhcyBhbXBsaW8uIFNlZ3VuZG8sIHNvbiBlcnJvcmVzIGludHJhLW11ZXN0cmFsZXMsIHJlc3VsdGFudGVzIGRlIHByZWRlY2lyIGxvcyBtaXNtb3MgZGF0b3MgcXVlIHNoYSB1c2FkbyBlbCBtw6l0b2RvIHBhcmEgY2FsY3VsYXIgbGEgcHJlZGljY2nDs24geSwgcG9yIHRhbnRvLCBzb2JyZS1lc3RpbWFuIGxhIGNhcGFjaWRhZCBwcmVkaWN0aXZhIGRlbCBtb2RlbG8uCgpWZXJlbW9zIGR1cmFudGUgZW4gZXN0ZSB0ZW1hIG3DqXRvZG9zIGRlIGV2YWx1YWNpw7NuIGRlIGxhIGNhbGlkYWQgZGUgbGFzIHByZWRpY2Npb25lcyBxdWUgc3VwZXJhbiBlc3RhcyBsaW1pdGFjaW9uZXMuCgpcClwKCiMgTcOpdG9kb3Mgc2VuY2lsbG9zIGRlIHByZWRpY2Npw7NuCgpBbGd1bm9zIG3DqXRvZG9zIGRlIHByZWRpY2Npw7NuIHNvbiBleHRyZW1hZGFtZW50ZSBzZW5jaWxsb3MgeSBzb3JwcmVuZGVudGVtZW50ZSBlZmljYWNlcy4gQSB2ZWNlcyBzb24gZGVub21pbmFkb3MgbcOpdG9kb3MgaW5nZW51b3MuIEVzdG9zIG3DqXRvZG9zOgoKKiBwb3NpYmlsaXRhbiByZWFsaXphciBwcmVkaWNjaW9uZXMgcHLDoWN0aWNhbWVudGUgc2luIHJlYWxpemFyIG5pbmfDum4gY8OhbGN1bG8uIAoqIGNvbW8gc29uIG11eSBzZW5jaWxsb3MsIGRhbiBsYXMgcHJldmlzaW9uZXMgY29uIG1heW9yIGVycm9yIChtZW5vcyBwcmVjaXNhcykuIEVsIGVycm9yIGRlIHVuIG3DqXRvZG8gc2VuY2lsbG8gc2lydmUgZGUgcHVudG8gZGUgcmVmZXJlbmNpYSAoX2JlbmNobWFya18pIHBhcmEgdmFsb3JhciBsYSBuZWNlc2lkYWQgZGUgYXBsaWNhciBvdHJvcyBtw6l0b2RvcyBtw6FzIGNvbXBsaWNhZG9zIGNvbiBlbCBvYmpldGl2byBkZSBtZWpvcmFyIGxhIGNhbGlkYWQgZGUgbGFzIHByZWRpY2Npb25lcy4gCgpWZWFtb3MgYWxndW5vcyBtw6l0b2RvcyBzZW5jaWxsb3MgeSBzdXMgZnVuY2lvbmVzIGVuIGVsIHBhcXVldGUgYGZvcmVjYXN0YC4KClwKCiMjIE3DqXRvZG9zIHNlbmNpbGxvcyBkZSBwcmVkaWNjacOzbgoKIyMjIFNlcmllcyBfc2luXyB0ZW5kZW5jaWEgeSBfc2luXyBlc3RhY2lvbmFsaWRhZCB7LX0KCioqTcOpdG9kbyBkZSBsYSBNZWRpYSoqOiAkXGhhdHt5fV97VCtofT0oeV8xK1xsZG90cyx5X1QpL1QkLgoKKiBMYSBwcmVkaWNjacOzbiBwYXJhIGN1YWxxdWllciBwZXJpb2RvIGZ1dHVybyBlcyBsYSBfX21lZGlhX18gZGUgbGFzIG9ic2VydmFjaW9uZXMgZGlzcG9uaWJsZXMgcHJldmlhcy4KKiBGdW5jacOzbiBkZSBgUmA6IGBtZWFuZih5LCBoKWAKICAgIAoqKk3DqXRvZG8gaW5nZW51byBJKio6ICRcaGF0e3l9X3tUK2h9PXlfVCQuCgoqIExhIHByZWRpY2Npw7NuIHBhcmEgY3VhbHF1aWVyIHBlcmlvZG8gZnV0dXJvIGVzIGxhIF9fw7psdGltYV9fIG9ic2VydmFjacOzbiBkaXNwb25pYmxlLgoqIEZ1bmNpw7NuIGRlIGBSYDogYG5haXZlKHksIGgpYCBvIGByd2YoeSwgaClgIChfcndfIGRlIHJhbmRvbSB3YWxrKQoqIFBhcmEgc2VyaWVzIHNpbiBlc3RhY2lvbmFsaWRhZCBlc3RlIGVzIGVsIG3DqXRvZG8gaW5nZW51byBkZSBjb21wYXJhY2nDs24gZGVsIE1BU0UuCgoKIyMjIFNlcmllcyBfY29uXyB0ZW5kZW5jaWEgeSBfc2luXyBlc3RhY2lvbmFsaWRhZCB7LX0KCioqTcOpdG9kbyBpbmdlbnVvIElJKio6ICRcaGF0e3l9X3tUK2h9PXlfVCArIGgoeV9ULXlfe1QtMX0pJC4KCiogTGEgcHJlZGljY2nDs24gJGgkIHBlcmlvZG9zIGFkZWxhbnRlIGVzIGxhIF9fw7psdGltYSBvYnNlcnZhY2nDs25fXyBkaXNwb25pYmxlIG3DoXMgJGgkIHZlY2VzIGVsIF9fw7psdGltbyBpbmNyZW1lbnRvX18gb2JzZXJ2YWRvLiAKKiBObyB0aWVuZSBmdW5jacOzbiBlbiBgUmAsIHBlcm8gc2UgcG9kcsOtYSBlbXVsYXIgbWVkaWFudGUgbGEgZnVuY2nDs24gYGhvbHRgICh2w6lhc2UgZXDDrWdyYWZlIGRlIDUuNSBBbGlzYWRvIGV4cG9uZW5jaWFsIGRlIEhvbHQpLgogICAgICAKKipNw6l0b2RvIGRlIGxhIGRlcml2YSoqOiAkXGhhdHt5fV97VCtofT15X1QraFxmcmFje3lfVCAtIHlfMX17VC0xfSQuCgoqIExhIHByZWRpY2Npw7NuICRoJCBwZXJpb2RvcyBhZGVsYW50ZSBlcyBsYSBfX8O6bHRpbWEgb2JzZXJ2YWNpw7NuX18gZGlzcG9uaWJsZSBtw6FzICRoJCB2ZWNlcyBlbCBfX2luY3JlbWVudG8gbWVkaW9fXyBvYnNlcnZhZG8uCiogRnVuY2nDs24gZGUgYFJgOiBgcndmKHksIGgsIGRyaWZ0ID0gVFJVRSlgICAKCgojIyMgU2VyaWVzIF9zaW5fIHRlbmRlbmNpYSB5IF9jb25fIGVzdGFjaW9uYWxpZGFkIHstfQoKKipNw6l0b2RvIGluZ2VudW8gY29uIGVzdGFjaW9uYWxpZGFkKio6ICRcaGF0e3l9X3tUK2h9PXlfe1QtbShrKzEpfSQuCgoqICRrJCBlcyBsYSBwYXJ0ZSBlbnRlcmEgZGUgJChoLTEpL20kLCBlcyBkZWNpciwgZWwgbsO6bWVybyBkZSBhw7FvcyBjb21wbGV0b3MgZW4gZWwgcGVyaW9kbyBkZSBwcmVkaWNjacOzbiBwcmV2aW8gYWwgcGVyaW9kbyAkVCtoJC4KKiBMYSBwcmVkaWNjacOzbiBwYXJhIHVuIHBlcmlvZG8gZXMgbGEgX1/Dumx0aW1hIG9ic2VydmFjacOzbiBkaXNwb25pYmxlIGRlIGxhIG1pc21hIGVzdGFjacOzbiBxdWUgbGEgZmVjaGEgcXVlIHNlIGRlc2VhIHByZWRlY2lyX18uCiogRnVuY2nDs24gZGUgYFJgOiBgc25haXZlKHksIGgpYAoqIFBhcmEgc2VyaWVzIGNvbiBlc3RhY2lvbmFsaWRhZCBlc3RlIGVzIGVsIG3DqXRvZG8gaW5nZW51byBkZSBjb21wYXJhY2nDs24gZGVsIE1BU0UKICAgIApfX05vIGhheSBtw6l0b2RvcyBzZW5jaWxsb3MgY3VhbmRvIGxhIHNlcmllIHRpZW5lIHRlbmRlbmNpYSB5IGVzdGFjaW9uYWxpZGFkX18sIGF1bnF1ZSBsYSBhcGxpY2FjacOzbiBkZWwgbcOpdG9kbyBpbmdlbnVvIGNvbiBlc3RhY2lvbmFsaWRhZCBzdWVsZSBzZXIgbXV5IGVmZWN0aXZhLgoKXAoKIyMgRWplbXBsbyBkZSBhcGxpY2FjacOzbgoKIyMjIFNlcmllIExpYnJvcyB7LX0KIApgYGB7cn0KbGlicm9zIDwtIHJlYWQuY3N2MigiLi9zZXJpZXMvbGlicm9zLmNzdiIsIGhlYWRlciA9IFRSVUUpCmxpYnJvcyA8LSB0cyhsaWJyb3NbICwyXSwgc3RhcnQgPSAxOTkzLCBmcmVxdWVuY3kgID0gMSkKYGBgCgpFbiBsYSBmaWd1cmEgMSBzZSBtdWVzdHJhIGVsIHJlc3VsdGFkbyBncsOhZmljbyBkZSBsYSBhcGxpY2FjacOzbiBkZSBhbGd1bm9zIGRlIGVzdG9zIG3DqXRvZG9zIHNlbmNpbGxvcyBhIGxhIHNlcmllIExpYnJvcyAobsO6bWVybyBkZSB0w610dWxvcyBwdWJsaWNhZG9zIGFudWFsbWVudGUgZW4gRXNwYcOxYSBkZXNkZSAxOTkzIGhhc3RhIDIwMTgpLCBjb24gaW5kZXBlbmRlbmNpYSBkZSBzdSBhZGVjdWFjacOzbiBkYWRhcyBsYXMgY29tcG9uZW50ZXMgZGUgZXN0YSBzZXJpZS4gU2UgaGEgZmlqYWRvIHVuIGhvcml6b250ZSBkZSBwcmV2aXNpw7NuIGRlIGNpbmNvIGHDsW9zIChgaCA9IDVgKS4gRWwgYXJndW1lbnRvIGBQSSA9IEZBTFNFYCBoYWNlIHF1ZSBubyBzZSBpbXByaW1hbiBsb3MgaW50ZXJ2YWxvcyBkZSBjb25maWFuemEgZGUgbGFzIHByZWRpY2Npb25lcy4KCkxvcyBtw6l0b2RvcyBkZSBsYSBNZWRpYSBlIEluZ2VudW8gSSByZWFsaXphbiB1bmEgcHJlZGljY2nDs24gY29uc3RhbnRlLCBlbCBwcmltZXJvIGxhIG1lZGlhIGRlIHTDrXR1bG9zIGVuIGVsIHBlcmlvZG8gZGUgYW7DoWxpc2lzIChgciBhcy5pbnRlZ2VyKG1lYW4obGlicm9zKSlgKSB5IGVsIHNlZ3VuZG8gZWwgw7psdGltbyBkYXRvIG9ic2VydmFkbyAoYHIgdGFpbChhcy5pbnRlZ2VyKGxpYnJvcyksIG49MSlgKS4gRWwgbcOpdG9kbyBkZSBkZXJpdmEgb2ZyZWNlIHVuYSBwcmVkaWNjacOzbiBjcmVjaWVudGUgcG9ycXVlIGxhIHNlcmllIExpYnJvcyB0aWVuZSB1bmEgcGVuZGllbnRlIG1lZGlhIHBvc2l0aXZhIGVuIGVsIHBlcmlvZG8gZGUgYW7DoWxpc2lzLgoKUmVjdWVyZGEgcXVlIGRlYmVzIGNhcmdhciBsYXMgbGlicmVyw61hcyBgZm9yZWNhc3RgIHkgYGdncGxvdDJgLgoKYGBge3J9CihtZWRpYUxpYnJvcyA8LSBtZWFuZihsaWJyb3MsIGggPSA1KSkKKG5haXZlTGlicm9zIDwtIG5haXZlKGxpYnJvcywgaCA9IDUpKQooZGVyaXZhTGlicm9zIDwtIHJ3ZihsaWJyb3MsICBoID0gNSwgZHJpZnQgPSBUUlVFKSkKIAoKYXV0b3Bsb3QobGlicm9zLCBzZXJpZXMgPSAiTGlicm9zIiwKICAgICAgICAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgICAgICAgIHlsYWIgPSAiVMOtdHVsb3MiLAogICAgICAgICAgICAgICAgbWFpbiA9ICJGaWd1cmEgMS4gTGlicm9zIHkgcHJlZGljY2nDs24gcG9yIG3DqXRvZG9zIHNlbmNpbGxvcyIpICsKICBhdXRvbGF5ZXIobWVkaWFMaWJyb3MsIHNlcmllcz0iTWVkaWEiLCBQSSA9IEZBTFNFKSArCiAgYXV0b2xheWVyKG5haXZlTGlicm9zLCBzZXJpZXM9IkluZ2VudW8iLCBQSSA9IEZBTFNFKSArCiAgYXV0b2xheWVyKGRlcml2YUxpYnJvcywgc2VyaWVzPSJEZXJpdmEiLCBQSSA9IEZBTFNFKSArCiAgc2NhbGVfY29sb3VyX2Rpc2NyZXRlKGxpbWl0cz1jKCJMaWJyb3MiLCAiTWVkaWEiLCAiSW5nZW51byIsICJEZXJpdmEiKSkgKwogIGd1aWRlcyhjb2xvdXIgPSBndWlkZV9sZWdlbmQodGl0bGUgPSAiTcOpdG9kb3MiKSkgKyAKICB0aGVtZShsZWdlbmQucG9zaXRpb249YygwLjAyLDAuOTgpLCBsZWdlbmQuanVzdGlmaWNhdGlvbj1jKDAsMSkpCmBgYAoKQ29uIGxhIGZ1bmNpw7NuIGBhY2N1cmFjeWAgc2UgcHVlZGUgb2J0ZW5lciBlbCBlcnJvciBkZSBwcmVkaWNjacOzbiBpbnRyYS1tdWVzdHJhbCBhIHVuIHBlcmlvZG8gdmlzdGEgZGUgY2FkYSBtw6l0b2RvOgoKYGBge3IsIGV2YWwgPSBGQUxTRX0KYWNjdXJhY3kobWVkaWFMaWJyb3MpCmFjY3VyYWN5KG5haXZlTGlicm9zKQphY2N1cmFjeShkZXJpdmFMaWJyb3MpCmBgYAoKYGBge3IsIGVjaG89RkFMU0V9CnRtcCA8LSByYmluZCgKICBhY2N1cmFjeShtZWRpYUxpYnJvcyksCiAgYWNjdXJhY3kobmFpdmVMaWJyb3MpLAogIGFjY3VyYWN5KGRlcml2YUxpYnJvcykKKQp0bXAgPC0gcm91bmQodG1wLDIpCnJvd25hbWVzKHRtcCkgPC0gYygiTWVkaWEiLCJJbmdlbnVvIEkiLCJEZXJpdmEiKQp0bXAKYGBgCgpQb2RlbW9zIGRlc3RhY2FyIHF1ZToKCiogRWwgbcOpdG9kbyBkZSBfTWVkaWFfIHByZXNlbnRhIHVuYSBiYWphIGNhbGlkYWQgZGUgYWp1c3RlIGRlYmlkbyBhIHF1ZSBsYSBzZXJpZSBMaWJyb3MgdGllbmUgdGVuZGVuY2lhIChNQVBFID0gIDE0JSkuIEFkZW3DoXMsIGVsIGludGVydmFsbyBkZSBjb25maWFuemEgZGUgbGFzIHByZWRpY2Npb25lcyBubyBlcyBmaWFibGUgKEFDRjEgPSAwLjc3KS4KKiBFbCBtw6l0b2RvIGRlIF9EZXJpdmFfIHRpZW5lIGxhIG1lam9yIGNhbGlkYWQgZGUgYWp1c3RlLCBjb24gdW4gZXJyb3IgcG9yY2VudHVhbCBkZWwgNi45JSAoTUFQRSksIHkgdW4gZXJyb3IgbWVkaW8gYXByb3hpbWFkbyBkZSA2LDAwMCB0w610dWxvcyAoUk1TRSkuIE5vIHByZXNlbnRhIHNlc2dvIChNRSA9IDApIHkgZWwgaW50ZXJ2YWxvIGRlIGNvbmZpYW56YSBkZSBsYXMgcHJlZGljY2lvbmVzIGVzIGZpYWJsZSAoQUNGMSA9IC0wLjA0KS4KKiBFbCBtw6l0b2RvIF9JbmdlbnVvIElfIHRpZW5lIGJ1ZW5hIGNhbGlkYWQgZGUgYWp1c3RlLCBwZXJvIGxhcyBwcmV2aXNpb25lcyBlc3TDoW4gbGlnZXJhbWVudGUgc2VzZ2FkYXMgKE1FID0gODU3KS4KKiBQYXJhIHNlcmllcyBzaW4gZXN0YWNpb25hbGlkYWQgZWwgbcOpdG9kbyBzZW5jaWxsbyBkZSBjb21wYXJhY2nDs24gdXNhZG8gZW4gZWwgY8OhbGN1bG8gZGVsIE1BU0UgZXMgZWwgX0luZ2VudW8gSV8uIEVzIHBvciBlbGxvIHF1ZSBlc3RlIGluZGljYWRvciB2YWxlIDEgcGFyYSBlc3RlIG3DqXRvZG8uCiogRWwgZXJyb3IgbWVkaW8gKE1FKSBzaWVtcHJlIHNlcsOhIG51bG8gcGFyYSBlbCBtw6l0b2RvIGRlIGxhIF9NZWRpYV8geSBkZSBsYSBfRGVyaXZhXywgbG8gcXVlIGluZGljYSBxdWUgbm9zIGVxdWl2b2NhbW9zIHRhbnRvIHBvciBleGNlc28gY29tbyBwb3IgZGVmZWN0by4gRXN0YSBlcyB1bmEgYnVlbmEgcHJvcGllZGFkLCBxdWUgZWwgbcOpdG9kbyBfSW5nZW51byBJXyBubyB2ZXJpZmljYS4KCiMjIyBTZXJpZSBOYWNpbWllbnRvcyB7LX0KClBvZGVtb3MgdXNhciBlbCBtw6l0b2RvIGluZ2VudW8gY29uIGVzdGFjaW9uYWxpZGFkIGNvbiBsYSBzZXJpZSBOYWNpbWllbnRvcyBwYXJhIG9idGVuZXIgdW5hIHByZXZpc2nDs24gYSBkb3MgYcOxb3MgdmlzdGEuIEVsIGVycm9yIGFic29sdXRvIHBvcmNlbnR1YWwgbWVkaW8gZXMgZGVsIDMuNiUuIEVzIGRlY2lyLCBhcGxpY2FuZG8gYWxnbyB0YW4gc2ltcGxlIGNvbW8gcHJlZGVjaXIgZWwgbsO6bWVybyBkZSBuYWNpbWllbnRvcyBwYXJhIHVuIG1lcyBjb21vIGxvcyBuYWNpbWllbnRvcyBkZWwgbWlzbW8gbWVzIGRlbCBhw7FvIHByZXZpbywgdGVuZW1vcyB5YSB1biBlcnJvciBkZSBwcmVkaWNjacOzbiBtdXkgYmFqby4gTGEgZmlndXJhIDIgbXVlc3RyYSBsYSBzZXJpZSB5IGxhIHByZWRpY2Npw7NuIHF1ZSwgZGViaWRvIGFsIG3DqXRvZG8gdXNhZG8sIG5vIGluY29ycG9yYSBsYSB0ZW5kZW5jaWEgZGVjcmVjaWVudGUgZGUgbG9zIMO6bHRpbW9zIGHDsW9zLgoKYGBge3J9Cm5hY2ltaWVudG9zIDwtIHJlYWQuY3N2MigiLi9zZXJpZXMvbmFjaW1pZW50b3MuY3N2IiwgaGVhZGVyID0gVFJVRSkKbmFjaW1pZW50b3MgPC0gdHMobmFjaW1pZW50b3NbLCAyXSwKICAgICAgICAgICAgICAgICAgc3RhcnQgPSBjKDE5NzUsIDEpLAogICAgICAgICAgICAgICAgICBmcmVxdWVuY3kgPSAxMikKCihzbmFpdmUubmFjaW1pZW50b3MgPC0gc25haXZlKG5hY2ltaWVudG9zLCBoID0gMjQsIGxldmVsID0gOTUpKQphY2N1cmFjeShzbmFpdmUubmFjaW1pZW50b3MpCgphdXRvcGxvdChzbmFpdmUubmFjaW1pZW50b3MsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICJOYWNpbWllbnRvcyIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDIuIE5hY2ltaWVudG9zIHkgcHJlZGljY2nDs24gcG9yIGVsIG3DqXRvZG8gSW5nZW51byBjb24gZXN0YWNpb25hbGlkYWQiKQpgYGAKCgpcClwKCiMgRXZhbHVhY2nDs24gZGUgbGFzIHByZWRpY2Npb25lcwoKTGFzIG1lZGlkYXMgcXVlIGhlbW9zIHVzYWRvIGhhc3RhIGFob3JhIHBhcmEgdmFsb3JhciBsYSBjYWxpZGFkIGRlIGxhcyBwcmVkaWNjaW9uZXMgc29uIHJlYWxtZW50ZSBtZWRpZGFzIGRlIGJvbmRhZCBkZSBhanVzdGUsIGVzIGRlY2lyLCBtZWRpZGFzIGRlIGxhIGNhbGlkYWQgZGUgX19wcmV2aXNpb25lcyBpbnRyYS1tdWVzdHJhbGVzIGEgdW4gcGVyaW9kbyB2aXN0YV9fLiBWYWxvcmFuIGVuIHF1ZSBtZWRpZGEgbG9zIGRhdG9zIHNlIGFqdXN0YW4gYSB1biBwYXRyw7NuIG8gbW9kZWxvLCBwZXJvIG5vIGV2YWzDumFuIGxhIGNhbGlkYWQgZGUgbGEgcHJldmlzaW9uZXMgYW50ZSBudWV2b3MgZGF0b3MuCgpFbiBlc3RlIGVww61ncmFmZSB2YW1vcyBhIHZlciBkb3MgbWV0b2RvbG9nw61hcyBxdWUgcG9kZW1vcyB1c2FyIHBhcmEgdmFsb3JhciBsYSBjYWxpZGFkIGRlIGxhcyBfX3ByZXZpc2lvbmVzIGV4dHJhLW11ZXN0cmFsZXNfXywgcXVlIGVzIHJlYWxtZW50ZSBsb3MgcXVlIG5vcyBpbnRlcmVzYS4gRXN0YXMgZG9zIG1ldG9kb2xvZ8OtYXMgZXN0w6FuIHJlbGFjaW9uYWRhcyBjb24gbG9zIG3DqXRvZG9zIGRlIF9UcmFpbmluZyBzZXQvVGVzdCBzZXRfIHkgX0Nyb3NzLXZhbGlkYXRpb25fIHF1ZSB2aXN0ZSBlbiBfUHJldmlzacOzbiBjb24gZGF0b3MgdHJhbnN2ZXJzYWxlc18sIHBlcm8gYWRhcHRhZGFzIGEgZGF0b3MgdGVtcG9yYWxlcy4KCiMjIFZhbGlkYWNpw7NuIHBvciBsYSBtZXRvZG9sb2fDrWEgZGUgX1RyYWluaW5nIHNldC9UZXN0IHNldF8gcGFyYSBTZXJpZXMgVGVtcG9yYWxlcwoKVmFtb3MgYSBtZWpvcmFyIGxhIGVzdGltYWNpw7NuIGRlIGxhIGNhbGlkYWQgZGUgbGFzIHByZWRpY2Npb25lcyBvYnRlbmllbmRvIGxhcyBtZWRpZGFzIGRlIGVycm9yIHBhcmEgX19wcmV2aXNpb25lcyBleHRyYS1tdWVzdHJhbGVzIGEgdmFyaW9zIHBlcmlvZG9zIHZpc3RhX18gdXNhbmRvIGxhIGZpbG9zb2bDrWEgZGVsIG3DqXRvZG8gX3RyYWluaW5nIHNldC90ZXN0IHNldF8uIERpdmlkaW1vcyBsYSBzZXJpZSB0ZW1wb3JhbCAkXHt5X3RcfV97dD0xfV5UJCBlbiBkb3Mgc3Vic2VyaWVzLCBsb3MgcHJpbWVyb3MgZGF0b3MgJFx7eV90XH1fe3Q9MX1ee1RfMH0kLCAkVF8wIDwgVCQgc2UgdXNhcsOhbiBwYXJhIGVzdGltYXIgZWwgbW9kZWxvLCB5IGxvcyDDumx0aW1vcyBkYXRvcyAkXHt5X3RcfV97dD17VF8wKzF9fV57VH0kIHBhcmEgdmFsaWRhciBlbCBtb2RlbG8uCgpFc3RhIG1ldG9kb2xvZ8OtYSwgbXV5IGVmZWN0aXZhIHBhcmEgZGF0b3MgZGUgY29ydGUgdHJhbnN2ZXJzYWwsIGdlbmVyYSBkb3MgcHJvYmxlbWFzIGN1YW5kbyBzZSBhcGxpY2EgYSBzZXJpZXMgdGVtcG9yYWxlczogX2lfKSBlbCBlcnJvciBvYnRlbmlkbyBlcyB1bmEgbWV6Y2xhIGRlIGVycm9yZXMgZGUgcHJlZGljY2nDs24gYSBjb3J0bywgbWVkaW8geSBsYXJnbyBwbGF6byBkaWbDrWNpbCBkZSB2YWxvcmFyOyBfaWlfKSBsb3MgcmVzdWx0YWRvcyBkZXBlbmRlbiB0cmVtZW5kYW1lbnRlIGRlbCBwdW50byBkZSBjb3J0ZSB0ZW1wb3JhbCBzZWxlY2Npb25hZG8uCgojIyMgU2VyaWUgTGlicm9zIHstfQoKVmFtb3MgYSByZXNlcnZhciwgcG9yIGVqZW1wbG8sIGxhcyDDumx0aW1hcyA2IG9ic2VydmFjaW9uZXMgZGUgbGEgc2VyaWUgTGlicm9zIHkgYWp1c3RhciBlbCBtb2RlbG8gY29uIGxhcyByZXN0YW50ZXMuIERlc3B1w6lzIHVzYXJlbW9zIGVzdGUgbW9kZWxvIHBhcmEgY2FsY3VsYXIgbGFzIHByZWRpY2Npb25lcyBhIDYgcGVyaW9kb3MgdmlzdGEgeSBjb21wYXJhcmxhcyBjb24gbG9zIHZhbG9yZXMgcmVhbGVzIGRlIGxhIHNlcmllLiAKCmBgYHtyLCBldmFsID0gRkFMU0V9CiMgRGVmaW5pbW9zIGxhcyBvYnNlcnZhY2lvbmVzIGludHJhLSB5IGV4dHJhLW11ZXN0cmFsZXMKbGlicm9zSW50cmEgPC0gc3Vic2V0KGxpYnJvcywgZW5kID0gbGVuZ3RoKGxpYnJvcykgLSA2KQpsaWJyb3NFeHRyYSA8LSBzdWJzZXQobGlicm9zLCBzdGFydCA9IGxlbmd0aChsaWJyb3MpIC0gNSkKCiMgRXN0aW1hbW9zIGVsIG1vZGVsbyBjb24gdG9kb3MgbG9zIGRhdG9zIG1lbm9zIGxvcyA2IHVsdGltb3MgeQojIHByZWRlY2ltb3MgbG9zIDYgYcOxb3MgcXVlIGhlbW9zIHF1aXRhZG8gZGUgbGEgc2VyaWUgCmxpYnJvc0V4dHJhUHJlIDwtIHJ3ZihsaWJyb3NJbnRyYSwgIGggPSA2LCBkcmlmdCA9IFRSVUUpCgojIFZlbW9zIGxhIGNhbGlkYWQgZGVsIGFqdXN0ZS4gUHJpbWVybyBsYSBwcmVkaWNjacOzbiB5IGx1ZWdvIGxvcyBkYXRvcyByZWFsZXMKYWNjdXJhY3kobGlicm9zRXh0cmFQcmUsIGxpYnJvc0V4dHJhKQpgYGAKCmBgYHtyLCBlY2hvID0gRkFMU0V9CiMgRGVmaW5pbW9zIGxhcyBvYnNlcnZhY2lvbmVzIGludHJhLSB5IGV4dHJhLW11ZXN0cmFsZXMKbGlicm9zSW50cmEgPC0gc3Vic2V0KGxpYnJvcywgZW5kID0gbGVuZ3RoKGxpYnJvcykgLSA2KQpsaWJyb3NFeHRyYSA8LSBzdWJzZXQobGlicm9zLCBzdGFydCA9IGxlbmd0aChsaWJyb3MpIC0gNSkKCiMgRXN0aW1hbW9zIGVsIG1vZGVsbyBjb24gdG9kb3MgbG9zIGRhdG9zIG1lbm9zIGxvcyA2IHVsdGltb3MgeQojIHByZWRlY2ltb3MgbG9zIDcgYcOxb3MgcXVlIGhlbW9zIHF1aXRhZG8gZGUgbGEgc2VyaWUgCmxpYnJvc0V4dHJhUHJlIDwtIHJ3ZihsaWJyb3NJbnRyYSwgIGggPSA2LCBkcmlmdCA9IFRSVUUpCgojIFZlbW9zIGxhIGNhbGlkYWQgZGVsIGFqdXN0ZS4gUHJpbWVybyBsYSBwcmVkaWNjacOzbiB5IGx1ZWdvIGxvcyBkYXRvcyByZWFsZXMKcm91bmQoYWNjdXJhY3kobGlicm9zRXh0cmFQcmUsIGxpYnJvc0V4dHJhKSwgMikKCmVycm9yLm11ZXN0cmFsLjEgPC0gcm91bmQoYWNjdXJhY3kobGlicm9zRXh0cmFQcmUsIGxpYnJvc0V4dHJhKVsxLDVdLCAxKQplcnJvci5leHRyYW11ZXN0cmFsLm4gPC0gcm91bmQoYWNjdXJhY3kobGlicm9zRXh0cmFQcmUsIGxpYnJvc0V4dHJhKVsyLDVdLDEpCmBgYAoKQXRlbmRpZW5kbyBhbCBNQVBFIHNlIHRpZW5lIHF1ZSBlbCBlcnJvciBkZSBfX3ByZXZpc2nDs24gYSB1biBwZXJpb2RvIHZpc3RhX18gZW4gZWwgX19wZXJpb2RvIGludHJhLW11ZXN0cmFsX18gZGUgX18xOTkzIGEgMjAxMl9fIGVzIGRlbCBgciBlcnJvci5tdWVzdHJhbC4xYCU7IG1pZW50cmFzIHF1ZSBlbCBlcnJvciBkZSBfX3ByZXZpc2nDs24gYSBsYXJnbyBwbGF6b19fIGVuIGVsIF9fcGVyaW9kbyBleHRyYS1tdWVzdHJhbF9fIGRlIF9fMjAxMyBhIDIwMThfXyBlcyBkZWwgYHIgZXJyb3IuZXh0cmFtdWVzdHJhbC5uYCUuIEFkZW1hcywgcGFyYSBlbCBwZXJpb2RvIGV4dHJhLW11ZXN0cmFsIGVsIGVycm9yIG1lZGlvIChNRSkgZXMgbmVnYXRpdm8geSBtdXkgZWxldmFkbywgdW4gaW5kaWNhdGl2byBkZSBxdWUgbGFzIHByZXZpc2lvbmVzIGVzdMOhbiBzZWdhZGFzIChzb2JyZS1lc3RpbWFuIGxhIHJlYWxpZGFkKS4gRW4gcmVzdW1lbiwgbGEgY2FsaWRhZCBkZWwgbW9kZWxvIHNlIGRldGVyaW9yYSBtdXkgcsOhcGlkYW1lbnRlIGVuIGN1YW50byBub3Mgc2FsaW1vcyBkZSBsYXMgY29uZGljaW9uZXMgw7NwdGltYXMuIAoKVW4gZ3LDoWZpY28gcHVlZGUgYXl1ZGFyIGEgZW50ZW5kZXIgZXN0ZSBwcm9jZXNvIGRlIHZhbGlkYWNpw7NuLiBFbiBsYSBmaWd1cmEgMzoKCiogTGEgbMOtbmVhIGRlIHB1bnRvcyB2ZXJ0aWNhbCBzZXBhcmEgZWwgcGVyaW9kbyBtdWVzdHJhbCAoMTk5My0yMDEyKSB1c2FkbyBwYXJhIGVzdGltYXIgZWwgbW9kZWxvLCBkZWwgcGVyaW9kbyBleHRyYS1tdWVzdHJhbCAoMjAxMy0yMDE4KSB1c2FkbyBzw7NsbyBwYXJhIGhhY2VyIGxhcyBwcmV2aXNpb25lcy4KKiBMYSBzZXJpZSBMaWJyb3MgYXBhcmVjZSBjb21vIHVuYSBsw61uZWEgc8OzbGlkYSBlbiBuZWdybywgZGVzZGUgMTk5MyBoYXN0YSAyMDE4LgoqIExhIHByZXZpc2nDs24gX2ludHJhXy1tdWVzdHJhbCAoYSB1biBwZXJpb2RvIHZpc3RhKSBkZSBsYSBzZXJpZSBMaWJyb3MgYXBhcmVjZSBjb21vIHVuYSBsw61uZWEgYXp1bC4KKiBMYSBsw61uZWEgZW4gcm9qbyBlcyBsYSBwcmV2aXNpw7NuIF9leHRyYV8tbXVlc3RyYWwgYSBsYXJnbyBwbGF6by4gT2JzZXJ2YSBxdWUgdG9kYXMgbGFzIHByZXZpc2lvbmVzIGVzdMOhbiBwb3IgZW5jaW1hIGRlbCB2YWxvciByZWFsIGRlIGxhIHNlcmllLgoqIEFsIGxhZG8gZGUgY2FkYSBwcmV2aXNpw7NuIChpbnRyYS0geSBleHRyYS1tdWVzdHJhbCkgc2UgaGEgaW5kaWNhZG8gZWwgZXJyb3IgZXN0aW1hZG8gKE1BUEUpLgoKQ2xhcmFtZW50ZSBlc3RvcyByZXN1bHRhZG9zIGRlcGVuZGVuIGRlbCBwdW50byBkZSBjb3J0ZSBzZWxlY2Npb25hZG8uCgpgYGB7cixlY2hvPUZBTFNFfQphdXRvcGxvdChsaWJyb3MsIHNlcmllcyA9ICJMaWJyb3MiLAogICAgICAgICBtYWluPSJGaWd1cmEgMy4gTGlicm9zLCBwcmVkaWNjacOzbiBpbnRyYS0geSBleHRyYS1tdWVzdHJhbCIsCiAgICAgICAgIHhsYWI9IiIsIAogICAgICAgICB5bGFiPSJUw610dWxvcyIKICAgICAgICAgKSArCiAgYXV0b2xheWVyKGZpdHRlZChsaWJyb3NFeHRyYVByZSksIHNlcmllcyA9ICJMaWJyb3MgKGFqdXN0YWRhKSIpICsgCiAgYXV0b2xheWVyKGxpYnJvc0V4dHJhUHJlJG1lYW4sIHNlcmllcyA9ICJQcmVkaWNjacOzbiIpICsgCiAgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gMjAxMi41LCBsdHkgPSAyLCBjb2wgPSAiYmxhY2siKSArCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9YygiTGlicm9zIj0iYmxhY2siLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkxpYnJvcyAoYWp1c3RhZGEpIj0iYmx1ZSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlByZWRpY2Npw7NuIiA9ICJyZWQiKSkgKwogIGd1aWRlcyhjb2xvdXIgPSBndWlkZV9sZWdlbmQodGl0bGUgPSAiU2VyaWVzIikpICsKICBhbm5vdGF0ZSgidGV4dCIsIHg9MTk5OSwgeT02NTAwMCwgbGFiZWw9IjYuNSUiLCBjb2xvdXIgPSAiYmx1ZSIpICsKICBhbm5vdGF0ZSgidGV4dCIsIHg9MjAxNiwgeT03MjAwMCwgbGFiZWw9IjI2LjclIiwgY29sb3VyID0gInJlZCIpICsKICB0aGVtZShsZWdlbmQucG9zaXRpb249YygwLjAyLDAuOTgpLCBsZWdlbmQuanVzdGlmaWNhdGlvbj1jKDAsMSkpIApgYGAKCiMjIyBTZXJpZSBOYWNpbWllbnRvcyB7LX0KCkNhbGN1bGFtb3MgZGUgbnVldm8gbG9zIGRpZmVyZW50ZXMgY3JpdGVyaW9zIGRlIGJvbmRhZCBkZSBhanVzdGUgcGFyYSB2YWxvcmFyIGxhIGNhbGlkYWQgZGUgbGFzIHByZXZpc2lvbmVzIGV4dHJhLW11ZXN0cmFsZXMgYSBsYXJnbyBwbGF6by4gRW4gZXN0ZSBjYXNvIHZhbW9zIGEgcmVzZXJ2YXIgbG9zIMO6bHRpbW9zIDM2IG1lc2VzIGNvbW8gcGVyaW9kbyBleHRyYS1tdWVzdHJhbC4KICAKYGBge3IsIGV2YWwgPSBGQUxTRX0KbmFjaW1pZW50b3NJbnRyYSA8LSBzdWJzZXQobmFjaW1pZW50b3MsIGVuZCA9IGxlbmd0aChuYWNpbWllbnRvcykgLSAzNikKbmFjaW1pZW50b3NFeHRyYSA8LSBzdWJzZXQobmFjaW1pZW50b3MsIHN0YXJ0ID0gbGVuZ3RoKG5hY2ltaWVudG9zKSAtIDM1KQoKbmFjaW1pZW50b3NFeHRyYVByZSA8LSBzbmFpdmUobmFjaW1pZW50b3NJbnRyYSwgaCA9IDM2KQoKYWNjdXJhY3kobmFjaW1pZW50b3NFeHRyYVByZSwgbmFjaW1pZW50b3NFeHRyYSkKYGBgCgpgYGB7ciwgZWNobyA9IEZBTFNFfQpuYWNpbWllbnRvc0ludHJhIDwtIHN1YnNldChuYWNpbWllbnRvcywgZW5kID0gbGVuZ3RoKG5hY2ltaWVudG9zKSAtIDM2KQpuYWNpbWllbnRvc0V4dHJhIDwtIHN1YnNldChuYWNpbWllbnRvcywgc3RhcnQgPSBsZW5ndGgobmFjaW1pZW50b3MpIC0gMzUpCgpuYWNpbWllbnRvc0V4dHJhUHJlIDwtIHNuYWl2ZShuYWNpbWllbnRvc0ludHJhLCBoID0gMzYpCgpyb3VuZChhY2N1cmFjeShuYWNpbWllbnRvc0V4dHJhUHJlLCBuYWNpbWllbnRvc0V4dHJhKSwgMikKYGBgCgpgYGB7ciwgZWNobyA9IEZBTFNFfQphdXRvcGxvdChuYWNpbWllbnRvcywgc2VyaWVzID0gIk5hY2ltaWVudG9zIiwKICAgICAgICAgbWFpbj0iRmlndXJhIDQuIE5hY2ltaWVudG9zLCBwcmVkaWNjacOzbiBpbnRyYS0geSBleHRyYS1tdWVzdHJhbCIsCiAgICAgICAgIHhsYWI9IiIsIAogICAgICAgICB5bGFiPSJOYWNpbWllbnRvcyIKICAgICAgICAgKSArCiAgYXV0b2xheWVyKGZpdHRlZChuYWNpbWllbnRvc0V4dHJhUHJlKSwgc2VyaWVzID0gIk5hY2ltaWVudG9zIChhanVzdGFkYSkiKSArIAogIGF1dG9sYXllcihuYWNpbWllbnRvc0V4dHJhUHJlJG1lYW4sIHNlcmllcyA9ICJQcmVkaWNjacOzbiIpICsgCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9YygiTmFjaW1pZW50b3MiPSJibGFjayIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTmFjaW1pZW50b3MgKGFqdXN0YWRhKSI9ImJsdWUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQcmVkaWNjacOzbiIgPSAicmVkIikpICsKICBndWlkZXMoY29sb3VyID0gZ3VpZGVfbGVnZW5kKHRpdGxlID0gIlNlcmllcyIpKSArCiAgYW5ub3RhdGUoInRleHQiLCB4PTIwMTIsIHk9NDUwMDAsIGxhYmVsPSIzLjYlIiwgY29sb3VyID0gImJsdWUiKSArCiAgYW5ub3RhdGUoInRleHQiLCB4PTIwMTgsIHk9NDAwMDAsIGxhYmVsPSI3LjclIiwgY29sb3VyID0gInJlZCIpICsgCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uPWMoMC45OCwwLjk4KSwgbGVnZW5kLmp1c3RpZmljYXRpb249YygxLDEpKSAKYGBgCgpMYXMgcHJldmlzaW9uZXMgZXh0cmEtbXVlc3RyYWxlcyBtdWVzdHJhbiB1bmEgbWVub3IgcGVuZGllbnRlIHF1ZSBsb3MgY2Fzb3MgcmVhbGVzIGRlIG5hY2ltaWVudG9zLiBBc8OtLCBjb25mb3JtZSBzZSBhdmFuemEgZW4gZWwgaG9yaXpvbnRlIHRlbXBvcmFsIGxhcyBwcmV2aXNpb25lcyBzZSB2YW4gYWxlamFuZG8gZGUgbGEgcmVhbGlkYWQgeSBlbCBlcnJvciBleHRyYS1tdWVzdHJhbCBlcyBkZWwgNy43JSwgcmVkdWNpZG8gcGVybyBxdWUgZHVwbGljYSBlbCBlcnJvciBkZSBlc3RpbWFjacOzbiBpbnRyYS1tdWVzdHJhbCAoMy42JSkuCgpcCgojIyBWYWxpZGFjacOzbiBjcnV6YWRhIHBhcmEgU2VyaWVzIFRlbXBvcmFsZXMKCkhlbW9zIHZpc3RvIGRvcyBhbHRlcm5hdGl2YXMgcGFyYSBldmFsdWFyIGxhIGNhbGlkYWQgZGUgdW4gbcOpdG9kbyBkZSBwcmVkaWNjacOzbiBkZSBzZXJpZXMgdGVtcG9yYWxlcywgdW5vIGJhc2FkbyBlbiBwcmVkaWNjaW9uZXMgaW50cmEtbXVlc3RyYWxlcyBhIHVuIHBlcmlvZG8gdmlzdGEgeSBvdHJvIGJhc2FkbyBlbiBwcmVkaWNjaW9uZXMgZXh0cmEtbXVlc3RyYWxlcyBhIGxhcmdvIHBsYXpvLCBhbWJhcyBjb24gc3VzIGluY29udmVuaWVudGVzLgoKVmVhbW9zIGFob3JhIHVuYSB0w6ljbmljYSwgYmFzYWRhIGVuIGVsIGNvbmNlcHRvIGRlIHZhbGlkYWNpw7NuIGNydXphZGEgKF9jcm9zcyB2YWxpZGF0aW9uXykgcXVlIHBlcm1pdGUgb2J0ZW5lciBkZSBmb3JtYSBpbmRpdmlkdWFsaXphZGEgbG9zIGVycm9yZXMgZGUgcHJldmlzacOzbiBleHRyYS1tdWVzdHJhbCBhIHVuIHBlcmlvZG8gdmlzdGEsIGEgZG9zIHBlcmlvZG9zIHZpc3RhLCBldGMuCgpTdXBvbmdhbW9zIHF1ZSBwYXJhIGVzdGltYXIgZWwgbW9kZWxvIHNlIG5lY2VzaXRhIHVuIG3DrW5pbW8gZGUgJGskIG9ic2VydmFjaW9uZXMgeSBxdWUgc2UgZGVzZWEgcHJlZGVjaXIgaGFzdGEgdW4gaG9yaXpvbnRlIHRlbXBvcmFsICRoJC4KCiogU2VsZWNjaW9uYW1vcyBsYXMgb2JzZXJ2YWNpb25lcyAkMSwyLC4uLixrJCBwYXJhIGVzdGltYXIgZWwgbW9kZWxvIHkgcHJlZGVjaW1vcyBsYXMgb2JzZXJ2YWNpb25lcyBkZXNkZSAkaysxJCBoYXN0YSAkaytoJC4gVGVuZW1vcywgcG9yIHRhbnRvLCAkaCQgcHJlZGljY2lvbmVzLgoqIENhbGN1bGFtb3MgZWwgZXJyb3IgZGUgcHJlZGljY2nDs24gcGFyYSBsYXMgcHJlZGljY2lvbmVzIGRlc2RlICRrKzEkIGhhc3RhICRrK2gkLgoqIFJlcGV0aW1vcyBlc3RlIHByb2Nlc28gZGVzcGxhemFuZG8gZWwgbsO6bWVybyBkZSBvYnNlcnZhY2lvbmVzIHNlbGVjY2lvbmFkYXMgcGFyYSBsYSBlc3RpbWFjacOzbiB1biBwZXJpb2RvIGFkZWxhbnRlLiBFcyBkZWNpciwgYWhvcmEgdXNhbW9zIGxhcyBvYnNlcnZhY2lvbmVzICQyLDMsLi4uLGsrMSQgcGFyYSBlc3RpbWFyIGVsIG1vZGVsbywgcHJlZGVjaW1vcyBsYXMgb2JzZXJ2YWNpb25lcyBkZXNkZSAkaysyJCBoYXN0YSAkaysxK2gkIHkgY2FsY3VsYW1vcyBlbCBlcnJvciBkZSBwcmVkaWNjacOzbi4KKiBJdGVyYW1vcyBlbCBwcm9jZXNvLCBkZXNwbGF6YW5kbyBjYWRhIHZleiBsYXMgb2JzZXJ2YWNpb25lcyBkZSBsYSBlc3RpbWFjacOzbiB1biBwZXJpb2RvIGFkZWxhbnRlLgoqIEVuIGdlbmVyYWwgcGFyYSAkaT0wLDEsLi4uLFQtay1oJCwgZG9uZGUgJFQkIGVzIGVsIG7Dum1lcm8gdG90YWwgZGUgb2JzZXJ2YWNpb25lczoKICAKICAxLiBTZWxlY2Npb25hbW9zIGxhcyBvYnNlcnZhY2lvbmVzICRpKzEsaSsyLC4uLixpK2skIHBhcmEgZXN0aW1hciBlbCBtb2RlbG8uCiAgMi4gUHJlZGVjaW1vcyBsYXMgb2JzZXJ2YWNpb25lcyBkZXNkZSAkaStrKzEkIGhhc3RhICRpK2sraCQuCiAgMy4gQ2FsY3VsYW1vcyBlbCBlcnJvciBkZSBwcmVkaWNjacOzbiBwYXJhIGxhcyBvYnNlcnZhY2lvbmVzIGRlc2RlICRpK2srMSQgaGFzdGEgJGkraytoJC4KICA0LiBQYXJhIGNhZGEgaG9yaXpvbnRlIHRlbXBvcmFsIGRlIHByZWRpY2Npw7NuIHNlIGNhbGN1bGEgbGEgbWVkaWRhIGRlIGVycm9yIGRlc2VhZGEuCgpcClwKCiFbXSguL2ltYWdlbmVzL1JvbGxpbmdXaW5kb3dzLnBuZykKCkVzdGUgcHJvY2VkaW1pZW50byBzZSBkZW5vbWluYSBfX29yaWdlbiBkZSBwcmVkaWNjacOzbiBtw7N2aWxfXyAoX3JvbGxpbmcgZm9yZWNhc3Qgb3JpZ2luXykgbyBfcm9sbGluZyB3aW5kb3dzXy4KCkN1YW5kbyBzZSBhcGxpY2EgZXN0YSBtZXRvZG9sb2fDrWEgaGF5IHF1ZSB0ZW5lciBlbiBjdWVudGEgcXVlIGxvcyByZXN1bHRhZG9zIHB1ZWRlbiBkZXBlbmRlciBkZWwgbsO6bWVybyAkayQgZGUgZGF0b3MgdXNhZG9zIHBhcmEgbGEgZXN0aW1hY2nDs24gZGVsIG1vZGVsby4KCiMjIyBFamVtcGxvIGRlIGFwbGljYWNpw7NuIGNvbiBOYWNpbWllbnRvcyB7LX0KClZhbW9zIGEgYXBsaWNhciBsYSBtZXRvZG9sb2fDrWEgcHJldmlhIGEgbGEgc2VyaWUgYW51YWwgZGUgTmFjaW1pZW50b3MuIEFzdW1pbW9zIHF1ZSBzZSBwcmVjaXNhbiB2ZWludGUgYcOxb3MgcGFyYSBoYWNlciB1bmEgYnVlbmEgZXN0aW1hY2nDs24sICRrPTIwJCwgeSBxdWUgZWwgaG9yaXpvbnRlIHRlbXBvcmFsIGVzIGRlIGNpbmNvIGHDsW9zLCAkaCA9IDUkLiBMYSBzaWd1aWVudGUgcnV0aW5hIHBlcm1pdGUgb2J0ZW5lciBlbCBNQVBFIHBhcmEgcHJldmlzaW9uZXMgY29uIHVuIGhvcml6b250ZSB0ZW1wb3JhbCBkZXNkZSB1bm8gYSBjaW5jbyBhw7Fvcy4KICAKYGBge3J9ICAKbmFjQW51YWwgPC0gYWdncmVnYXRlKG5hY2ltaWVudG9zLCBGVU4gPSBzdW0pCmsgPC0gMjAgICAgICAgICAgICAgICAgICAgI01pbmltbyBudW1lcm8gZGUgZGF0b3MgcGFyYSBlc3RpbWFyCmggPC0gNSAgICAgICAgICAgICAgICAgICAgI0hvcml6b250ZSBkZSBsYXMgcHJlZGljaWNpb25lcwpUVCA8LSBsZW5ndGgobmFjQW51YWwpICAgICNMb25naXR1ZCBzZXJpZQpzIDwtIFRUIC0gayAtIGggICAgICAgICAgICNUb3RhbCBkZSBlc3RpbWFjaW9uZXMKCm1hcGVSd2YgPC0gbWF0cml4KE5BLCBzICsgMSwgaCkKZm9yIChpIGluIDA6cykgewogIHRyYWluLnNldCA8LSBzdWJzZXQobmFjQW51YWwsIHN0YXJ0ID0gaSArIDEsIGVuZCA9IGkgKyBrKQogIHRlc3Quc2V0IDwtICBzdWJzZXQobmFjQW51YWwsIHN0YXJ0ID0gaSArIGsgKyAxLCBlbmQgPSBpICsgayArIGgpCiAgCiAgZmNhc3QgPC0gcndmKHRyYWluLnNldCwgaCA9IGgsIGRyaWZ0ID0gVFJVRSkKICBtYXBlUndmW2kgKyAxLF0gPC0gMTAwKmFicyh0ZXN0LnNldCAtIGZjYXN0JG1lYW4pL3Rlc3Quc2V0Cn0KCm1hcGVSd2YgPC0gY29sTWVhbnMobWFwZVJ3ZikKcm91bmQobWFwZVJ3ZiwgMikKYGBgCgpFbCBlcnJvciBkZSBwcmV2aXNpw7NuIGV4dHJhLW11ZXN0cmFsIGNyZWNlIGxpbmVhbG1lbnRlIGNvbiBlbCBob3Jpem9udGUgZGUgcHJldmlzacOzbi4gUGFyYSBlbCBwcmltZXIgYcOxbyBlbCBlcnJvciBkZSBwcmVkaWNjacOzbiBzZSBtYW50aWVuZSBlbiB1biBtb2RlcmFkbyA0LjIlLiBTaW4gZW1iYXJnbywgcGFyYSBlbCBzZWd1bmRvIGHDsW8gZGUgcHJlZGljY2nDs24gZWwgTUFQRSBzYWx0YSBhbCA4LjIlIHkgcGFyYSBsb3MgcmVzdGFudGVzIGHDsW9zIHNpZ3VlIGNyZWNpZW5kbyByw6FwaWRhbWVudGUuIFByZWRlY2lyIHVzYW5kbyBsYSB0ZW5kZW5jaWEgbWVkaWEgc29sbyBlcyB1biBidWVuIG3DqXRvZG8gcGFyYSBwcmVkZWNpciBhIHVuIGHDsW8gdmlzdGEuCgpcClwKCiMgUmVzdW1lbiBkZSBsb3MgY29tYW5kb3MgdXRpbGl6YWRvcwoKCnxGdW5jacOzbiAgfFBhcXVldGUgfCBEZXNjcmlwY2nDs24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAp8Oi0tLS0tLS0tLS0tLS0tfDotLS0tLS0tLS0tLXw6LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18CnxgbWVhbmZgICAgICAgICB8Zm9yZWNhc3QgIHxQcmVkaWNjacOzbiBwb3IgbWVkaWEgfAp8YG5haXZlYCAgICAgICAgfGZvcmVjYXN0ICB8UHJlZGljY2nDs24gcG9yIG3DqXRvZG8gaW5nZW51byBJIHwKfGByd2ZgICAgICAgICAgIHxmb3JlY2FzdCAgfFByZWRpY2Npw7NuIGNvbiB0ZW5kZW5jaWEgbWVkaWEgfAp8YHNuYWl2ZWAJICAgICAgfGZvcmVjYXN0ICB8UHJlZGljY2nDs24gcG9yIG3DqXRvZG8gaW5nZW51byBjb24gZXN0YWNpb25hbGlkYWQgfAp8YGFjY3VyYWN5YAkgICAgfGZvcmVjYXN0ICB8Q2FsY3VsbyBkZSBsYSBwcmVjaXNpw7NuIGRlbCBtb2RlbG8gfAp8YGZvcmVjYXN0YCAgICAgfGZvcmVjYXN0ICB8UHJlZGljZSB2YWxvcmVzIGV4dHJhLW11ZXN0cmFsZXMgZnV0dXJvcyBkZSBsYSBzZXJpZSB8CnxgZml0dGVkYCAgICAgICB8c3RhdHMgICAgIHxPYnRpZW5lIGxhcyBwcmVkaWNjaW9uZXMgYSB1biBwZXJpb2RvIHZpc3RhIGludHJhLW11ZXN0cmFsZXN8CgpcClwKCiMgUmVmZXJlbmNpYXMKCiogTWFrcmlkYWtpcywgUy4geSAgSGlib24sIE0uICgyMDAwKS4gX1RoZSBNMy1Db21wZXRpdGlvbjogcmVzdWx0cywgY29uY2x1c2lvbnMgYW5kIGltcGxpY2F0aW9uc18uIEludGVybmF0aW9uYWwgSm91cm5hbCBvZiBGb3JlY2FzdGluZywgMTYoNCksIHBwLiA0NTHigJM0NzYuIGRvaToxMC4xMDE2L1MwMTY5LTIwNzAoMDApMDAwNTctMQoKClwKXApcClwK</div>
<footer class="footer">
  
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
<br>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.  <div class="text-muted">Website created by Iv&aacute;n Arribas. &copy;  2020. If you find any bugs please report them to <a href="mailto:ivan.arribas@uv.es"> ivan.arribas@uv.es</a>.</div>
  
</footer>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("03-03-Tema3.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
